<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HGAME 2024 MISC Writeup | w8nn9z Blog</title><meta name=keywords content><meta name=description content="HGAME 2024 MISC Writeup - w8nn9z Blog"><meta name=author content><link rel=canonical href=https://blog.w8nn9z.top/posts/ctf/hgame-2024-misc-writeup/><link crossorigin=anonymous href=/assets/css/stylesheet.12a5629d0be5f885fd946d77257e55f74027ed2a35144a29e2db13f8f62b5f35.css integrity rel="preload stylesheet" as=style><link rel=icon href=https://blog.w8nn9z.top/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.w8nn9z.top/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.w8nn9z.top/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.w8nn9z.top/apple-touch-icon.png><link rel=mask-icon href=https://blog.w8nn9z.top/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.w8nn9z.top/posts/ctf/hgame-2024-misc-writeup/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://blog.w8nn9z.top/posts/ctf/hgame-2024-misc-writeup/"><meta property="og:site_name" content="w8nn9z Blog"><meta property="og:title" content="HGAME 2024 MISC Writeup"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-01T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-01T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="HGAME 2024 MISC Writeup"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.w8nn9z.top/posts/"},{"@type":"ListItem","position":2,"name":"CTF","item":"https://blog.w8nn9z.top/posts/ctf/"},{"@type":"ListItem","position":3,"name":"HGAME 2024 MISC Writeup","item":"https://blog.w8nn9z.top/posts/ctf/hgame-2024-misc-writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HGAME 2024 MISC Writeup","name":"HGAME 2024 MISC Writeup","description":"","keywords":[],"articleBody":" HGAME 2024 WEEK1 1.SignIn 下载附件得到一张图片 网上搜图看见许多类似的，其中有一张有注释 将图片传到手机上从充电口看即可得到flag hgame{WOW_GREAT_YOU_SEE_IT_WONDERFUL}\n2.来自星尘的问候 一个即将发售的游戏的主角薇^3带来了一条消息。这段消息隐藏在加密的图片里 但即使解开了图片的六位弱加密,看到的也是一张迷惑的图片。 也许游戏的官网上有这种文字的记录? 补充：flag格式为hgame\\{[a-z0-9_]+\\}\n下载附件得到 secret.jpg 不认识但是可爱捏 网上搜图搜到这样的内容 直接搜索下面的文字内容 即将发售的游戏为 来自星尘 图片有6位弱加密，猜测为123456\nsteghide extract -sf secret.jpg -p 123456\n得到secret.zip exa.png内容： 经过一番搜索才知道这是 异星文字（？ 又经过一番搜索，最终在B站找到较为完整的文字解读 根据flag格式和一点推测（有两个异星文字没找到对应字母,c和0） hgame{welc0me!}\n3.simple_attack 怎么解开这个压缩包呢？\n下载附件压缩包 src.zip src.zip未加密 attchment.zip已加密 二者共含文件103223799_p0.jpg 基本确定为 明文攻击 ARCHPR 工具解得密钥 保存解开的压缩包并打开 photo.txt中含有DATA URL,浏览器url输入打开即可 4.希儿希儿希尔 Ch405是一名忠实的希儿厨，于是他出了一道这样的题，不过他似乎忘了这个加密的名字不是希儿了（x虽然经常有人叫错 补充： 图片打不开是正常现象,需要修复 最终得到的大写字母请用hgame{}包裹\n下载得到secret.png，要进行图片修复，拉到winhex中查看 PNG文件头没问题，可能是宽高被修改过 进行CRC校验来判断 计算CRC校验码之前，需要了解相关内容: 头部数据块长度， 文件头数据块标识（IDCH）, 13位数据块（IDHR） 剩余四字节为该png的CRC检验码 12 1B 80 4D 与我们计算的CRC校验码进行比较 显然不同 用python脚本修复: 得到正确宽高: 宽:00 00 05 72 高:00 00 07 cf 得到修复图片: 好看捏 既然是希尔加密，应该有密钥和密文 经过一些尝试，发现LSB隐写和文件分离 stegsolve解决LSB隐写问题: binwalk或foremost解决文件分离问题: binwalk -e 图片名.png foremost 图片名.png 密文：CVOCRJGMKLDJGBQIUIVXHEYLPNWR 在线工具解希尔密码： 根据格式提交flag hgame{DISAPPEARINTHESEAOFBUTTERFLY}\n5.签到 hgame{welc0me_t0_HGAME2024}\nHGAME 2024 WEEK2 1.ek1ng_want_girlfriend An introducation to Wireshark and also ek1ng. 提示1 尝试用Wireshark从HTTP流量中提取文件\n流量分析，追踪http协议\n截获上传的jpg图片内容\n导出分组字节流，添加后缀为.jpg，flag在jpg图片底部\n2.ezWord 通过破译图片的水印来解开文档里的秘密吧\n压缩包解压缩获得 这是一个word文档.docx\n打开就一张图片，根据题目描述和stegsolve下查看的结果，猜测是盲水印\n既然是盲水印，可能要有原图和水印图才能解出水印内容\n经过一些尝试，将.docx拖入winhex查看，发现藏了点东西，于是binwalk分离文件\n在/word/media中发现关键信息\n获取原图和水印图，进行盲水印的解 使用github上解盲水印的脚本\norigin1.jpg和encode1.png是我改的文件名，得到flag.png，查看水印内容\nT1hi3sI4sKey用来解secret.zip这个加密压缩包，得到secret.txt 一段垃圾邮件\nROT8000 解一下出flag\n3.龙之舞 新年快要到了，来看看龙年的龙之舞吧(～￣▽￣)～请注意，拿到正确的二维码后解码就是flag 但是一开始未必正确\ndeepsound_of_dragon_dance.wav根据音频文件名猜测进行过deepsound隐写\n先听了一遍，开头有点异常，关注开头内容，Audacity分析音频内容\n频谱图中：\n鉴定为反了：\n得到KEY也验证了deepsound隐写的想法\n解出个XXX.zip，里面一个龙之舞.gif\n先看了一遍，右下角有二维码碎片，逐帧分析即可，写个脚本提取每帧图片\n#coding=utf-8 from PIL import Image import os GIF_name = \"dragon.gif\" GIF = Image.open(GIF_name) GIF_dir = GIF_name[:-4] + \"_BreakDown\" #[:-4]返回从开头到倒数第五个字符的内容 if not os.path.exists(GIF_dir): os.mkdir(GIF_dir) try: while True: GIF_current = GIF.tell() #开始为0帧 tell()返回当前帧数 GIF.save(GIF_dir + \"\\\\\" + str(GIF_current) + \".png\") #python中两\\\\表示一\\ GIF.seek(GIF_current + 1) except EOFError: #EOFError是Python中的一个异常类型，表示在读取输入时已经到达了文件的末尾 pass #pass是空语句，用于保持结构的完整性，不做任何事 WPS拼一拼二维码碎片，合成一个大二维码，发现扫不出来\n考虑到每个碎片有两边都是半个方块那么大，应该是两两捆绑的，不存在旋转拼接\n正好前两天在复现NCTF 2022 MISC时也有二维码相关内容\n当时就在下面网站里学了不少有关二维码的知识\nhttps://www.wzhecnu.cn/2022/03/22/programming/gsoc/qr-code-01/\n经过一些尝试，发现是二维码 格式信息 不正确（纠错等级和掩码模式）\n多次尝试，原本的二维码格式信息应该是 L4，扫描得到flag\n解题过程中，找到另一种二维码无法扫描类型的题目\n第七届“湖湘杯” wear_a_mask：\n右图为mask pattern为2时进行的XOR变换\n之后我又翻看了去年HGAME 2023 WEEK2 MISC的官方WP，正好对应上面两题\n这一题的二维码的收获很多\nHGAME 2024 WEEK3 1.简单的vmdk取证 先找到密码吧 flag 格式：hgame{nthash_password} 例如hgame{05D0AB2BB13711B31D5E251C128C889E_happy} 附件下载： 链接：https://pan.baidu.com/s/1IYeZ1oRjo2zO-Wf6mB2TVA 提取码：vics\n.vmdk——虚拟机-虚拟磁盘文件，记录操作系统中所产生的全部数据\n先在VMware中挂载试试，发现需要Administrator的密码\n磁盘取证：打开 DiskGenius –\u003e 磁盘 –\u003e 打开虚拟磁盘文件\n我们要找的是用户密码，一般储存在 WINDOWS\\system32\\config\\SAM 中\n将config目录下 SAM 和 system 复制到指定文件夹\n用 mimikatz 获取用户密码hash (注意要将SAM和system复制到mimikatz目录下)\n在SAM和system文件后加上后缀 .hiv，即可使用mimikatz\n.hiv扩展名：当你使用.hiv扩展名时，Mimikatz会将文件视为注册表文件备份，并使用特定的解析逻辑来读取其中的数据。这意味着在提取和查看密码哈希值时，你需要提供对应的SAM文件和系统文件的备份。\nMimikatz对应命令:lsadump::sam /sam:SAM.hiv /system:system.hiv\n获得Administrator的Hash NTLM，在线工具爆一爆(注意提交flag时需要大写字母)\n2.简单的取证,不过前十个有红包 找到veracrypt的文件，拿到flag吧 补充附件： 链接：https://pan.baidu.com/s/19pj-juLLE4BY0lVxFyO4iQ 提取码：ccyk\n附件内容为 vera.hc\n.hc 后缀通常与 VeraCrypt 加密软件相关联。VeraCrypt 是一个开源的磁盘加密工具，用于创建和管理加密的容器文件或整个磁盘分区。\n当您使用 VeraCrypt 创建加密容器时，它会为容器文件分配一个特定的扩展名，通常是 .hc（即 VeraCrypt Hidden Container 的缩写）。\n通过 VeraCrypt 软件，您可以挂载 .hc 容器文件作为一个虚拟磁盘，然后将其视为普通磁盘分区或存储设备。在挂载后，您可以通过输入正确的密码来解密和访问容器中的文件和文件夹。\n于是现在就要获取加密密码，碰巧上一题磁盘中的目录RECYCLER中\n发现有一张jpg图片，上面还写着veracrypt_password，应该就是加密密码\n968fJD17UBzZG6e3yjF6 ，打开veracrypt挂载并输入密码，可以得到原磁盘内容\n在veracrypt中：选择文件 –\u003e 选个盘符（我选了A） –\u003e 加载 –\u003e 输入密码 –\u003e 确定\n3.与ai聊天 跟他聊一聊吧，从他嘴里翘出flaghttps://udify.app/chat/oRajccxObXREMLlO 注意请不要过快提问\n发现会反着说，想到hgame能不能反着说完，这样就可以得到flag\n4.Blind SQL Injection Blind SQL Injection but in Misc\n附件是一段流量包，判断为流量分析SQL盲注，用wireshark分析\n根据SQL盲注特性，过滤出http协议内容，再根据网页回显内容不同，获取所需\n举流量里SQL盲注中一句为例\nhttp://3c97f319-92cf-4ba5-a3f2-6bd644abe921.node5.buuoj.cn:81/search.php?id=1-(ascii(substr((Select(reverse(group_concat(password)))From(F1naI1y)),6,1))\u003e31) 需要注意reverse将获取的password倒置了，写脚本时要再倒置一次\n判断 F1naI1y表 中 字段password 倒置后的第6个字符对应ASCII码是否大于31\n经过多次判断查回显，最后可以获得一个 \u003ex\u0026\u0026\u003c=x+1 的范围，ASCII码即为x+1\n这是当时做题时的分析，也包括了password对应ASCII码的内容(倒置的)\n写个简单脚本，得到flag\nc = [125,102,50,102,97,56,50,57,53,99,56,51,100,45,54,99,97,98,45,56,57,101,52,45,53,50,55,49,45,55,101,102,97,98,97,98,99,123,103,97,108,102,44][::-1] flag = '' for i in c: flag += chr(i) print (flag) 运行结果:\nHGAME 2024 WEEK4 1.ezKeyboard 本来是个签到题，但有时候往往事与愿违\n流量不需要修复，出题人拿自己电脑现抓的一段流量，他本身就是这样的。 本题键盘流量的 HID Data 格式和常见的格式略有不同，但本质如一。 你需要辩证看待这些个脚本网络上的脚本。他们大多出自一家，没几十行的核心代码里，都毫不例外地保留了数个编程初学者常犯的致命失误。 相信自己的水平，从头写一个脚本往往比找别人的错误容易。 使用wireshark进行USB流量分析，把一些特殊的流量导出\n我导出了可能有用的三段，但是有一段不会用，也可能没什么用（\n第一段内容：\n感觉开头的01没什么用，提取一下敲击内容：\nnormalkeys = {\"04\":\"a\", \"05\":\"b\", \"06\":\"c\", \"07\":\"d\", \"08\":\"e\", \"09\":\"f\", \"0a\":\"g\", \"0b\":\"h\", \"0c\":\"i\", \"0d\":\"j\", \"0e\":\"k\", \"0f\":\"l\", \"10\":\"m\", \"11\":\"n\", \"12\":\"o\", \"13\":\"p\", \"14\":\"q\", \"15\":\"r\", \"16\":\"s\", \"17\":\"t\", \"18\":\"u\", \"19\":\"v\", \"1a\":\"w\", \"1b\":\"x\", \"1c\":\"y\", \"1d\":\"z\",\"1e\":\"1\", \"1f\":\"2\", \"20\":\"3\", \"21\":\"4\", \"22\":\"5\", \"23\":\"6\",\"24\":\"7\",\"25\":\"8\",\"26\":\"9\",\"27\":\"0\",\"28\":\"\",\"29\":\"\",\"2a\":\"\", \"2b\":\"\\t\",\"2c\":\"\",\"2d\":\"-\",\"2e\":\"=\",\"2f\":\"[\",\"30\":\"]\",\"31\":\"\\\\\",\"32\":\"\",\"33\":\";\",\"34\":\"'\",\"35\":\"`\",\"36\":\",\",\"37\":\".\",\"38\":\"/\",\"39\":\"\",\"3a\":\"\",\"3b\":\"\", \"3c\":\"\",\"3d\":\"\",\"3e\":\"\",\"3f\":\"\",\"40\":\"\",\"41\":\"\",\"42\":\"\",\"43\":\"\",\"44\":\"\",\"45\":\"\"} shiftkeys = {\"04\":\"A\", \"05\":\"B\", \"06\":\"C\", \"07\":\"D\", \"08\":\"E\", \"09\":\"F\", \"0a\":\"G\", \"0b\":\"H\", \"0c\":\"I\", \"0d\":\"J\", \"0e\":\"K\", \"0f\":\"L\", \"10\":\"M\", \"11\":\"N\", \"12\":\"O\", \"13\":\"P\", \"14\":\"Q\", \"15\":\"R\", \"16\":\"S\", \"17\":\"T\", \"18\":\"U\", \"19\":\"V\", \"1a\":\"W\", \"1b\":\"X\", \"1c\":\"Y\", \"1d\":\"Z\",\"1e\":\"!\", \"1f\":\"@\", \"20\":\"#\", \"21\":\"$\", \"22\":\"%\", \"23\":\"^\",\"24\":\"\u0026\",\"25\":\"*\",\"26\":\"(\",\"27\":\")\",\"28\":\"\",\"29\":\"\",\"2a\":\"\", \"2b\":\"\\t\",\"2c\":\"\",\"2d\":\"_\",\"2e\":\"+\",\"2f\":\"{\",\"30\":\"}\",\"31\":\"|\",\"32\":\"\",\"33\":\"\\\"\",\"34\":\":\",\"35\":\"~\",\"36\":\"\u003c\",\"37\":\"\u003e\",\"38\":\"?\",\"39\":\"\",\"3a\":\"\",\"3b\":\"\", \"3c\":\"\",\"3d\":\"\",\"3e\":\"\",\"3f\":\"\",\"40\":\"\",\"41\":\"\",\"42\":\"\",\"43\":\"\",\"44\":\"\",\"45\":\"\"} with open('hgame2.txt') as data: for line in data: information1=line[6:8] information2=line[8:10] if information1=='00': continue if line[3]=='2': #shiftkey print (shiftkeys[information1],end='') #end=''以空字符替换原默认换行符 if information2!='00': print (shiftkeys[information2],end='') if line[3]=='0': #normalkey print (normalkeys[information1],end='') if information2!='00': print (normalkeys[information2],end='') 运行结果：\nhgame{k_eyb0a1d_gam0__15_s0_1nstf0n__!!~~~~} 整理一下：\n但是提交发现flag不对，感觉怪怪的\n赛后看了官方wp找到问题了，这里也贴出能得到正确flag的脚本：\nnormalKeys = {\"04\": \"a\", \"05\": \"b\", \"06\": \"c\", \"07\": \"d\", \"08\": \"e\", \"09\": \"f\", \"0a\": \"g\", \"0b\": \"h\", \"0c\": \"i\", \"0d\": \"j\", \"0e\": \"k\", \"0f\": \"l\", \"10\": \"m\", \"11\": \"n\", \"12\": \"o\", \"13\": \"p\", \"14\": \"q\", \"15\": \"r\", \"16\": \"s\", \"17\": \"t\", \"18\": \"u\", \"19\": \"v\", \"1a\": \"w\", \"1b\": \"x\", \"1c\": \"y\", \"1d\": \"z\", \"1e\": \"1\", \"1f\": \"2\", \"20\": \"3\", \"21\": \"4\", \"22\": \"5\", \"23\": \"6\", \"24\": \"7\", \"25\": \"8\", \"26\": \"9\", \"27\": \"0\", \"28\": \"\", \"29\": \"\", \"2a\": \"\", \"2b\": \"\\t\", \"2c\": \"\", \"2d\": \"-\", \"2e\": \"=\", \"2f\": \"[\", \"30\": \"]\", \"31\": \"\\\\\", \"32\": \"\", \"33\": \";\", \"34\": \"'\", \"35\": \"\", \"36\": \",\", \"37\": \".\", \"38\": \"/\", \"39\": \"\", \"3a\": \"\", \"3b\": \"\", \"3c\": \"\", \"3d\": \"\", \"3e\": \"\", \"3f\": \"\", \"40\": \"\", \"41\": \"\", \"42\": \"\", \"43\": \"\", \"44\": \"\", \"45\": \"\"} shiftKeys = {\"04\": \"A\", \"05\": \"B\", \"06\": \"C\", \"07\": \"D\", \"08\": \"E\", \"09\": \"F\", \"0a\": \"G\", \"0b\": \"H\", \"0c\": \"I\", \"0d\": \"J\", \"0e\": \"K\", \"0f\": \"L\", \"10\": \"M\", \"11\": \"N\", \"12\": \"O\", \"13\": \"P\", \"14\": \"Q\", \"15\": \"R\", \"16\": \"S\", \"17\": \"T\", \"18\": \"U\", \"19\": \"V\", \"1a\": \"W\", \"1b\": \"X\", \"1c\": \"Y\", \"1d\": \"Z\", \"1e\": \"!\", \"1f\": \"@\", \"20\": \"#\", \"21\": \"$\", \"22\": \"%\", \"23\": \"^\", \"24\": \"\u0026\", \"25\": \"*\", \"26\": \"(\", \"27\": \")\", \"28\": \"\", \"29\": \"\", \"2a\": \"\", \"2b\": \"\\t\", \"2c\": \"\", \"2d\": \"_\", \"2e\": \"+\", \"2f\": \"{\", \"30\": \"}\", \"31\": \"|\", \"32\": \"\", \"33\": \"\\\"\", \"34\": \":\", \"35\": \"~\", \"36\": \"\u003c\", \"37\": \"\u003e\", \"38\": \"?\", \"39\": \"\", \"3a\": \"\", \"3b\": \"\", \"3c\": \"\", \"3d\": \"\", \"3e\": \"\", \"3f\": \"\", \"40\": \"\", \"41\": \"\", \"42\": \"\", \"43\": \"\", \"44\": \"\", \"45\": \"\"} output = [] last = [] new = [] keys = open('hgame2.txt') press = '' for line in keys: try: if line[2]!='0' or (line[3]!='0' and line[3]!='2'): continue offset = 6 new = [] while line[offset:offset+2] != '00': press = line[offset:offset+2] if press in normalKeys.keys(): if line[3]=='0': key = normalKeys[press] else: key = shiftKeys[press] else: key = '[unknown]' if press not in last: output.append(key) new.append(press) offset += 2 except: print(line) finally: last = new keys.close() flag=0 for i in range(len(output)): try: if output[i]==\"\": flag = 1-flag if flag!=0: output[i]=output[i].upper() except: pass output = [x for x in output if x != ''] new_output = [] for i in range(len(output)): if output[i] == \"\": new_output = new_output[:-1] else: new_output.append(output[i]) print (\"\".join(new_output)) 运行结果:hgame{keYb0a1d_gam0__15_s0_f0n__!!~~~~}\n2.maybezip 根据题目名，结合文件并非zip，想到需要对文件内容异或得到原zip文件 根据zip文件的固定文件头，504B0304，找到异或数字 0x27,可以直接在winhex里异或，也能写脚本\ndef xor_with_0x27(input_file, output_file): with open(input_file, 'rb') as f: data = f.read() xor_data = bytearray([b ^ 0x27 for b in data]) with open(output_file, 'wb') as f: f.write(xor_data) # 使用xor函数 xor_with_0x27('maybezip', 'output.zip') output.zip里文件修改日期有明显的01特征，提取出来\nimport zipfile import json from datetime import datetime def get_all_file_modification_time(zip_path): result = {} with zipfile.ZipFile(zip_path, 'r') as myzip: for file in myzip.namelist(): info = myzip.getinfo(file) mod_time = datetime(*info.date_time) result[file] = str(mod_time) return result # 使用函数并保存结果为json result = get_all_file_modification_time('output.zip') with open('output.json', 'w') as f: json.dump(result, f) 再对拿到的json数据操作一下\nimport json # 读取json文件 with open('output.json', 'r') as f: data = json.load(f) string_of_01 ='' # 遍历json数据 for file, time in data.items(): # 检查文件名是否在指定范围内 if 'out/' in file and 'png' in file: file_number = int(file.split('/')[1].split('.')[0]) if file_number \u003e= 1 and file_number \u003c= 118: # 检查时间的最后一位是否为0 if time[-1] == '0': print(f\"{file_number} - 0\") string_of_01 += '0' else: print(f\"{file_number} - 1\") string_of_01 += '1' print(string_of_01) # 二进制转ascii字符串 def binary_to_string(binary): result = '' for i in range(0, len(binary), 8): byte = binary[i:i+8] result += chr(int(byte,2)) #从二进制转为十进制 # 忽略不可见字符 result = ''.join([i if ord(i) \u003e 31 and ord(i) \u003c 127 else '' for i in result]) return result key_of_zip = binary_to_string(string_of_01) print(key_of_zip) 得到压缩包密码 what_is_tupper 解压缩得到一段数字，结合压缩包密码的tupper，想到tupper自指，在线工具画一下图\n这是micro qrcode，找个工具扫一下，可以用Scanbot SDK 扫描内容为：Matryo5hk4_d01l\n","wordCount":"4760","inLanguage":"en","datePublished":"2024-03-01T00:00:00Z","dateModified":"2024-03-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.w8nn9z.top/posts/ctf/hgame-2024-misc-writeup/"},"publisher":{"@type":"Organization","name":"w8nn9z Blog","logo":{"@type":"ImageObject","url":"https://blog.w8nn9z.top/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.w8nn9z.top/ accesskey=h title="w8nn9z Blog (Alt + H)">w8nn9z Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.w8nn9z.top/search title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li><li><a href=https://blog.w8nn9z.top/posts title=文章><span>文章</span></a></li><li><a href=https://blog.w8nn9z.top/archives title=归档><span>归档</span></a></li><li><a href=https://blog.w8nn9z.top/about title=关于><span>关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">HGAME 2024 MISC Writeup</h1><div class=post-meta><span title='2024-03-01 00:00:00 +0000 UTC'>March 1, 2024</span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#hgame-2024-week1 aria-label="HGAME 2024 WEEK1">HGAME 2024 WEEK1</a><ul><li><a href=#1signin aria-label=1.SignIn>1.SignIn</a></li><li><a href=#2%e6%9d%a5%e8%87%aa%e6%98%9f%e5%b0%98%e7%9a%84%e9%97%ae%e5%80%99 aria-label=2.来自星尘的问候>2.来自星尘的问候</a></li><li><a href=#3simple_attack aria-label=3.simple_attack>3.simple_attack</a></li><li><a href=#4%e5%b8%8c%e5%84%bf%e5%b8%8c%e5%84%bf%e5%b8%8c%e5%b0%94 aria-label=4.希儿希儿希尔>4.希儿希儿希尔</a></li><li><a href=#5%e7%ad%be%e5%88%b0 aria-label=5.签到>5.签到</a></li></ul></li><li><a href=#hgame-2024-week2 aria-label="HGAME 2024 WEEK2">HGAME 2024 WEEK2</a><ul><li><a href=#1ek1ng_want_girlfriend aria-label=1.ek1ng_want_girlfriend>1.ek1ng_want_girlfriend</a></li><li><a href=#2ezword aria-label=2.ezWord>2.ezWord</a></li><li><a href=#3%e9%be%99%e4%b9%8b%e8%88%9e aria-label=3.龙之舞>3.龙之舞</a></li></ul></li><li><a href=#hgame-2024-week3 aria-label="HGAME 2024 WEEK3">HGAME 2024 WEEK3</a><ul><li><a href=#1%e7%ae%80%e5%8d%95%e7%9a%84vmdk%e5%8f%96%e8%af%81 aria-label=1.简单的vmdk取证>1.简单的vmdk取证</a></li><li><a href=#2%e7%ae%80%e5%8d%95%e7%9a%84%e5%8f%96%e8%af%81%e4%b8%8d%e8%bf%87%e5%89%8d%e5%8d%81%e4%b8%aa%e6%9c%89%e7%ba%a2%e5%8c%85 aria-label=2.简单的取证,不过前十个有红包>2.简单的取证,不过前十个有红包</a></li><li><a href=#3%e4%b8%8eai%e8%81%8a%e5%a4%a9 aria-label=3.与ai聊天>3.与ai聊天</a></li><li><a href=#4blind-sql-injection aria-label="4.Blind SQL Injection">4.Blind SQL Injection</a></li></ul></li><li><a href=#hgame-2024-week4 aria-label="HGAME 2024 WEEK4">HGAME 2024 WEEK4</a><ul><li><a href=#1ezkeyboard aria-label=1.ezKeyboard>1.ezKeyboard</a></li><li><a href=#2maybezip aria-label=2.maybezip>2.maybezip</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;document.addEventListener("DOMContentLoaded",function(){if(checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),elements.length>0){activeElement=elements[0];const e=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${e}"]`).classList.add("active")}const t=document.getElementById("top-link");t&&t.addEventListener("click",e=>{e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})})},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{const e=window.pageYOffset||document.documentElement.scrollTop;if(e===0)return;elements&&elements.length>0&&(activeElement=Array.from(elements).find(t=>{if(getOffsetTop(t)-e>0&&getOffsetTop(t)-e<window.innerHeight/2)return t})||activeElement,elements.forEach(e=>{const n=encodeURI(e.getAttribute("id")).toLowerCase(),t=document.querySelector(`.inner ul li a[href="#${n}"]`);if(e===activeElement){t.classList.add("active");const e=document.querySelector(".toc .inner"),n=t.offsetTop,s=e.clientHeight,o=t.clientHeight,i=n-s/2+o/2;e.scrollTo({top:i,behavior:"smooth"})}else t.classList.remove("active")}))},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><hr><h2 id=hgame-2024-week1>HGAME 2024 WEEK1<a hidden class=anchor aria-hidden=true href=#hgame-2024-week1>#</a></h2><h3 id=1signin>1.SignIn<a hidden class=anchor aria-hidden=true href=#1signin>#</a></h3><p>下载附件得到一张图片
<img loading=lazy src=/images/HGAME2024/WEEK1/try_another_way_to_see.png>
网上搜图看见许多类似的，其中有一张有注释
<img loading=lazy src=/images/HGAME2024/WEEK1/1.png>
将图片传到手机上从充电口看即可得到flag
hgame{WOW_GREAT_YOU_SEE_IT_WONDERFUL}</p><hr><h3 id=2来自星尘的问候>2.来自星尘的问候<a hidden class=anchor aria-hidden=true href=#2来自星尘的问候>#</a></h3><blockquote><p>一个即将发售的游戏的主角薇^3带来了一条消息。这段消息隐藏在加密的图片里
但即使解开了图片的六位弱加密,看到的也是一张迷惑的图片。
也许游戏的官网上有这种文字的记录?
补充：flag格式为<code>hgame\{[a-z0-9_]+\}</code></p></blockquote><p>下载附件得到 <strong>secret.jpg</strong>
<img loading=lazy src=/images/HGAME2024/WEEK1/secret.jpg>
<del>不认识但是可爱捏</del>
网上搜图搜到这样的内容
<img loading=lazy src=/images/HGAME2024/WEEK1/2.png>
直接搜索下面的文字内容
<img loading=lazy src=/images/HGAME2024/WEEK1/3.png>
即将发售的游戏为 <strong>来自星尘</strong>
图片有6位弱加密，猜测为123456</p><blockquote><p>steghide extract -sf secret.jpg -p 123456</p></blockquote><p>得到secret.zip
<img loading=lazy src=/images/HGAME2024/WEEK1/4.png>
exa.png内容：
<img loading=lazy src=/images/HGAME2024/WEEK1/exa.png>
经过一番搜索才知道这是 <strong>异星文字</strong>（？
又经过一番搜索，最终在B站找到较为完整的文字解读
<img loading=lazy src=/images/HGAME2024/WEEK1/5.png>
根据flag格式和一点推测（有两个异星文字没找到对应字母,c和0）
hgame{welc0me!}</p><hr><h3 id=3simple_attack>3.simple_attack<a hidden class=anchor aria-hidden=true href=#3simple_attack>#</a></h3><blockquote><p>怎么解开这个压缩包呢？</p></blockquote><p>下载附件压缩包 <strong>src.zip</strong>
<img loading=lazy src=/images/HGAME2024/WEEK1/6.png>
src.zip未加密 attchment.zip已加密
二者共含文件103223799_p0.jpg
基本确定为 <strong>明文攻击</strong>
<strong>ARCHPR</strong> 工具解得密钥
<img loading=lazy src=/images/HGAME2024/WEEK1/7.png>
保存解开的压缩包并打开
<img loading=lazy src=/images/HGAME2024/WEEK1/8.png>
photo.txt中含有<strong>DATA URL</strong>,浏览器url输入打开即可
<img loading=lazy src=/images/HGAME2024/WEEK1/9.png></p><hr><h3 id=4希儿希儿希尔>4.希儿希儿希尔<a hidden class=anchor aria-hidden=true href=#4希儿希儿希尔>#</a></h3><blockquote><p>Ch405是一名忠实的希儿厨，于是他出了一道这样的题，不过他似乎忘了这个加密的名字不是希儿了（x虽然经常有人叫错
补充：
图片打不开是正常现象,需要修复
最终得到的大写字母请用hgame{}包裹</p></blockquote><p>下载得到secret.png，要进行图片修复，拉到winhex中查看
<img loading=lazy src=/images/HGAME2024/WEEK1/11.png>
<strong>PNG文件头</strong>没问题，可能是宽高被修改过
进行<strong>CRC校验</strong>来判断
计算CRC校验码之前，需要了解相关内容:
<strong>头部数据块长度</strong>，
<strong>文件头数据块标识（IDCH）</strong>,
<strong>13位数据块（IDHR）</strong>
剩余四字节为该png的CRC检验码 12 1B 80 4D
与我们计算的CRC校验码进行比较
<img loading=lazy src=/images/HGAME2024/WEEK1/12.png>显然不同
用python脚本修复:
<img loading=lazy src=/images/HGAME2024/WEEK1/13.png>
得到正确宽高:
宽:00 00 05 72
高:00 00 07 cf
得到修复图片:
<img loading=lazy src=/images/HGAME2024/WEEK1/secret_decode.png>
<del>好看捏</del>
既然是希尔加密，应该有密钥和密文
经过一些尝试，发现<strong>LSB隐写</strong>和<strong>文件分离</strong>
stegsolve解决LSB隐写问题:
<img loading=lazy src=/images/HGAME2024/WEEK1/14.png>
binwalk或foremost解决文件分离问题:
binwalk -e 图片名.png
foremost 图片名.png
密文：CVOCRJGMKLDJGBQIUIVXHEYLPNWR
在线工具解希尔密码：
<img loading=lazy src=/images/HGAME2024/WEEK1/15.png>
根据格式提交flag
hgame{DISAPPEARINTHESEAOFBUTTERFLY}</p><hr><h3 id=5签到>5.签到<a hidden class=anchor aria-hidden=true href=#5签到>#</a></h3><p><img loading=lazy src=/images/HGAME2024/WEEK1/16.png>
hgame{welc0me_t0_HGAME2024}</p><hr><h2 id=hgame-2024-week2>HGAME 2024 WEEK2<a hidden class=anchor aria-hidden=true href=#hgame-2024-week2>#</a></h2><h3 id=1ek1ng_want_girlfriend>1.ek1ng_want_girlfriend<a hidden class=anchor aria-hidden=true href=#1ek1ng_want_girlfriend>#</a></h3><blockquote><p>An introducation to Wireshark and also ek1ng.
提示1 尝试用Wireshark从HTTP流量中提取文件</p></blockquote><p>流量分析，追踪http协议</p><p>截获上传的jpg图片内容</p><p><img loading=lazy src=/images/HGAME2024/WEEK2/ek1ng_want_girlfriend/1.png></p><p>导出分组字节流，添加后缀为.jpg，flag在jpg图片底部</p><p><img loading=lazy src=/images/HGAME2024/WEEK2/ek1ng_want_girlfriend/wireshark.jpg></p><hr><h3 id=2ezword>2.ezWord<a hidden class=anchor aria-hidden=true href=#2ezword>#</a></h3><blockquote><p>通过破译图片的水印来解开文档里的秘密吧</p></blockquote><p>压缩包解压缩获得 <strong>这是一个word文档.docx</strong></p><p>打开就一张图片，根据题目描述和stegsolve下查看的结果，猜测是盲水印</p><p>既然是盲水印，可能要有原图和水印图才能解出水印内容</p><p>经过一些尝试，将.docx拖入winhex查看，发现藏了点东西，于是binwalk分离文件</p><p><img loading=lazy src=/images/HGAME2024/WEEK2/ezWord/1.png></p><p>在/word/media中发现关键信息</p><p><img loading=lazy src=/images/HGAME2024/WEEK2/ezWord/2.png></p><p>获取原图和水印图，进行盲水印的解 使用github上解盲水印的脚本</p><p><img loading=lazy src=/images/HGAME2024/WEEK2/ezWord/3.png></p><p>origin1.jpg和encode1.png是我改的文件名，得到flag.png，查看水印内容</p><p><img loading=lazy src=/images/HGAME2024/WEEK2/ezWord/4.png></p><p><strong>T1hi3sI4sKey</strong>用来解secret.zip这个加密压缩包，得到secret.txt 一段垃圾邮件</p><p><img loading=lazy src=/images/HGAME2024/WEEK2/ezWord/5.png></p><p>ROT8000 解一下出flag</p><p><img loading=lazy src=/images/HGAME2024/WEEK2/ezWord/6.png></p><hr><h3 id=3龙之舞>3.龙之舞<a hidden class=anchor aria-hidden=true href=#3龙之舞>#</a></h3><blockquote><p>新年快要到了，来看看龙年的龙之舞吧(～￣▽￣)～请注意，拿到<strong>正确</strong>的二维码后解码就是flag 但是一开始未必正确</p></blockquote><p><strong>deepsound_of_dragon_dance.wav</strong>根据音频文件名猜测进行过<strong>deepsound</strong>隐写</p><p>先听了一遍，开头有点异常，关注开头内容，Audacity分析音频内容</p><p>频谱图中：<img loading=lazy src=/images/HGAME2024/WEEK2/%E9%BE%99%E4%B9%8B%E8%88%9E/2.png></p><p>鉴定为反了：<img loading=lazy src=/images/HGAME2024/WEEK2/%E9%BE%99%E4%B9%8B%E8%88%9E/decoded.png></p><p>得到KEY也验证了deepsound隐写的想法</p><p>解出个<strong>XXX.zip</strong>，里面一个<strong>龙之舞.gif</strong></p><p>先看了一遍，右下角有二维码碎片，逐帧分析即可，写个脚本提取每帧图片</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#coding=utf-8</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> PIL <span style=color:#f92672>import</span> Image
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>GIF_name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;dragon.gif&#34;</span>
</span></span><span style=display:flex><span>GIF <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span>open(GIF_name)
</span></span><span style=display:flex><span>GIF_dir <span style=color:#f92672>=</span> GIF_name[:<span style=color:#f92672>-</span><span style=color:#ae81ff>4</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;_BreakDown&#34;</span>  <span style=color:#75715e>#[:-4]返回从开头到倒数第五个字符的内容</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(GIF_dir):
</span></span><span style=display:flex><span>    os<span style=color:#f92672>.</span>mkdir(GIF_dir)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        GIF_current <span style=color:#f92672>=</span> GIF<span style=color:#f92672>.</span>tell()  <span style=color:#75715e>#开始为0帧 tell()返回当前帧数</span>
</span></span><span style=display:flex><span>        GIF<span style=color:#f92672>.</span>save(GIF_dir <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>+</span> str(GIF_current) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.png&#34;</span>)  <span style=color:#75715e>#python中两\\表示一\</span>
</span></span><span style=display:flex><span>        GIF<span style=color:#f92672>.</span>seek(GIF_current <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>except</span> <span style=color:#a6e22e>EOFError</span>:  <span style=color:#75715e>#EOFError是Python中的一个异常类型，表示在读取输入时已经到达了文件的末尾</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pass</span>  <span style=color:#75715e>#pass是空语句，用于保持结构的完整性，不做任何事</span>
</span></span></code></pre></div><p>WPS拼一拼二维码碎片，合成一个大二维码，发现扫不出来</p><p><img loading=lazy src=/images/HGAME2024/WEEK2/%E9%BE%99%E4%B9%8B%E8%88%9E/O1234.png></p><p>考虑到每个碎片有两边都是半个方块那么大，应该是两两捆绑的，不存在旋转拼接</p><p>正好前两天在复现NCTF 2022 MISC时也有二维码相关内容</p><p>当时就在下面网站里学了不少有关二维码的知识</p><p><a href=https://www.wzhecnu.cn/2022/03/22/programming/gsoc/qr-code-01/>https://www.wzhecnu.cn/2022/03/22/programming/gsoc/qr-code-01/</a></p><p>经过一些尝试，发现是二维码 <strong>格式信息</strong> 不正确（纠错等级和掩码模式）</p><p><img loading=lazy src=/images/HGAME2024/WEEK2/%E9%BE%99%E4%B9%8B%E8%88%9E/QR1.png><img loading=lazy src=/images/HGAME2024/WEEK2/%E9%BE%99%E4%B9%8B%E8%88%9E/QR2.png></p><p>多次尝试，原本的二维码格式信息应该是 <strong>L4</strong>，扫描得到flag</p><p>解题过程中，找到另一种二维码无法扫描类型的题目</p><p><strong>第七届“湖湘杯” wear_a_mask</strong>：</p><p><img loading=lazy src=/images/HGAME2024/WEEK2/%E9%BE%99%E4%B9%8B%E8%88%9E/7.png> <img loading=lazy src=/images/HGAME2024/WEEK2/%E9%BE%99%E4%B9%8B%E8%88%9E/8.png></p><p>右图为mask pattern为2时进行的XOR变换</p><p>之后我又翻看了去年HGAME 2023 WEEK2 MISC的官方WP，正好对应上面两题</p><p><img loading=lazy src=/images/HGAME2024/WEEK2/%E9%BE%99%E4%B9%8B%E8%88%9E/3.png></p><p>这一题的二维码的收获很多</p><hr><h2 id=hgame-2024-week3>HGAME 2024 WEEK3<a hidden class=anchor aria-hidden=true href=#hgame-2024-week3>#</a></h2><h3 id=1简单的vmdk取证>1.简单的vmdk取证<a hidden class=anchor aria-hidden=true href=#1简单的vmdk取证>#</a></h3><blockquote><p>先找到密码吧 flag 格式：hgame{nthash_password} 例如hgame{05D0AB2BB13711B31D5E251C128C889E_happy} 附件下载： 链接：https://pan.baidu.com/s/1IYeZ1oRjo2zO-Wf6mB2TVA 提取码：vics</p></blockquote><p><strong>.vmdk</strong>——虚拟机-虚拟磁盘文件，记录操作系统中所产生的全部数据</p><p>先在VMware中挂载试试，发现需要Administrator的密码</p><p>磁盘取证：打开 <strong>DiskGenius</strong> &ndash;> 磁盘 &ndash;> 打开虚拟磁盘文件</p><p><img loading=lazy src=/images/HGAME2024/WEEK3/%E7%AE%80%E5%8D%95%E7%9A%84vmdk%E5%8F%96%E8%AF%81/1.png></p><p>我们要找的是用户密码，一般储存在 <strong>WINDOWS\system32\config\SAM</strong> 中</p><p>将config目录下 <strong>SAM</strong> 和 <strong>system</strong> 复制到指定文件夹</p><p><img loading=lazy src=/images/HGAME2024/WEEK3/%E7%AE%80%E5%8D%95%E7%9A%84vmdk%E5%8F%96%E8%AF%81/2.png></p><p>用 <strong>mimikatz</strong> 获取用户密码hash (注意要将SAM和system复制到mimikatz目录下)</p><p>在SAM和system文件后加上后缀 <strong>.hiv</strong>，即可使用mimikatz</p><blockquote><p>.hiv扩展名：当你使用.hiv扩展名时，Mimikatz会将文件视为注册表文件备份，并使用特定的解析逻辑来读取其中的数据。这意味着在提取和查看密码哈希值时，你需要提供对应的SAM文件和系统文件的备份。</p></blockquote><p><img loading=lazy src=/images/HGAME2024/WEEK3/%E7%AE%80%E5%8D%95%E7%9A%84vmdk%E5%8F%96%E8%AF%81/3.png></p><p>Mimikatz对应命令:<code>lsadump::sam /sam:SAM.hiv /system:system.hiv</code></p><p>获得Administrator的Hash NTLM，在线工具爆一爆(注意提交flag时需要大写字母)</p><p><img loading=lazy src=/images/HGAME2024/WEEK3/%E7%AE%80%E5%8D%95%E7%9A%84vmdk%E5%8F%96%E8%AF%81/4.png></p><hr><h3 id=2简单的取证不过前十个有红包>2.简单的取证,不过前十个有红包<a hidden class=anchor aria-hidden=true href=#2简单的取证不过前十个有红包>#</a></h3><blockquote><p>找到veracrypt的文件，拿到flag吧 补充附件： 链接：https://pan.baidu.com/s/19pj-juLLE4BY0lVxFyO4iQ 提取码：ccyk</p></blockquote><p>附件内容为 <strong>vera.hc</strong></p><blockquote><p>.hc 后缀通常与 VeraCrypt 加密软件相关联。VeraCrypt 是一个开源的磁盘加密工具，用于创建和管理加密的容器文件或整个磁盘分区。</p><p>当您使用 VeraCrypt 创建加密容器时，它会为容器文件分配一个特定的扩展名，通常是 .hc（即 VeraCrypt Hidden Container 的缩写）。</p><p>通过 VeraCrypt 软件，您可以挂载 .hc 容器文件作为一个虚拟磁盘，然后将其视为普通磁盘分区或存储设备。在挂载后，您可以通过输入正确的密码来解密和访问容器中的文件和文件夹。</p></blockquote><p>于是现在就要获取加密密码，碰巧上一题磁盘中的目录<strong>RECYCLER</strong>中</p><p><img loading=lazy src=/images/HGAME2024/WEEK3/%E7%AE%80%E5%8D%95%E7%9A%84%E5%8F%96%E8%AF%81,%E4%B8%8D%E8%BF%87%E5%89%8D%E5%8D%81%E4%B8%AA%E6%9C%89%E7%BA%A2%E5%8C%85/1.png></p><p>发现有一张jpg图片，上面还写着veracrypt_password，应该就是加密密码</p><p><strong>968fJD17UBzZG6e3yjF6</strong> ，打开veracrypt挂载并输入密码，可以得到原磁盘内容</p><p>在veracrypt中：选择文件 &ndash;> 选个盘符（我选了A） &ndash;> 加载 &ndash;> 输入密码 &ndash;> 确定</p><p><img loading=lazy src=/images/HGAME2024/WEEK3/%E7%AE%80%E5%8D%95%E7%9A%84%E5%8F%96%E8%AF%81,%E4%B8%8D%E8%BF%87%E5%89%8D%E5%8D%81%E4%B8%AA%E6%9C%89%E7%BA%A2%E5%8C%85/2.png></p><hr><h3 id=3与ai聊天>3.与ai聊天<a hidden class=anchor aria-hidden=true href=#3与ai聊天>#</a></h3><blockquote><p>跟他聊一聊吧，从他嘴里翘出flaghttps://udify.app/chat/oRajccxObXREMLlO 注意请不要过快提问</p></blockquote><p><img loading=lazy src=/images/HGAME2024/WEEK3/%E4%B8%8Eai%E8%81%8A%E5%A4%A9/1.png></p><p>发现会反着说，想到hgame能不能反着说完，这样就可以得到flag</p><p><img loading=lazy src=/images/HGAME2024/WEEK3/%E4%B8%8Eai%E8%81%8A%E5%A4%A9/2.png></p><hr><h3 id=4blind-sql-injection>4.Blind SQL Injection<a hidden class=anchor aria-hidden=true href=#4blind-sql-injection>#</a></h3><blockquote><p>Blind SQL Injection but in Misc</p></blockquote><p>附件是一段流量包，判断为流量分析SQL盲注，用wireshark分析</p><p>根据SQL盲注特性，过滤出http协议内容，再根据网页回显内容不同，获取所需</p><p>举流量里SQL盲注中一句为例</p><blockquote><pre tabindex=0><code>http://3c97f319-92cf-4ba5-a3f2-6bd644abe921.node5.buuoj.cn:81/search.php?id=1-(ascii(substr((Select(reverse(group_concat(password)))From(F1naI1y)),6,1))&gt;31)
</code></pre></blockquote><p>需要注意reverse将获取的password倒置了，写脚本时要再倒置一次</p><p>判断 <strong>F1naI1y表</strong> 中 <strong>字段password</strong> 倒置后的第6个字符对应ASCII码是否大于31</p><p>经过多次判断查回显，最后可以获得一个 <strong>>x&&&lt;=x+1</strong> 的范围，ASCII码即为x+1</p><p><img loading=lazy src=/images/HGAME2024/WEEK3/Blind_SQL_Injection/1.png></p><p>这是当时做题时的分析，也包括了password对应ASCII码的内容(倒置的)</p><p>写个简单脚本，得到flag</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>c <span style=color:#f92672>=</span> [<span style=color:#ae81ff>125</span>,<span style=color:#ae81ff>102</span>,<span style=color:#ae81ff>50</span>,<span style=color:#ae81ff>102</span>,<span style=color:#ae81ff>97</span>,<span style=color:#ae81ff>56</span>,<span style=color:#ae81ff>50</span>,<span style=color:#ae81ff>57</span>,<span style=color:#ae81ff>53</span>,<span style=color:#ae81ff>99</span>,<span style=color:#ae81ff>56</span>,<span style=color:#ae81ff>51</span>,<span style=color:#ae81ff>100</span>,<span style=color:#ae81ff>45</span>,<span style=color:#ae81ff>54</span>,<span style=color:#ae81ff>99</span>,<span style=color:#ae81ff>97</span>,<span style=color:#ae81ff>98</span>,<span style=color:#ae81ff>45</span>,<span style=color:#ae81ff>56</span>,<span style=color:#ae81ff>57</span>,<span style=color:#ae81ff>101</span>,<span style=color:#ae81ff>52</span>,<span style=color:#ae81ff>45</span>,<span style=color:#ae81ff>53</span>,<span style=color:#ae81ff>50</span>,<span style=color:#ae81ff>55</span>,<span style=color:#ae81ff>49</span>,<span style=color:#ae81ff>45</span>,<span style=color:#ae81ff>55</span>,<span style=color:#ae81ff>101</span>,<span style=color:#ae81ff>102</span>,<span style=color:#ae81ff>97</span>,<span style=color:#ae81ff>98</span>,<span style=color:#ae81ff>97</span>,<span style=color:#ae81ff>98</span>,<span style=color:#ae81ff>99</span>,<span style=color:#ae81ff>123</span>,<span style=color:#ae81ff>103</span>,<span style=color:#ae81ff>97</span>,<span style=color:#ae81ff>108</span>,<span style=color:#ae81ff>102</span>,<span style=color:#ae81ff>44</span>][::<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> c:
</span></span><span style=display:flex><span>    flag <span style=color:#f92672>+=</span> chr(i)
</span></span><span style=display:flex><span>print (flag)
</span></span></code></pre></div><p>运行结果:<img loading=lazy src=/images/HGAME2024/WEEK3/Blind_SQL_Injection/2.png></p><hr><h2 id=hgame-2024-week4>HGAME 2024 WEEK4<a hidden class=anchor aria-hidden=true href=#hgame-2024-week4>#</a></h2><h3 id=1ezkeyboard>1.ezKeyboard<a hidden class=anchor aria-hidden=true href=#1ezkeyboard>#</a></h3><blockquote><p>本来是个签到题，但有时候往往事与愿违</p></blockquote><blockquote><ol><li>流量不需要修复，出题人拿自己电脑现抓的一段流量，他本身就是这样的。</li><li>本题键盘流量的 HID Data 格式和常见的格式略有不同，但本质如一。</li><li>你需要辩证看待这些个脚本网络上的脚本。他们大多出自一家，没几十行的核心代码里，都毫不例外地保留了数个编程初学者常犯的致命失误。</li><li>相信自己的水平，从头写一个脚本往往比找别人的错误容易。</li></ol></blockquote><p>使用wireshark进行USB流量分析，把一些特殊的流量导出</p><p>我导出了可能有用的三段，但是有一段不会用，也可能没什么用（</p><p>第一段内容：<img loading=lazy src=/images/HGAME2024/WEEK4/ezKeyboard/1.png></p><p>感觉开头的01没什么用，提取一下敲击内容：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>normalkeys <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;04&#34;</span>:<span style=color:#e6db74>&#34;a&#34;</span>, <span style=color:#e6db74>&#34;05&#34;</span>:<span style=color:#e6db74>&#34;b&#34;</span>, <span style=color:#e6db74>&#34;06&#34;</span>:<span style=color:#e6db74>&#34;c&#34;</span>, <span style=color:#e6db74>&#34;07&#34;</span>:<span style=color:#e6db74>&#34;d&#34;</span>, <span style=color:#e6db74>&#34;08&#34;</span>:<span style=color:#e6db74>&#34;e&#34;</span>, <span style=color:#e6db74>&#34;09&#34;</span>:<span style=color:#e6db74>&#34;f&#34;</span>, <span style=color:#e6db74>&#34;0a&#34;</span>:<span style=color:#e6db74>&#34;g&#34;</span>, <span style=color:#e6db74>&#34;0b&#34;</span>:<span style=color:#e6db74>&#34;h&#34;</span>, <span style=color:#e6db74>&#34;0c&#34;</span>:<span style=color:#e6db74>&#34;i&#34;</span>, <span style=color:#e6db74>&#34;0d&#34;</span>:<span style=color:#e6db74>&#34;j&#34;</span>, <span style=color:#e6db74>&#34;0e&#34;</span>:<span style=color:#e6db74>&#34;k&#34;</span>, <span style=color:#e6db74>&#34;0f&#34;</span>:<span style=color:#e6db74>&#34;l&#34;</span>, <span style=color:#e6db74>&#34;10&#34;</span>:<span style=color:#e6db74>&#34;m&#34;</span>, <span style=color:#e6db74>&#34;11&#34;</span>:<span style=color:#e6db74>&#34;n&#34;</span>, <span style=color:#e6db74>&#34;12&#34;</span>:<span style=color:#e6db74>&#34;o&#34;</span>, <span style=color:#e6db74>&#34;13&#34;</span>:<span style=color:#e6db74>&#34;p&#34;</span>, <span style=color:#e6db74>&#34;14&#34;</span>:<span style=color:#e6db74>&#34;q&#34;</span>, <span style=color:#e6db74>&#34;15&#34;</span>:<span style=color:#e6db74>&#34;r&#34;</span>, <span style=color:#e6db74>&#34;16&#34;</span>:<span style=color:#e6db74>&#34;s&#34;</span>, <span style=color:#e6db74>&#34;17&#34;</span>:<span style=color:#e6db74>&#34;t&#34;</span>, <span style=color:#e6db74>&#34;18&#34;</span>:<span style=color:#e6db74>&#34;u&#34;</span>, <span style=color:#e6db74>&#34;19&#34;</span>:<span style=color:#e6db74>&#34;v&#34;</span>, <span style=color:#e6db74>&#34;1a&#34;</span>:<span style=color:#e6db74>&#34;w&#34;</span>, <span style=color:#e6db74>&#34;1b&#34;</span>:<span style=color:#e6db74>&#34;x&#34;</span>, <span style=color:#e6db74>&#34;1c&#34;</span>:<span style=color:#e6db74>&#34;y&#34;</span>, <span style=color:#e6db74>&#34;1d&#34;</span>:<span style=color:#e6db74>&#34;z&#34;</span>,<span style=color:#e6db74>&#34;1e&#34;</span>:<span style=color:#e6db74>&#34;1&#34;</span>, <span style=color:#e6db74>&#34;1f&#34;</span>:<span style=color:#e6db74>&#34;2&#34;</span>, <span style=color:#e6db74>&#34;20&#34;</span>:<span style=color:#e6db74>&#34;3&#34;</span>, <span style=color:#e6db74>&#34;21&#34;</span>:<span style=color:#e6db74>&#34;4&#34;</span>, <span style=color:#e6db74>&#34;22&#34;</span>:<span style=color:#e6db74>&#34;5&#34;</span>, <span style=color:#e6db74>&#34;23&#34;</span>:<span style=color:#e6db74>&#34;6&#34;</span>,<span style=color:#e6db74>&#34;24&#34;</span>:<span style=color:#e6db74>&#34;7&#34;</span>,<span style=color:#e6db74>&#34;25&#34;</span>:<span style=color:#e6db74>&#34;8&#34;</span>,<span style=color:#e6db74>&#34;26&#34;</span>:<span style=color:#e6db74>&#34;9&#34;</span>,<span style=color:#e6db74>&#34;27&#34;</span>:<span style=color:#e6db74>&#34;0&#34;</span>,<span style=color:#e6db74>&#34;28&#34;</span>:<span style=color:#e6db74>&#34;&lt;RET&gt;&#34;</span>,<span style=color:#e6db74>&#34;29&#34;</span>:<span style=color:#e6db74>&#34;&lt;ESC&gt;&#34;</span>,<span style=color:#e6db74>&#34;2a&#34;</span>:<span style=color:#e6db74>&#34;&lt;DEL&gt;&#34;</span>, <span style=color:#e6db74>&#34;2b&#34;</span>:<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>&#34;</span>,<span style=color:#e6db74>&#34;2c&#34;</span>:<span style=color:#e6db74>&#34;&lt;SPACE&gt;&#34;</span>,<span style=color:#e6db74>&#34;2d&#34;</span>:<span style=color:#e6db74>&#34;-&#34;</span>,<span style=color:#e6db74>&#34;2e&#34;</span>:<span style=color:#e6db74>&#34;=&#34;</span>,<span style=color:#e6db74>&#34;2f&#34;</span>:<span style=color:#e6db74>&#34;[&#34;</span>,<span style=color:#e6db74>&#34;30&#34;</span>:<span style=color:#e6db74>&#34;]&#34;</span>,<span style=color:#e6db74>&#34;31&#34;</span>:<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>&#34;</span>,<span style=color:#e6db74>&#34;32&#34;</span>:<span style=color:#e6db74>&#34;&lt;NON&gt;&#34;</span>,<span style=color:#e6db74>&#34;33&#34;</span>:<span style=color:#e6db74>&#34;;&#34;</span>,<span style=color:#e6db74>&#34;34&#34;</span>:<span style=color:#e6db74>&#34;&#39;&#34;</span>,<span style=color:#e6db74>&#34;35&#34;</span>:<span style=color:#e6db74>&#34;`&#34;</span>,<span style=color:#e6db74>&#34;36&#34;</span>:<span style=color:#e6db74>&#34;,&#34;</span>,<span style=color:#e6db74>&#34;37&#34;</span>:<span style=color:#e6db74>&#34;.&#34;</span>,<span style=color:#e6db74>&#34;38&#34;</span>:<span style=color:#e6db74>&#34;/&#34;</span>,<span style=color:#e6db74>&#34;39&#34;</span>:<span style=color:#e6db74>&#34;&lt;CAP&gt;&#34;</span>,<span style=color:#e6db74>&#34;3a&#34;</span>:<span style=color:#e6db74>&#34;&lt;F1&gt;&#34;</span>,<span style=color:#e6db74>&#34;3b&#34;</span>:<span style=color:#e6db74>&#34;&lt;F2&gt;&#34;</span>, <span style=color:#e6db74>&#34;3c&#34;</span>:<span style=color:#e6db74>&#34;&lt;F3&gt;&#34;</span>,<span style=color:#e6db74>&#34;3d&#34;</span>:<span style=color:#e6db74>&#34;&lt;F4&gt;&#34;</span>,<span style=color:#e6db74>&#34;3e&#34;</span>:<span style=color:#e6db74>&#34;&lt;F5&gt;&#34;</span>,<span style=color:#e6db74>&#34;3f&#34;</span>:<span style=color:#e6db74>&#34;&lt;F6&gt;&#34;</span>,<span style=color:#e6db74>&#34;40&#34;</span>:<span style=color:#e6db74>&#34;&lt;F7&gt;&#34;</span>,<span style=color:#e6db74>&#34;41&#34;</span>:<span style=color:#e6db74>&#34;&lt;F8&gt;&#34;</span>,<span style=color:#e6db74>&#34;42&#34;</span>:<span style=color:#e6db74>&#34;&lt;F9&gt;&#34;</span>,<span style=color:#e6db74>&#34;43&#34;</span>:<span style=color:#e6db74>&#34;&lt;F10&gt;&#34;</span>,<span style=color:#e6db74>&#34;44&#34;</span>:<span style=color:#e6db74>&#34;&lt;F11&gt;&#34;</span>,<span style=color:#e6db74>&#34;45&#34;</span>:<span style=color:#e6db74>&#34;&lt;F12&gt;&#34;</span>}
</span></span><span style=display:flex><span>shiftkeys <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;04&#34;</span>:<span style=color:#e6db74>&#34;A&#34;</span>, <span style=color:#e6db74>&#34;05&#34;</span>:<span style=color:#e6db74>&#34;B&#34;</span>, <span style=color:#e6db74>&#34;06&#34;</span>:<span style=color:#e6db74>&#34;C&#34;</span>, <span style=color:#e6db74>&#34;07&#34;</span>:<span style=color:#e6db74>&#34;D&#34;</span>, <span style=color:#e6db74>&#34;08&#34;</span>:<span style=color:#e6db74>&#34;E&#34;</span>, <span style=color:#e6db74>&#34;09&#34;</span>:<span style=color:#e6db74>&#34;F&#34;</span>, <span style=color:#e6db74>&#34;0a&#34;</span>:<span style=color:#e6db74>&#34;G&#34;</span>, <span style=color:#e6db74>&#34;0b&#34;</span>:<span style=color:#e6db74>&#34;H&#34;</span>, <span style=color:#e6db74>&#34;0c&#34;</span>:<span style=color:#e6db74>&#34;I&#34;</span>, <span style=color:#e6db74>&#34;0d&#34;</span>:<span style=color:#e6db74>&#34;J&#34;</span>, <span style=color:#e6db74>&#34;0e&#34;</span>:<span style=color:#e6db74>&#34;K&#34;</span>, <span style=color:#e6db74>&#34;0f&#34;</span>:<span style=color:#e6db74>&#34;L&#34;</span>, <span style=color:#e6db74>&#34;10&#34;</span>:<span style=color:#e6db74>&#34;M&#34;</span>, <span style=color:#e6db74>&#34;11&#34;</span>:<span style=color:#e6db74>&#34;N&#34;</span>, <span style=color:#e6db74>&#34;12&#34;</span>:<span style=color:#e6db74>&#34;O&#34;</span>, <span style=color:#e6db74>&#34;13&#34;</span>:<span style=color:#e6db74>&#34;P&#34;</span>, <span style=color:#e6db74>&#34;14&#34;</span>:<span style=color:#e6db74>&#34;Q&#34;</span>, <span style=color:#e6db74>&#34;15&#34;</span>:<span style=color:#e6db74>&#34;R&#34;</span>, <span style=color:#e6db74>&#34;16&#34;</span>:<span style=color:#e6db74>&#34;S&#34;</span>, <span style=color:#e6db74>&#34;17&#34;</span>:<span style=color:#e6db74>&#34;T&#34;</span>, <span style=color:#e6db74>&#34;18&#34;</span>:<span style=color:#e6db74>&#34;U&#34;</span>, <span style=color:#e6db74>&#34;19&#34;</span>:<span style=color:#e6db74>&#34;V&#34;</span>, <span style=color:#e6db74>&#34;1a&#34;</span>:<span style=color:#e6db74>&#34;W&#34;</span>, <span style=color:#e6db74>&#34;1b&#34;</span>:<span style=color:#e6db74>&#34;X&#34;</span>, <span style=color:#e6db74>&#34;1c&#34;</span>:<span style=color:#e6db74>&#34;Y&#34;</span>, <span style=color:#e6db74>&#34;1d&#34;</span>:<span style=color:#e6db74>&#34;Z&#34;</span>,<span style=color:#e6db74>&#34;1e&#34;</span>:<span style=color:#e6db74>&#34;!&#34;</span>, <span style=color:#e6db74>&#34;1f&#34;</span>:<span style=color:#e6db74>&#34;@&#34;</span>, <span style=color:#e6db74>&#34;20&#34;</span>:<span style=color:#e6db74>&#34;#&#34;</span>, <span style=color:#e6db74>&#34;21&#34;</span>:<span style=color:#e6db74>&#34;$&#34;</span>, <span style=color:#e6db74>&#34;22&#34;</span>:<span style=color:#e6db74>&#34;%&#34;</span>, <span style=color:#e6db74>&#34;23&#34;</span>:<span style=color:#e6db74>&#34;^&#34;</span>,<span style=color:#e6db74>&#34;24&#34;</span>:<span style=color:#e6db74>&#34;&amp;&#34;</span>,<span style=color:#e6db74>&#34;25&#34;</span>:<span style=color:#e6db74>&#34;*&#34;</span>,<span style=color:#e6db74>&#34;26&#34;</span>:<span style=color:#e6db74>&#34;(&#34;</span>,<span style=color:#e6db74>&#34;27&#34;</span>:<span style=color:#e6db74>&#34;)&#34;</span>,<span style=color:#e6db74>&#34;28&#34;</span>:<span style=color:#e6db74>&#34;&lt;RET&gt;&#34;</span>,<span style=color:#e6db74>&#34;29&#34;</span>:<span style=color:#e6db74>&#34;&lt;ESC&gt;&#34;</span>,<span style=color:#e6db74>&#34;2a&#34;</span>:<span style=color:#e6db74>&#34;&lt;DEL&gt;&#34;</span>, <span style=color:#e6db74>&#34;2b&#34;</span>:<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>&#34;</span>,<span style=color:#e6db74>&#34;2c&#34;</span>:<span style=color:#e6db74>&#34;&lt;SPACE&gt;&#34;</span>,<span style=color:#e6db74>&#34;2d&#34;</span>:<span style=color:#e6db74>&#34;_&#34;</span>,<span style=color:#e6db74>&#34;2e&#34;</span>:<span style=color:#e6db74>&#34;+&#34;</span>,<span style=color:#e6db74>&#34;2f&#34;</span>:<span style=color:#e6db74>&#34;{&#34;</span>,<span style=color:#e6db74>&#34;30&#34;</span>:<span style=color:#e6db74>&#34;}&#34;</span>,<span style=color:#e6db74>&#34;31&#34;</span>:<span style=color:#e6db74>&#34;|&#34;</span>,<span style=color:#e6db74>&#34;32&#34;</span>:<span style=color:#e6db74>&#34;&lt;NON&gt;&#34;</span>,<span style=color:#e6db74>&#34;33&#34;</span>:<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>&#34;</span>,<span style=color:#e6db74>&#34;34&#34;</span>:<span style=color:#e6db74>&#34;:&#34;</span>,<span style=color:#e6db74>&#34;35&#34;</span>:<span style=color:#e6db74>&#34;~&#34;</span>,<span style=color:#e6db74>&#34;36&#34;</span>:<span style=color:#e6db74>&#34;&lt;&#34;</span>,<span style=color:#e6db74>&#34;37&#34;</span>:<span style=color:#e6db74>&#34;&gt;&#34;</span>,<span style=color:#e6db74>&#34;38&#34;</span>:<span style=color:#e6db74>&#34;?&#34;</span>,<span style=color:#e6db74>&#34;39&#34;</span>:<span style=color:#e6db74>&#34;&lt;CAP&gt;&#34;</span>,<span style=color:#e6db74>&#34;3a&#34;</span>:<span style=color:#e6db74>&#34;&lt;F1&gt;&#34;</span>,<span style=color:#e6db74>&#34;3b&#34;</span>:<span style=color:#e6db74>&#34;&lt;F2&gt;&#34;</span>, <span style=color:#e6db74>&#34;3c&#34;</span>:<span style=color:#e6db74>&#34;&lt;F3&gt;&#34;</span>,<span style=color:#e6db74>&#34;3d&#34;</span>:<span style=color:#e6db74>&#34;&lt;F4&gt;&#34;</span>,<span style=color:#e6db74>&#34;3e&#34;</span>:<span style=color:#e6db74>&#34;&lt;F5&gt;&#34;</span>,<span style=color:#e6db74>&#34;3f&#34;</span>:<span style=color:#e6db74>&#34;&lt;F6&gt;&#34;</span>,<span style=color:#e6db74>&#34;40&#34;</span>:<span style=color:#e6db74>&#34;&lt;F7&gt;&#34;</span>,<span style=color:#e6db74>&#34;41&#34;</span>:<span style=color:#e6db74>&#34;&lt;F8&gt;&#34;</span>,<span style=color:#e6db74>&#34;42&#34;</span>:<span style=color:#e6db74>&#34;&lt;F9&gt;&#34;</span>,<span style=color:#e6db74>&#34;43&#34;</span>:<span style=color:#e6db74>&#34;&lt;F10&gt;&#34;</span>,<span style=color:#e6db74>&#34;44&#34;</span>:<span style=color:#e6db74>&#34;&lt;F11&gt;&#34;</span>,<span style=color:#e6db74>&#34;45&#34;</span>:<span style=color:#e6db74>&#34;&lt;F12&gt;&#34;</span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;hgame2.txt&#39;</span>) <span style=color:#66d9ef>as</span> data:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> data:
</span></span><span style=display:flex><span>        information1<span style=color:#f92672>=</span>line[<span style=color:#ae81ff>6</span>:<span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>        information2<span style=color:#f92672>=</span>line[<span style=color:#ae81ff>8</span>:<span style=color:#ae81ff>10</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> information1<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;00&#39;</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> line[<span style=color:#ae81ff>3</span>]<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;2&#39;</span>: <span style=color:#75715e>#shiftkey</span>
</span></span><span style=display:flex><span>            print (shiftkeys[information1],end<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>) <span style=color:#75715e>#end=&#39;&#39;以空字符替换原默认换行符</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> information2<span style=color:#f92672>!=</span><span style=color:#e6db74>&#39;00&#39;</span>:
</span></span><span style=display:flex><span>                print (shiftkeys[information2],end<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> line[<span style=color:#ae81ff>3</span>]<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;0&#39;</span>: <span style=color:#75715e>#normalkey</span>
</span></span><span style=display:flex><span>            print (normalkeys[information1],end<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> information2<span style=color:#f92672>!=</span><span style=color:#e6db74>&#39;00&#39;</span>:
</span></span><span style=display:flex><span>                print (normalkeys[information2],end<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>)
</span></span></code></pre></div><p>运行结果：</p><pre tabindex=0><code>hgame{k_&lt;DEL&gt;e&lt;CAP&gt;&lt;CAP&gt;y&lt;CAP&gt;&lt;CAP&gt;b0a1d&lt;CAP&gt;&lt;CAP&gt;&lt;CAP&gt;_&lt;CAP&gt;&lt;CAP&gt;gam0&lt;CAP&gt;&lt;CAP&gt;&lt;CAP&gt;_&lt;CAP&gt;&lt;CAP&gt;_&lt;CAP&gt;&lt;CAP&gt;15&lt;CAP&gt;&lt;CAP&gt;&lt;CAP&gt;_&lt;CAP&gt;&lt;CAP&gt;s0&lt;CAP&gt;&lt;CAP&gt;&lt;CAP&gt;_&lt;CAP&gt;&lt;CAP&gt;&lt;CAP&gt;1nst&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;f0n__!!~~&lt;CAP&gt;~~&lt;CAP&gt;}
</code></pre><p>整理一下：<img loading=lazy src=/images/HGAME2024/WEEK4/ezKeyboard/2.png></p><p>但是提交发现flag不对，感觉怪怪的</p><p>赛后看了官方wp找到问题了，这里也贴出能得到正确flag的脚本：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>normalKeys <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;04&#34;</span>: <span style=color:#e6db74>&#34;a&#34;</span>, <span style=color:#e6db74>&#34;05&#34;</span>: <span style=color:#e6db74>&#34;b&#34;</span>, <span style=color:#e6db74>&#34;06&#34;</span>: <span style=color:#e6db74>&#34;c&#34;</span>, <span style=color:#e6db74>&#34;07&#34;</span>: <span style=color:#e6db74>&#34;d&#34;</span>, <span style=color:#e6db74>&#34;08&#34;</span>: <span style=color:#e6db74>&#34;e&#34;</span>, <span style=color:#e6db74>&#34;09&#34;</span>:
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;f&#34;</span>, <span style=color:#e6db74>&#34;0a&#34;</span>: <span style=color:#e6db74>&#34;g&#34;</span>, <span style=color:#e6db74>&#34;0b&#34;</span>: <span style=color:#e6db74>&#34;h&#34;</span>, <span style=color:#e6db74>&#34;0c&#34;</span>: <span style=color:#e6db74>&#34;i&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;0d&#34;</span>: <span style=color:#e6db74>&#34;j&#34;</span>, <span style=color:#e6db74>&#34;0e&#34;</span>: <span style=color:#e6db74>&#34;k&#34;</span>, <span style=color:#e6db74>&#34;0f&#34;</span>: <span style=color:#e6db74>&#34;l&#34;</span>, <span style=color:#e6db74>&#34;10&#34;</span>: <span style=color:#e6db74>&#34;m&#34;</span>, <span style=color:#e6db74>&#34;11&#34;</span>: <span style=color:#e6db74>&#34;n&#34;</span>, <span style=color:#e6db74>&#34;12&#34;</span>:
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;o&#34;</span>, <span style=color:#e6db74>&#34;13&#34;</span>: <span style=color:#e6db74>&#34;p&#34;</span>, <span style=color:#e6db74>&#34;14&#34;</span>: <span style=color:#e6db74>&#34;q&#34;</span>, <span style=color:#e6db74>&#34;15&#34;</span>: <span style=color:#e6db74>&#34;r&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;16&#34;</span>: <span style=color:#e6db74>&#34;s&#34;</span>, <span style=color:#e6db74>&#34;17&#34;</span>: <span style=color:#e6db74>&#34;t&#34;</span>, <span style=color:#e6db74>&#34;18&#34;</span>: <span style=color:#e6db74>&#34;u&#34;</span>, <span style=color:#e6db74>&#34;19&#34;</span>: <span style=color:#e6db74>&#34;v&#34;</span>, <span style=color:#e6db74>&#34;1a&#34;</span>: <span style=color:#e6db74>&#34;w&#34;</span>, <span style=color:#e6db74>&#34;1b&#34;</span>:
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;x&#34;</span>, <span style=color:#e6db74>&#34;1c&#34;</span>: <span style=color:#e6db74>&#34;y&#34;</span>, <span style=color:#e6db74>&#34;1d&#34;</span>: <span style=color:#e6db74>&#34;z&#34;</span>, <span style=color:#e6db74>&#34;1e&#34;</span>: <span style=color:#e6db74>&#34;1&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;1f&#34;</span>: <span style=color:#e6db74>&#34;2&#34;</span>, <span style=color:#e6db74>&#34;20&#34;</span>: <span style=color:#e6db74>&#34;3&#34;</span>, <span style=color:#e6db74>&#34;21&#34;</span>: <span style=color:#e6db74>&#34;4&#34;</span>, <span style=color:#e6db74>&#34;22&#34;</span>: <span style=color:#e6db74>&#34;5&#34;</span>, <span style=color:#e6db74>&#34;23&#34;</span>: <span style=color:#e6db74>&#34;6&#34;</span>, <span style=color:#e6db74>&#34;24&#34;</span>:
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;7&#34;</span>, <span style=color:#e6db74>&#34;25&#34;</span>: <span style=color:#e6db74>&#34;8&#34;</span>, <span style=color:#e6db74>&#34;26&#34;</span>: <span style=color:#e6db74>&#34;9&#34;</span>, <span style=color:#e6db74>&#34;27&#34;</span>: <span style=color:#e6db74>&#34;0&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;28&#34;</span>: <span style=color:#e6db74>&#34;&lt;RET&gt;&#34;</span>, <span style=color:#e6db74>&#34;29&#34;</span>: <span style=color:#e6db74>&#34;&lt;ESC&gt;&#34;</span>, <span style=color:#e6db74>&#34;2a&#34;</span>: <span style=color:#e6db74>&#34;&lt;DEL&gt;&#34;</span>, <span style=color:#e6db74>&#34;2b&#34;</span>: <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>&#34;</span>, <span style=color:#e6db74>&#34;2c&#34;</span>: <span style=color:#e6db74>&#34;&lt;SPACE&gt;&#34;</span>, <span style=color:#e6db74>&#34;2d&#34;</span>: <span style=color:#e6db74>&#34;-&#34;</span>, <span style=color:#e6db74>&#34;2e&#34;</span>: <span style=color:#e6db74>&#34;=&#34;</span>, <span style=color:#e6db74>&#34;2f&#34;</span>: <span style=color:#e6db74>&#34;[&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;30&#34;</span>: <span style=color:#e6db74>&#34;]&#34;</span>, <span style=color:#e6db74>&#34;31&#34;</span>: <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>&#34;</span>, <span style=color:#e6db74>&#34;32&#34;</span>: <span style=color:#e6db74>&#34;&lt;NON&gt;&#34;</span>, <span style=color:#e6db74>&#34;33&#34;</span>: <span style=color:#e6db74>&#34;;&#34;</span>, <span style=color:#e6db74>&#34;34&#34;</span>: <span style=color:#e6db74>&#34;&#39;&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;35&#34;</span>: <span style=color:#e6db74>&#34;&lt;GA&gt;&#34;</span>, <span style=color:#e6db74>&#34;36&#34;</span>: <span style=color:#e6db74>&#34;,&#34;</span>, <span style=color:#e6db74>&#34;37&#34;</span>: <span style=color:#e6db74>&#34;.&#34;</span>, <span style=color:#e6db74>&#34;38&#34;</span>: <span style=color:#e6db74>&#34;/&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;39&#34;</span>: <span style=color:#e6db74>&#34;&lt;CAP&gt;&#34;</span>, <span style=color:#e6db74>&#34;3a&#34;</span>: <span style=color:#e6db74>&#34;&lt;F1&gt;&#34;</span>, <span style=color:#e6db74>&#34;3b&#34;</span>: <span style=color:#e6db74>&#34;&lt;F2&gt;&#34;</span>, <span style=color:#e6db74>&#34;3c&#34;</span>: <span style=color:#e6db74>&#34;&lt;F3&gt;&#34;</span>, <span style=color:#e6db74>&#34;3d&#34;</span>: <span style=color:#e6db74>&#34;&lt;F4&gt;&#34;</span>, <span style=color:#e6db74>&#34;3e&#34;</span>: <span style=color:#e6db74>&#34;&lt;F5&gt;&#34;</span>, <span style=color:#e6db74>&#34;3f&#34;</span>: <span style=color:#e6db74>&#34;&lt;F6&gt;&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;40&#34;</span>: <span style=color:#e6db74>&#34;&lt;F7&gt;&#34;</span>, <span style=color:#e6db74>&#34;41&#34;</span>: <span style=color:#e6db74>&#34;&lt;F8&gt;&#34;</span>, <span style=color:#e6db74>&#34;42&#34;</span>: <span style=color:#e6db74>&#34;&lt;F9&gt;&#34;</span>, <span style=color:#e6db74>&#34;43&#34;</span>: <span style=color:#e6db74>&#34;&lt;F10&gt;&#34;</span>, <span style=color:#e6db74>&#34;44&#34;</span>: <span style=color:#e6db74>&#34;&lt;F11&gt;&#34;</span>, <span style=color:#e6db74>&#34;45&#34;</span>: <span style=color:#e6db74>&#34;&lt;F12&gt;&#34;</span>}
</span></span><span style=display:flex><span>shiftKeys <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;04&#34;</span>: <span style=color:#e6db74>&#34;A&#34;</span>, <span style=color:#e6db74>&#34;05&#34;</span>: <span style=color:#e6db74>&#34;B&#34;</span>, <span style=color:#e6db74>&#34;06&#34;</span>: <span style=color:#e6db74>&#34;C&#34;</span>, <span style=color:#e6db74>&#34;07&#34;</span>: <span style=color:#e6db74>&#34;D&#34;</span>, <span style=color:#e6db74>&#34;08&#34;</span>: <span style=color:#e6db74>&#34;E&#34;</span>, <span style=color:#e6db74>&#34;09&#34;</span>: <span style=color:#e6db74>&#34;F&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;0a&#34;</span>: <span style=color:#e6db74>&#34;G&#34;</span>, <span style=color:#e6db74>&#34;0b&#34;</span>: <span style=color:#e6db74>&#34;H&#34;</span>, <span style=color:#e6db74>&#34;0c&#34;</span>: <span style=color:#e6db74>&#34;I&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;0d&#34;</span>: <span style=color:#e6db74>&#34;J&#34;</span>, <span style=color:#e6db74>&#34;0e&#34;</span>: <span style=color:#e6db74>&#34;K&#34;</span>, <span style=color:#e6db74>&#34;0f&#34;</span>: <span style=color:#e6db74>&#34;L&#34;</span>, <span style=color:#e6db74>&#34;10&#34;</span>: <span style=color:#e6db74>&#34;M&#34;</span>, <span style=color:#e6db74>&#34;11&#34;</span>: <span style=color:#e6db74>&#34;N&#34;</span>, <span style=color:#e6db74>&#34;12&#34;</span>: <span style=color:#e6db74>&#34;O&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;13&#34;</span>: <span style=color:#e6db74>&#34;P&#34;</span>, <span style=color:#e6db74>&#34;14&#34;</span>: <span style=color:#e6db74>&#34;Q&#34;</span>, <span style=color:#e6db74>&#34;15&#34;</span>: <span style=color:#e6db74>&#34;R&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;16&#34;</span>: <span style=color:#e6db74>&#34;S&#34;</span>, <span style=color:#e6db74>&#34;17&#34;</span>: <span style=color:#e6db74>&#34;T&#34;</span>, <span style=color:#e6db74>&#34;18&#34;</span>: <span style=color:#e6db74>&#34;U&#34;</span>, <span style=color:#e6db74>&#34;19&#34;</span>: <span style=color:#e6db74>&#34;V&#34;</span>, <span style=color:#e6db74>&#34;1a&#34;</span>: <span style=color:#e6db74>&#34;W&#34;</span>, <span style=color:#e6db74>&#34;1b&#34;</span>: <span style=color:#e6db74>&#34;X&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;1c&#34;</span>: <span style=color:#e6db74>&#34;Y&#34;</span>, <span style=color:#e6db74>&#34;1d&#34;</span>: <span style=color:#e6db74>&#34;Z&#34;</span>, <span style=color:#e6db74>&#34;1e&#34;</span>: <span style=color:#e6db74>&#34;!&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;1f&#34;</span>: <span style=color:#e6db74>&#34;@&#34;</span>, <span style=color:#e6db74>&#34;20&#34;</span>: <span style=color:#e6db74>&#34;#&#34;</span>, <span style=color:#e6db74>&#34;21&#34;</span>: <span style=color:#e6db74>&#34;$&#34;</span>, <span style=color:#e6db74>&#34;22&#34;</span>: <span style=color:#e6db74>&#34;%&#34;</span>, <span style=color:#e6db74>&#34;23&#34;</span>: <span style=color:#e6db74>&#34;^&#34;</span>, <span style=color:#e6db74>&#34;24&#34;</span>: <span style=color:#e6db74>&#34;&amp;&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;25&#34;</span>: <span style=color:#e6db74>&#34;*&#34;</span>, <span style=color:#e6db74>&#34;26&#34;</span>: <span style=color:#e6db74>&#34;(&#34;</span>, <span style=color:#e6db74>&#34;27&#34;</span>: <span style=color:#e6db74>&#34;)&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;28&#34;</span>: <span style=color:#e6db74>&#34;&lt;RET&gt;&#34;</span>, <span style=color:#e6db74>&#34;29&#34;</span>: <span style=color:#e6db74>&#34;&lt;ESC&gt;&#34;</span>, <span style=color:#e6db74>&#34;2a&#34;</span>: <span style=color:#e6db74>&#34;&lt;DEL&gt;&#34;</span>, <span style=color:#e6db74>&#34;2b&#34;</span>: <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>&#34;</span>, <span style=color:#e6db74>&#34;2c&#34;</span>: <span style=color:#e6db74>&#34;&lt;SPACE&gt;&#34;</span>, <span style=color:#e6db74>&#34;2d&#34;</span>: <span style=color:#e6db74>&#34;_&#34;</span>, <span style=color:#e6db74>&#34;2e&#34;</span>: <span style=color:#e6db74>&#34;+&#34;</span>, <span style=color:#e6db74>&#34;2f&#34;</span>: <span style=color:#e6db74>&#34;{&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;30&#34;</span>: <span style=color:#e6db74>&#34;}&#34;</span>, <span style=color:#e6db74>&#34;31&#34;</span>: <span style=color:#e6db74>&#34;|&#34;</span>, <span style=color:#e6db74>&#34;32&#34;</span>: <span style=color:#e6db74>&#34;&lt;NON&gt;&#34;</span>, <span style=color:#e6db74>&#34;33&#34;</span>: <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>&#34;</span>, <span style=color:#e6db74>&#34;34&#34;</span>: <span style=color:#e6db74>&#34;:&#34;</span>, <span style=color:#e6db74>&#34;35&#34;</span>:
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;~&#34;</span>, <span style=color:#e6db74>&#34;36&#34;</span>: <span style=color:#e6db74>&#34;&lt;&#34;</span>, <span style=color:#e6db74>&#34;37&#34;</span>: <span style=color:#e6db74>&#34;&gt;&#34;</span>, <span style=color:#e6db74>&#34;38&#34;</span>: <span style=color:#e6db74>&#34;?&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;39&#34;</span>: <span style=color:#e6db74>&#34;&lt;CAP&gt;&#34;</span>, <span style=color:#e6db74>&#34;3a&#34;</span>: <span style=color:#e6db74>&#34;&lt;F1&gt;&#34;</span>, <span style=color:#e6db74>&#34;3b&#34;</span>: <span style=color:#e6db74>&#34;&lt;F2&gt;&#34;</span>, <span style=color:#e6db74>&#34;3c&#34;</span>: <span style=color:#e6db74>&#34;&lt;F3&gt;&#34;</span>, <span style=color:#e6db74>&#34;3d&#34;</span>: <span style=color:#e6db74>&#34;&lt;F4&gt;&#34;</span>, <span style=color:#e6db74>&#34;3e&#34;</span>: <span style=color:#e6db74>&#34;&lt;F5&gt;&#34;</span>, <span style=color:#e6db74>&#34;3f&#34;</span>: <span style=color:#e6db74>&#34;&lt;F6&gt;&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;40&#34;</span>: <span style=color:#e6db74>&#34;&lt;F7&gt;&#34;</span>, <span style=color:#e6db74>&#34;41&#34;</span>: <span style=color:#e6db74>&#34;&lt;F8&gt;&#34;</span>, <span style=color:#e6db74>&#34;42&#34;</span>: <span style=color:#e6db74>&#34;&lt;F9&gt;&#34;</span>, <span style=color:#e6db74>&#34;43&#34;</span>: <span style=color:#e6db74>&#34;&lt;F10&gt;&#34;</span>, <span style=color:#e6db74>&#34;44&#34;</span>: <span style=color:#e6db74>&#34;&lt;F11&gt;&#34;</span>, <span style=color:#e6db74>&#34;45&#34;</span>: <span style=color:#e6db74>&#34;&lt;F12&gt;&#34;</span>}
</span></span><span style=display:flex><span>output <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>last <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>new <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>keys <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;hgame2.txt&#39;</span>)
</span></span><span style=display:flex><span>press <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> keys:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> line[<span style=color:#ae81ff>2</span>]<span style=color:#f92672>!=</span><span style=color:#e6db74>&#39;0&#39;</span> <span style=color:#f92672>or</span> (line[<span style=color:#ae81ff>3</span>]<span style=color:#f92672>!=</span><span style=color:#e6db74>&#39;0&#39;</span> <span style=color:#f92672>and</span> line[<span style=color:#ae81ff>3</span>]<span style=color:#f92672>!=</span><span style=color:#e6db74>&#39;2&#39;</span>):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>        offset <span style=color:#f92672>=</span> <span style=color:#ae81ff>6</span>
</span></span><span style=display:flex><span>        new <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> line[offset:offset<span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>] <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;00&#39;</span>:
</span></span><span style=display:flex><span>            press <span style=color:#f92672>=</span> line[offset:offset<span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> press <span style=color:#f92672>in</span> normalKeys<span style=color:#f92672>.</span>keys():
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> line[<span style=color:#ae81ff>3</span>]<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;0&#39;</span>:
</span></span><span style=display:flex><span>                    key <span style=color:#f92672>=</span> normalKeys[press]
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                    key <span style=color:#f92672>=</span> shiftKeys[press]
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                key <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;[unknown]&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> press <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> last:
</span></span><span style=display:flex><span>                output<span style=color:#f92672>.</span>append(key)
</span></span><span style=display:flex><span>            new<span style=color:#f92672>.</span>append(press)
</span></span><span style=display:flex><span>            offset <span style=color:#f92672>+=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span>:
</span></span><span style=display:flex><span>        print(line)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>finally</span>:
</span></span><span style=display:flex><span>        last <span style=color:#f92672>=</span> new
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>keys<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>flag<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(output)):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> output[i]<span style=color:#f92672>==</span><span style=color:#e6db74>&#34;&lt;CAP&gt;&#34;</span>:
</span></span><span style=display:flex><span>            flag <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>-</span>flag
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> flag<span style=color:#f92672>!=</span><span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            output[i]<span style=color:#f92672>=</span>output[i]<span style=color:#f92672>.</span>upper()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>pass</span>
</span></span><span style=display:flex><span>output <span style=color:#f92672>=</span> [x <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> output <span style=color:#66d9ef>if</span> x <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;&lt;CAP&gt;&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>new_output <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(output)):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> output[i] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&lt;DEL&gt;&#34;</span>:
</span></span><span style=display:flex><span>        new_output <span style=color:#f92672>=</span> new_output[:<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        new_output<span style=color:#f92672>.</span>append(output[i])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print (<span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>.</span>join(new_output))
</span></span></code></pre></div><p>运行结果:hgame{keYb0a1d_gam0__15_s0_f0n__!!~~~~}</p><hr><h3 id=2maybezip>2.maybezip<a hidden class=anchor aria-hidden=true href=#2maybezip>#</a></h3><p>根据题目名，结合文件并非zip，想到需要对文件内容异或得到原zip文件
根据zip文件的固定文件头，504B0304，找到异或数字 0x27,可以直接在winhex里异或，也能写脚本</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>xor_with_0x27</span>(input_file, output_file):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(input_file, <span style=color:#e6db74>&#39;rb&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        data <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>    xor_data <span style=color:#f92672>=</span> bytearray([b <span style=color:#f92672>^</span> <span style=color:#ae81ff>0x27</span> <span style=color:#66d9ef>for</span> b <span style=color:#f92672>in</span> data])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(output_file, <span style=color:#e6db74>&#39;wb&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        f<span style=color:#f92672>.</span>write(xor_data)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用xor函数</span>
</span></span><span style=display:flex><span>xor_with_0x27(<span style=color:#e6db74>&#39;maybezip&#39;</span>, <span style=color:#e6db74>&#39;output.zip&#39;</span>)
</span></span></code></pre></div><p>output.zip里文件修改日期有明显的01特征，提取出来</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> zipfile
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> datetime <span style=color:#f92672>import</span> datetime
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_all_file_modification_time</span>(zip_path):
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> zipfile<span style=color:#f92672>.</span>ZipFile(zip_path, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> myzip:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> file <span style=color:#f92672>in</span> myzip<span style=color:#f92672>.</span>namelist():
</span></span><span style=display:flex><span>            info <span style=color:#f92672>=</span> myzip<span style=color:#f92672>.</span>getinfo(file)
</span></span><span style=display:flex><span>            mod_time <span style=color:#f92672>=</span> datetime(<span style=color:#f92672>*</span>info<span style=color:#f92672>.</span>date_time)
</span></span><span style=display:flex><span>            result[file] <span style=color:#f92672>=</span> str(mod_time)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用函数并保存结果为json</span>
</span></span><span style=display:flex><span>result <span style=color:#f92672>=</span> get_all_file_modification_time(<span style=color:#e6db74>&#39;output.zip&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;output.json&#39;</span>, <span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    json<span style=color:#f92672>.</span>dump(result, f)
</span></span></code></pre></div><p>再对拿到的json数据操作一下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 读取json文件</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;output.json&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    data <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>load(f)
</span></span><span style=display:flex><span>string_of_01 <span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 遍历json数据</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> file, time <span style=color:#f92672>in</span> data<span style=color:#f92672>.</span>items():
</span></span><span style=display:flex><span>    <span style=color:#75715e># 检查文件名是否在指定范围内</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;out/&#39;</span> <span style=color:#f92672>in</span> file <span style=color:#f92672>and</span> <span style=color:#e6db74>&#39;png&#39;</span> <span style=color:#f92672>in</span> file:
</span></span><span style=display:flex><span>        file_number <span style=color:#f92672>=</span> int(file<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;/&#39;</span>)[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;.&#39;</span>)[<span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> file_number <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>and</span> file_number <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>118</span>:
</span></span><span style=display:flex><span>            <span style=color:#75715e># 检查时间的最后一位是否为0</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> time[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;0&#39;</span>:
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>file_number<span style=color:#e6db74>}</span><span style=color:#e6db74> - 0&#34;</span>)
</span></span><span style=display:flex><span>                string_of_01 <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#39;0&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>file_number<span style=color:#e6db74>}</span><span style=color:#e6db74> - 1&#34;</span>)
</span></span><span style=display:flex><span>                string_of_01 <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#39;1&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(string_of_01)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 二进制转ascii字符串</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>binary_to_string</span>(binary):
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, len(binary), <span style=color:#ae81ff>8</span>):
</span></span><span style=display:flex><span>        byte <span style=color:#f92672>=</span> binary[i:i<span style=color:#f92672>+</span><span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>        result <span style=color:#f92672>+=</span> chr(int(byte,<span style=color:#ae81ff>2</span>))  <span style=color:#75715e>#从二进制转为十进制</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 忽略不可见字符</span>
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join([i <span style=color:#66d9ef>if</span> ord(i) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>31</span> <span style=color:#f92672>and</span> ord(i) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>127</span> <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> result])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>key_of_zip <span style=color:#f92672>=</span> binary_to_string(string_of_01)
</span></span><span style=display:flex><span>print(key_of_zip)
</span></span></code></pre></div><p>得到压缩包密码 what_is_tupper
解压缩得到一段数字，结合压缩包密码的tupper，想到tupper自指，在线工具画一下图</p><p><img loading=lazy src=/images/HGAME2024/WEEK4/maybezip/1.png></p><p>这是micro qrcode，找个工具扫一下，可以用Scanbot SDK
扫描内容为：Matryo5hk4_d01l</p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://blog.w8nn9z.top/>w8nn9z Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>